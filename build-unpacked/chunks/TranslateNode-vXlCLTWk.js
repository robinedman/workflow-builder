import{r as o,j as e,X as L,L as T}from"./workflowEngine-COE-Vt9W.js";import{E as A,H as x,P as y}from"./index-DVV3DQzl.js";import{S as f}from"./SketchDropdown-blVjryMa.js";import{L as z}from"./languages-mYg5izsA.js";const k={blue:{bg:"#E3F2FD",border:"#5B9BD5"},purple:{bg:"#F3E5F5",border:"#9B59B6"},mint:{bg:"#E0F2F1",border:"#4DB6AC"},pink:{bg:"#FCE4EC",border:"#EC407A"},peach:{bg:"#FFE0B2",border:"#FF8A65"},sage:{bg:"#E8F5E9",border:"#66BB6A"},yellow:{bg:"#FFF9C4",border:"#FDD835"}},P={input:"blue",processing:"purple",output:"sage"},H=a=>{if(!a)return k.purple;const d=P[a]||"purple";return k[d]},h=[{value:"en",label:"English"},{value:"es",label:"Spanish"},{value:"fr",label:"French"},{value:"de",label:"German"},{value:"it",label:"Italian"},{value:"pt",label:"Portuguese"},{value:"ru",label:"Russian"},{value:"ja",label:"Japanese"},{value:"zh",label:"Chinese (Simplified)"},{value:"zh-Hant",label:"Chinese (Traditional)"},{value:"ko",label:"Korean"},{value:"ar",label:"Arabic"},{value:"hi",label:"Hindi"},{value:"bn",label:"Bengali"},{value:"tr",label:"Turkish"},{value:"vi",label:"Vietnamese"},{value:"pl",label:"Polish"},{value:"uk",label:"Ukrainian"},{value:"nl",label:"Dutch"},{value:"th",label:"Thai"},{value:"id",label:"Indonesian"},{value:"cs",label:"Czech"},{value:"sv",label:"Swedish"},{value:"ro",label:"Romanian"},{value:"el",label:"Greek"},{value:"hu",label:"Hungarian"},{value:"da",label:"Danish"},{value:"fi",label:"Finnish"},{value:"no",label:"Norwegian"},{value:"sk",label:"Slovak"},{value:"bg",label:"Bulgarian"},{value:"he",label:"Hebrew"},{value:"ms",label:"Malay"},{value:"ca",label:"Catalan"},{value:"hr",label:"Croatian"},{value:"sr",label:"Serbian"},{value:"sl",label:"Slovenian"},{value:"lt",label:"Lithuanian"},{value:"lv",label:"Latvian"},{value:"et",label:"Estonian"}],G=({data:a,selected:d})=>{const[b,i]=o.useState("checking"),[v,j]=o.useState(0),[t,w]=o.useState(a.sourceLanguage||"en"),[r,N]=o.useState(a.targetLanguage||"fr"),[C,E]=o.useState(new Set),[g,p]=o.useState(!1);o.useEffect(()=>{a.sourceLanguage=t},[t]),o.useEffect(()=>{a.targetLanguage=r},[r]),o.useEffect(()=>{(async()=>{p(!0);const n=new Set,B=h.map(async u=>{if(u.value!==t)try{const m=await Translator.availability({sourceLanguage:t,targetLanguage:u.value});m!=="available"&&m!=="downloadable"&&n.add(u.value)}catch{n.add(u.value)}});await Promise.all(B),E(n),p(!1)})()},[t]),o.useEffect(()=>{(async()=>{try{const n=await Translator.availability({sourceLanguage:t,targetLanguage:r});i(n)}catch{i("downloadable")}})()},[t,r]);const F=async()=>{try{i("downloading"),await Translator.create({sourceLanguage:t,targetLanguage:r,monitor(s){s.addEventListener("downloadprogress",n=>j(Math.round(n.loaded*100)))}}),i("ready")}catch{i("downloadable")}},c=a.status==="running",l=H(a.category),D=h.map(s=>({...s,disabled:s.value===r})),S=h.map(s=>({...s,disabled:s.value===t||C.has(s.value)}));return e.jsxs("div",{style:{width:250},className:`sketch-node relative ${c?"sketch-node-running-flow":""} ${d?"sketch-node-selected":""}`,children:[d&&a.onDelete&&e.jsx("button",{onClick:s=>{s.stopPropagation(),a.onDelete?.(a.id)},className:"absolute -top-3 -right-3 flex items-center justify-center hover:scale-110 transition-all cursor-pointer w-7 h-7 rounded-full z-20 shadow-md",style:{backgroundColor:l.bg,color:l.border,border:`3px solid ${l.border}`,filter:"url(#rough-border)"},title:"Delete node (or press Delete/Backspace)",children:e.jsx(L,{size:14,strokeWidth:2.5})}),e.jsx("div",{className:"sketch-border",style:{"--sketch-color":l.border},children:e.jsx("div",{className:"sketch-border-inner",children:e.jsxs("div",{className:"sketch-border-content",children:[e.jsxs("div",{className:"px-4 py-3 font-bold text-base tracking-tight flex items-center justify-between gap-2",style:{backgroundColor:l.bg},children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[c?e.jsx(T,{size:18,className:"animate-spin shrink-0",style:{color:l.border}}):e.jsx(z,{size:18,className:"shrink-0 opacity-90",style:{color:l.border}}),e.jsx("span",{className:"sketch-text text-[17px] leading-tight",style:{color:l.border},children:"Translate"})]}),e.jsx("div",{className:"flex items-center gap-1.5",children:a.output&&e.jsx("button",{onClick:()=>a.onInspect?.(a.id,a.output),className:"cursor-pointer hover:scale-125 transition-transform opacity-90 hover:opacity-100 shrink-0",style:{color:l.border},title:"Inspect output",children:e.jsx(A,{size:18,style:{color:l.border}})})})]}),e.jsxs("div",{className:"px-4 py-3 space-y-3 sketch-info-text text-sm font-medium bg-white",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"From"}),e.jsx(f,{value:t,onChange:w,disabled:c,options:D})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"To"}),e.jsx(f,{value:r,onChange:N,disabled:c||g,options:S})]}),g&&e.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"⏳ Checking available languages..."}),b==="downloadable"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-[#E09F7D] text-[15px] font-semibold",children:"⚠️ Model not installed"}),e.jsx("div",{className:"sketch-border sketch-button-hover inline-flex",style:{"--sketch-color":l.border},children:e.jsx("div",{className:"sketch-border-inner",children:e.jsx("button",{onClick:F,className:"sketch-border-content px-3 py-2 font-bold sketch-text text-sm cursor-pointer whitespace-nowrap",style:{backgroundColor:l.bg,color:l.border},children:"Download model"})})})]}),b==="downloading"&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-[#5B9BD5] font-semibold",children:["⏳ Downloading... ",v,"%"]}),e.jsx("div",{className:"w-full bg-gray-200 h-2 rounded overflow-hidden border-2 border-black",children:e.jsx("div",{className:"bg-[#5B9BD5] h-full transition-all",style:{width:`${v}%`}})})]}),b==="ready"&&e.jsx("div",{className:"text-[#52B788] font-semibold",children:"✅ Model ready"}),e.jsx("div",{className:"sketch-info-text font-medium",style:{color:"#2C2C2C"},children:c?"✨ Translating...":a.status==="done"?e.jsx("span",{className:"font-bold",children:"✓ Done!"}):e.jsx("span",{className:"font-bold",children:"✓ Ready"})})]})]})})}),a.category!=="input"&&e.jsx(x,{type:"target",position:y.Top,style:{borderColor:l.border,"--handle-color":l.border}}),a.category!=="output"&&e.jsx(x,{type:"source",position:y.Bottom,style:{borderColor:l.border,"--handle-color":l.border}})]})};export{G as TranslateNode};
