import{r as t,j as e,X as k,L as v}from"./workflowEngine-c2npe68S.js";import{E as N,H as p,P as u}from"./index-CsMBKhrU.js";import{S as m}from"./SketchDropdown-D23-tWQg.js";import{S as w}from"./sparkles-BnBQ0m5e.js";const x={blue:{bg:"#E3F2FD",border:"#5B9BD5"},purple:{bg:"#F3E5F5",border:"#9B59B6"},mint:{bg:"#E0F2F1",border:"#4DB6AC"},pink:{bg:"#FCE4EC",border:"#EC407A"},peach:{bg:"#FFE0B2",border:"#FF8A65"},sage:{bg:"#E8F5E9",border:"#66BB6A"},yellow:{bg:"#FFF9C4",border:"#FDD835"}},C={input:"blue",processing:"purple",output:"sage"},E=s=>{if(!s)return x.purple;const n=C[s]||"purple";return x[n]},z=({data:s,selected:n})=>{const[i,r]=t.useState("checking"),[b,g]=t.useState(0),[c,y]=t.useState(s.type||"tldr"),[d,j]=t.useState(s.length||"medium");t.useEffect(()=>{s.type=c},[c]),t.useEffect(()=>{s.length=d},[d]),t.useEffect(()=>{(async()=>{try{const h=await Summarizer.availability();r(h)}catch{r("downloadable")}})()},[]);const f=async()=>{try{r("downloading"),await Summarizer.create({monitor(a){a.addEventListener("downloadprogress",h=>g(Math.round(h.loaded*100)))}}),r("ready")}catch{r("downloadable")}},l=s.status==="running",o=E(s.category);return e.jsxs("div",{style:{width:250},className:`sketch-node relative ${l?"sketch-node-running-flow":""} ${n?"sketch-node-selected":""}`,children:[n&&s.onDelete&&e.jsx("button",{onClick:a=>{a.stopPropagation(),s.onDelete?.(s.id)},className:"absolute -top-3 -right-3 flex items-center justify-center hover:scale-110 transition-all cursor-pointer w-7 h-7 rounded-full z-20 shadow-md",style:{backgroundColor:o.bg,color:o.border,border:`3px solid ${o.border}`,filter:"url(#rough-border)"},title:"Delete node (or press Delete/Backspace)",children:e.jsx(k,{size:14,strokeWidth:2.5})}),e.jsx("div",{className:"sketch-border",style:{"--sketch-color":o.border},children:e.jsx("div",{className:"sketch-border-inner",children:e.jsxs("div",{className:"sketch-border-content",children:[e.jsxs("div",{className:"px-4 py-3 font-bold text-base tracking-tight flex items-center justify-between gap-2",style:{backgroundColor:o.bg},children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[l?e.jsx(v,{size:18,className:"animate-spin shrink-0",style:{color:o.border}}):e.jsx(w,{size:18,className:"shrink-0 opacity-90",style:{color:o.border}}),e.jsx("span",{className:"sketch-text text-[17px] leading-tight",style:{color:o.border},children:"Summarize"})]}),e.jsx("div",{className:"flex items-center gap-1.5",children:s.output&&e.jsx("button",{onClick:()=>s.onInspect?.(s.id,s.output),className:"cursor-pointer hover:scale-125 transition-transform opacity-90 hover:opacity-100 shrink-0",style:{color:o.border},title:"Inspect output",children:e.jsx(N,{size:18,style:{color:o.border}})})})]}),e.jsxs("div",{className:"px-4 py-3 space-y-3 sketch-info-text text-sm font-medium bg-white",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Type"}),e.jsx(m,{value:c,onChange:y,disabled:l,options:[{value:"tldr",label:"tldr"},{value:"teaser",label:"teaser"},{value:"key-points",label:"key-points"},{value:"headline",label:"headline"}]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Length"}),e.jsx(m,{value:d,onChange:j,disabled:l,options:[{value:"short",label:"short"},{value:"medium",label:"medium"},{value:"long",label:"long"}]})]}),i==="downloadable"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-[#E09F7D] text-[15px] font-semibold",children:"⚠️ Model not installed"}),e.jsx("div",{className:"sketch-border sketch-button-hover inline-flex",style:{"--sketch-color":o.border},children:e.jsx("div",{className:"sketch-border-inner",children:e.jsx("button",{onClick:f,className:"sketch-border-content px-3 py-2 font-bold sketch-text text-sm cursor-pointer whitespace-nowrap",style:{backgroundColor:o.bg,color:o.border},children:"Download model"})})})]}),i==="downloading"&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-[#5B9BD5] font-semibold",children:["⏳ Downloading... ",b,"%"]}),e.jsx("div",{className:"w-full bg-gray-200 h-2 rounded overflow-hidden border-2 border-black",children:e.jsx("div",{className:"bg-[#5B9BD5] h-full transition-all",style:{width:`${b}%`}})})]}),i==="ready"&&e.jsx("div",{className:"text-[#52B788] font-semibold",children:"✅ Model ready"}),e.jsx("div",{className:"sketch-info-text font-medium",style:{color:"#2C2C2C"},children:l?"✨ Summarizing...":s.status==="done"?e.jsx("span",{className:"font-bold",children:"✓ Done!"}):e.jsx("span",{className:"font-bold",children:"✓ Ready"})})]})]})})}),s.category!=="input"&&e.jsx(p,{type:"target",position:u.Top,style:{borderColor:o.border,"--handle-color":o.border}}),s.category!=="output"&&e.jsx(p,{type:"source",position:u.Bottom,style:{borderColor:o.border,"--handle-color":o.border}})]})};export{z as SummarizeNode};
