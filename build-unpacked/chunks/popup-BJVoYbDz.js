import{c as u,r as d,g as E,j as e,P as y,X as S,d as W,L as z,a as I,e as A,R as B,b as D}from"./workflowEngine-c2npe68S.js";const R=globalThis.browser?.runtime?.id?globalThis.browser:globalThis.chrome,x=R;/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],L=u("circle-check-big",T);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],M=u("circle-x",G);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],_=u("pencil",P),r={blue:{bg:"#E3F2FD",border:"#5B9BD5"},purple:{bg:"#F3E5F5",border:"#9B59B6"},mint:{bg:"#E0F2F1",border:"#4DB6AC"},pink:{bg:"#FCE4EC",border:"#EC407A"},peach:{bg:"#FFE0B2",border:"#FF8A65"},sage:{bg:"#E8F5E9",border:"#66BB6A"},yellow:{bg:"#FFF9C4",border:"#FDD835"}};function $(){const[c,N]=d.useState(null),[b,v]=d.useState([]),[p,n]=d.useState(null);d.useEffect(()=>{x.tabs.query({active:!0,currentWindow:!0}).then(s=>{s[0]?.id&&N(s[0].id)}),m()},[]);const m=async()=>{const s=await E();v(s)},h=async s=>{if(!c)return;const l=new URLSearchParams({sourceTabId:c.toString()});s&&l.append("workflowId",s);const a=x.runtime.getURL(`/workflow-builder.html?${l.toString()}`);await x.tabs.create({url:a})},w=async s=>{if(!c){n({workflowId:s.id,status:"error",message:"No active tab"});return}n({workflowId:s.id,status:"running"});try{await A(s,{tabId:c,mode:"headless",workflowName:s.name}),n({workflowId:s.id,status:"success",message:"Done!"}),setTimeout(()=>n(null),2e3)}catch(l){n({workflowId:s.id,status:"error",message:l instanceof Error?l.message:"Failed"}),setTimeout(()=>n(null),4e3)}};return e.jsxs("div",{className:"w-96 min-h-[500px] max-h-[600px] flex flex-col sketch-canvas overflow-hidden",style:{"--pastel-bg":"#FAFAFA","--sketch-color":"#000000"},children:[e.jsx("svg",{className:"sketch-svg-filters absolute w-0 h-0",children:e.jsxs("defs",{children:[e.jsxs("filter",{id:"rough-edge",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[e.jsx("feTurbulence",{type:"fractalNoise",baseFrequency:"0.02",numOctaves:"4",seed:"1",result:"noise"}),e.jsx("feDisplacementMap",{in:"SourceGraphic",in2:"noise",scale:"4",xChannelSelector:"R",yChannelSelector:"G",result:"displacement"}),e.jsx("feGaussianBlur",{in:"displacement",stdDeviation:"0.5",result:"blur"})]}),e.jsxs("filter",{id:"rough-border",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[e.jsx("feTurbulence",{type:"fractalNoise",baseFrequency:"0.04",numOctaves:"5",seed:"2",result:"noise"}),e.jsx("feDisplacementMap",{in:"SourceGraphic",in2:"noise",scale:"3",xChannelSelector:"R",yChannelSelector:"G",result:"displacement"}),e.jsx("feGaussianBlur",{in:"displacement",stdDeviation:"0.3",result:"blur"})]})]})}),e.jsxs("div",{className:"px-5 py-4 bg-white text-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:"/logo.png",alt:"Flosheet AI",className:"w-7 h-7 object-contain shrink-0",style:{marginTop:"-5px"}}),e.jsx("h1",{className:"text-lg font-bold sketch-text text-gray-800",children:"Flosheet AI"})]}),e.jsx("div",{className:"sketch-node",children:e.jsx("div",{className:"sketch-border sketch-button-hover",style:{"--sketch-color":"#2C2C2C"},children:e.jsx("div",{className:"sketch-border-inner",children:e.jsx("div",{className:"sketch-border-content bg-white text-gray-800",children:e.jsxs("button",{onClick:()=>h(),disabled:!c,className:"flex items-center gap-1.5 disabled:opacity-40 disabled:cursor-not-allowed px-3 py-2 font-bold sketch-text cursor-pointer text-[15px]",children:[e.jsx(y,{size:16,strokeWidth:2.5}),e.jsx("span",{children:"New"})]})})})})})]}),e.jsx("p",{className:"sketch-info-text text-sm opacity-70",children:"Run workflows on the current page"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-3 space-y-3",children:b.length===0?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center space-y-4 max-w-xs sketch-text",children:[e.jsx("div",{className:"flex items-center justify-center mx-auto w-20 h-20",children:e.jsx("img",{src:"/logo.png",alt:"Flosheet AI",className:"w-16 h-16 object-contain opacity-30"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold mb-1 text-[17px] text-gray-800",children:"No flosheets yet"}),e.jsx("p",{className:"mb-4 sketch-info-text text-[15px] text-gray-600 opacity-80",children:"Create your first flosheet to get started"}),e.jsx("div",{className:"sketch-node inline-block",children:e.jsx("div",{className:"sketch-border sketch-button-hover",style:{"--sketch-color":r.purple.border},children:e.jsx("div",{className:"sketch-border-inner",children:e.jsx("div",{className:"sketch-border-content",style:{backgroundColor:r.purple.bg,color:r.purple.border},children:e.jsxs("button",{onClick:()=>h(),disabled:!c,className:"inline-flex items-center gap-1.5 disabled:opacity-40 disabled:cursor-not-allowed px-3 py-2 font-bold sketch-text cursor-pointer text-[15px]",children:[e.jsx(y,{size:16,strokeWidth:2.5}),e.jsx("span",{children:"Create flosheet"})]})})})})})]})]})}):b.map((s,l)=>{const a=p?.workflowId===s.id?p:null,i=a?.status==="running",g=a?.status==="success",j=a?.status==="error",k=Object.keys(r),C=k[l%k.length],f=r[C];let o=f.bg,t=f.border;return i?(o=r.blue.bg,t=r.blue.border):g?(o=r.sage.bg,t=r.sage.border):j&&(o=r.peach.bg,t=r.peach.border),e.jsxs("div",{className:`sketch-border relative ${i?"sketch-node-running":""}`,style:{"--sketch-color":t},children:[e.jsx("button",{onClick:async F=>{F.stopPropagation(),await W(s.id),await m()},className:"absolute -top-3 -right-3 flex items-center justify-center hover:scale-110 transition-all cursor-pointer w-7 h-7 rounded-full z-20 shadow-md",style:{backgroundColor:o,color:t,border:`3px solid ${t}`,filter:"url(#rough-border)"},title:"Delete flosheet",children:e.jsx(S,{size:14,strokeWidth:2.5})}),e.jsx("div",{className:"sketch-border-inner",children:e.jsx("div",{className:"sketch-border-content p-4",style:{backgroundColor:o,color:t},children:e.jsxs("div",{className:"flex items-start justify-between gap-3 pr-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold mb-1 truncate sketch-text text-base",children:s.name}),e.jsxs("p",{className:"sketch-info-text text-[11px] opacity-70",children:[s.nodes.length," node",s.nodes.length!==1?"s":""]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"sketch-border sketch-button-hover",style:{"--sketch-color":t},children:e.jsx("div",{className:"sketch-border-inner",children:e.jsxs("button",{onClick:()=>h(s.id),disabled:!c,className:"sketch-border-content flex items-center gap-1.5 disabled:cursor-not-allowed disabled:opacity-40 px-3 py-2 font-bold sketch-text cursor-pointer text-sm whitespace-nowrap",style:{backgroundColor:o,color:t},children:[e.jsx(_,{size:14,strokeWidth:2.5}),e.jsx("span",{children:"Edit"})]})})}),e.jsx("div",{className:"sketch-border sketch-button-hover",style:{"--sketch-color":t},children:e.jsx("div",{className:"sketch-border-inner",children:e.jsx("button",{onClick:()=>w(s),disabled:!c||i,className:"sketch-border-content flex items-center gap-1.5 disabled:cursor-not-allowed disabled:opacity-40 px-3 py-2 font-bold sketch-text cursor-pointer text-sm whitespace-nowrap",style:{backgroundColor:o,color:t},children:i?e.jsxs(e.Fragment,{children:[e.jsx(z,{size:14,className:"animate-spin",strokeWidth:2.5}),e.jsx("span",{children:"Running"})]}):g?e.jsxs(e.Fragment,{children:[e.jsx(L,{size:14,strokeWidth:2.5}),e.jsx("span",{children:"Done!"})]}):j?e.jsxs(e.Fragment,{children:[e.jsx(M,{size:14,strokeWidth:2.5}),e.jsx("span",{children:"Failed"})]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{size:14,fill:"currentColor",strokeWidth:0}),e.jsx("span",{children:"Run"})]})})})})]})]})})})]},s.id)})})]})}B.createRoot(document.getElementById("root")).render(e.jsx(D.StrictMode,{children:e.jsx($,{})}));
