var content=(function(){"use strict";function A0(e){return e}const Bn=globalThis.browser?.runtime?.id?globalThis.browser:globalThis.chrome,Da={matches:["<all_urls>"],main(){Bn.runtime.onMessage.addListener((e,t,n)=>{if(e.type==="EXECUTE_WORKFLOW")return La(e.workflow,e.selectedText).then(r=>n({success:!0,result:r})).catch(r=>n({success:!1,error:r.message})),!0})}};async function La(e,t){const{executeWorkflow:n}=await Promise.resolve().then(()=>sc);return await n(e,{tabId:0,mode:"headless",workflowName:e.name,pageContext:{url:window.location.href,title:document.title,selectedText:t||window.getSelection()?.toString()||""}})}function Ot(e,...t){}const za={debug:(...e)=>Ot(console.debug,...e),log:(...e)=>Ot(console.log,...e),warn:(...e)=>Ot(console.warn,...e),error:(...e)=>Ot(console.error,...e)};class Hn extends Event{constructor(t,n){super(Hn.EVENT_NAME,{}),this.newUrl=t,this.oldUrl=n}static EVENT_NAME=On("wxt:locationchange")}function On(e){return`${Bn?.runtime?.id}:content:${e}`}function Ba(e){let t,n;return{run(){t==null&&(n=new URL(location.href),t=e.setInterval(()=>{let r=new URL(location.href);r.href!==n.href&&(window.dispatchEvent(new Hn(r,n)),n=r)},1e3))}}}class jt{constructor(t,n){this.contentScriptName=t,this.options=n,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}static SCRIPT_STARTED_MESSAGE_TYPE=On("wxt:content-script-started");isTopFrame=window.self===window.top;abortController;locationWatcher=Ba(this);receivedMessageIds=new Set;get signal(){return this.abortController.signal}abort(t){return this.abortController.abort(t)}get isInvalid(){return Bn.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(t){return this.signal.addEventListener("abort",t),()=>this.signal.removeEventListener("abort",t)}block(){return new Promise(()=>{})}setInterval(t,n){const r=setInterval(()=>{this.isValid&&t()},n);return this.onInvalidated(()=>clearInterval(r)),r}setTimeout(t,n){const r=setTimeout(()=>{this.isValid&&t()},n);return this.onInvalidated(()=>clearTimeout(r)),r}requestAnimationFrame(t){const n=requestAnimationFrame((...r)=>{this.isValid&&t(...r)});return this.onInvalidated(()=>cancelAnimationFrame(n)),n}requestIdleCallback(t,n){const r=requestIdleCallback((...o)=>{this.signal.aborted||t(...o)},n);return this.onInvalidated(()=>cancelIdleCallback(r)),r}addEventListener(t,n,r,o){n==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),t.addEventListener?.(n.startsWith("wxt:")?On(n):n,r,{...o,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),za.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:jt.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(t){const n=t.data?.type===jt.SCRIPT_STARTED_MESSAGE_TYPE,r=t.data?.contentScriptName===this.contentScriptName,o=!this.receivedMessageIds.has(t.data?.messageId);return n&&r&&o}listenForNewerScripts(t){let n=!0;const r=o=>{if(this.verifyScriptStartedEvent(o)){this.receivedMessageIds.add(o.data.messageId);const i=n;if(n=!1,i&&t?.ignoreFirstEvent)return;this.notifyInvalidated()}};addEventListener("message",r),this.onInvalidated(()=>removeEventListener("message",r))}}function M0(){}function Ft(e,...t){}const Ha={debug:(...e)=>Ft(console.debug,...e),log:(...e)=>Ft(console.log,...e),warn:(...e)=>Ft(console.warn,...e),error:(...e)=>Ft(console.error,...e)},Oa=(async()=>{try{const{main:e,...t}=Da,n=new jt("content",t);return await e(n)}catch(e){throw Ha.error('The content script "content" crashed on startup!',e),e}})(),ja={type:"getPageText",label:"Get Page Text",description:"Extract readable text from the current page using Readability",color:"bg-blue-600/70",icon:"FileText",category:"input"};async function Fa(e,t){try{if(t)return{html:document.documentElement.outerHTML,url:t.url||window.location.href};if(!e)throw new Error("Tab ID is required");if(!chrome.scripting)throw new Error("Cannot access page content in this context");const n=await chrome.scripting.executeScript({target:{tabId:e},func:()=>({html:document.documentElement.outerHTML,url:window.location.href})});if(!n||!n[0]?.result)throw new Error("Failed to execute script in tab");return n[0].result}catch(n){throw console.error("Failed to get HTML from tab:",n),new Error(`Could not access tab ${e}: ${n instanceof Error?n.message:String(n)}`)}}function eo(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var jn={exports:{}},to;function Va(){return to||(to=1,(function(e){function t(n,r){if(r&&r.documentElement)n=r,r=arguments[2];else if(!n||!n.documentElement)throw new Error("First argument to Readability constructor should be a document object.");if(r=r||{},this._doc=n,this._docJSDOMParser=this._doc.firstChild.__JSDOMParser__,this._articleTitle=null,this._articleByline=null,this._articleDir=null,this._articleSiteName=null,this._attempts=[],this._metadata={},this._debug=!!r.debug,this._maxElemsToParse=r.maxElemsToParse||this.DEFAULT_MAX_ELEMS_TO_PARSE,this._nbTopCandidates=r.nbTopCandidates||this.DEFAULT_N_TOP_CANDIDATES,this._charThreshold=r.charThreshold||this.DEFAULT_CHAR_THRESHOLD,this._classesToPreserve=this.CLASSES_TO_PRESERVE.concat(r.classesToPreserve||[]),this._keepClasses=!!r.keepClasses,this._serializer=r.serializer||function(o){return o.innerHTML},this._disableJSONLD=!!r.disableJSONLD,this._allowedVideoRegex=r.allowedVideoRegex||this.REGEXPS.videos,this._linkDensityModifier=r.linkDensityModifier||0,this._flags=this.FLAG_STRIP_UNLIKELYS|this.FLAG_WEIGHT_CLASSES|this.FLAG_CLEAN_CONDITIONALLY,this._debug){let o=function(i){if(i.nodeType==i.TEXT_NODE)return`${i.nodeName} ("${i.textContent}")`;let s=Array.from(i.attributes||[],function(a){return`${a.name}="${a.value}"`}).join(" ");return`<${i.localName} ${s}>`};this.log=function(){if(typeof console<"u"){let s=Array.from(arguments,a=>a&&a.nodeType==this.ELEMENT_NODE?o(a):a);s.unshift("Reader: (Readability)"),console.log(...s)}else if(typeof dump<"u"){var i=Array.prototype.map.call(arguments,function(s){return s&&s.nodeName?o(s):s}).join(" ");dump("Reader: (Readability) "+i+`
`)}}}else this.log=function(){}}t.prototype={FLAG_STRIP_UNLIKELYS:1,FLAG_WEIGHT_CLASSES:2,FLAG_CLEAN_CONDITIONALLY:4,ELEMENT_NODE:1,TEXT_NODE:3,DEFAULT_MAX_ELEMS_TO_PARSE:0,DEFAULT_N_TOP_CANDIDATES:5,DEFAULT_TAGS_TO_SCORE:"section,h2,h3,h4,h5,h6,p,td,pre".toUpperCase().split(","),DEFAULT_CHAR_THRESHOLD:500,REGEXPS:{unlikelyCandidates:/-ad-|ai2html|banner|breadcrumbs|combx|comment|community|cover-wrap|disqus|extra|footer|gdpr|header|legends|menu|related|remark|replies|rss|shoutbox|sidebar|skyscraper|social|sponsor|supplemental|ad-break|agegate|pagination|pager|popup|yom-remote/i,okMaybeItsACandidate:/and|article|body|column|content|main|shadow/i,positive:/article|body|content|entry|hentry|h-entry|main|page|pagination|post|text|blog|story/i,negative:/-ad-|hidden|^hid$| hid$| hid |^hid |banner|combx|comment|com-|contact|footer|gdpr|masthead|media|meta|outbrain|promo|related|scroll|share|shoutbox|sidebar|skyscraper|sponsor|shopping|tags|widget/i,extraneous:/print|archive|comment|discuss|e[\-]?mail|share|reply|all|login|sign|single|utility/i,byline:/byline|author|dateline|writtenby|p-author/i,replaceFonts:/<(\/?)font[^>]*>/gi,normalize:/\s{2,}/g,videos:/\/\/(www\.)?((dailymotion|youtube|youtube-nocookie|player\.vimeo|v\.qq)\.com|(archive|upload\.wikimedia)\.org|player\.twitch\.tv)/i,shareElements:/(\b|_)(share|sharedaddy)(\b|_)/i,nextLink:/(next|weiter|continue|>([^\|]|$)|»([^\|]|$))/i,prevLink:/(prev|earl|old|new|<|«)/i,tokenize:/\W+/g,whitespace:/^\s*$/,hasContent:/\S$/,hashUrl:/^#.+/,srcsetUrl:/(\S+)(\s+[\d.]+[xw])?(\s*(?:,|$))/g,b64DataUrl:/^data:\s*([^\s;,]+)\s*;\s*base64\s*,/i,commas:/\u002C|\u060C|\uFE50|\uFE10|\uFE11|\u2E41|\u2E34|\u2E32|\uFF0C/g,jsonLdArticleTypes:/^Article|AdvertiserContentArticle|NewsArticle|AnalysisNewsArticle|AskPublicNewsArticle|BackgroundNewsArticle|OpinionNewsArticle|ReportageNewsArticle|ReviewNewsArticle|Report|SatiricalArticle|ScholarlyArticle|MedicalScholarlyArticle|SocialMediaPosting|BlogPosting|LiveBlogPosting|DiscussionForumPosting|TechArticle|APIReference$/,adWords:/^(ad(vertising|vertisement)?|pub(licité)?|werb(ung)?|广告|Реклама|Anuncio)$/iu,loadingWords:/^((loading|正在加载|Загрузка|chargement|cargando)(…|\.\.\.)?)$/iu},UNLIKELY_ROLES:["menu","menubar","complementary","navigation","alert","alertdialog","dialog"],DIV_TO_P_ELEMS:new Set(["BLOCKQUOTE","DL","DIV","IMG","OL","P","PRE","TABLE","UL"]),ALTER_TO_DIV_EXCEPTIONS:["DIV","ARTICLE","SECTION","P","OL","UL"],PRESENTATIONAL_ATTRIBUTES:["align","background","bgcolor","border","cellpadding","cellspacing","frame","hspace","rules","style","valign","vspace"],DEPRECATED_SIZE_ATTRIBUTE_ELEMS:["TABLE","TH","TD","HR","PRE"],PHRASING_ELEMS:["ABBR","AUDIO","B","BDO","BR","BUTTON","CITE","CODE","DATA","DATALIST","DFN","EM","EMBED","I","IMG","INPUT","KBD","LABEL","MARK","MATH","METER","NOSCRIPT","OBJECT","OUTPUT","PROGRESS","Q","RUBY","SAMP","SCRIPT","SELECT","SMALL","SPAN","STRONG","SUB","SUP","TEXTAREA","TIME","VAR","WBR"],CLASSES_TO_PRESERVE:["page"],HTML_ESCAPE_MAP:{lt:"<",gt:">",amp:"&",quot:'"',apos:"'"},_postProcessContent(n){this._fixRelativeUris(n),this._simplifyNestedElements(n),this._keepClasses||this._cleanClasses(n)},_removeNodes(n,r){if(this._docJSDOMParser&&n._isLiveNodeList)throw new Error("Do not pass live node lists to _removeNodes");for(var o=n.length-1;o>=0;o--){var i=n[o],s=i.parentNode;s&&(!r||r.call(this,i,o,n))&&s.removeChild(i)}},_replaceNodeTags(n,r){if(this._docJSDOMParser&&n._isLiveNodeList)throw new Error("Do not pass live node lists to _replaceNodeTags");for(const o of n)this._setNodeTag(o,r)},_forEachNode(n,r){Array.prototype.forEach.call(n,r,this)},_findNode(n,r){return Array.prototype.find.call(n,r,this)},_someNode(n,r){return Array.prototype.some.call(n,r,this)},_everyNode(n,r){return Array.prototype.every.call(n,r,this)},_getAllNodesWithTag(n,r){return n.querySelectorAll?n.querySelectorAll(r.join(",")):[].concat.apply([],r.map(function(o){var i=n.getElementsByTagName(o);return Array.isArray(i)?i:Array.from(i)}))},_cleanClasses(n){var r=this._classesToPreserve,o=(n.getAttribute("class")||"").split(/\s+/).filter(i=>r.includes(i)).join(" ");for(o?n.setAttribute("class",o):n.removeAttribute("class"),n=n.firstElementChild;n;n=n.nextElementSibling)this._cleanClasses(n)},_isUrl(n){try{return new URL(n),!0}catch{return!1}},_fixRelativeUris(n){var r=this._doc.baseURI,o=this._doc.documentURI;function i(l){if(r==o&&l.charAt(0)=="#")return l;try{return new URL(l,r).href}catch{}return l}var s=this._getAllNodesWithTag(n,["a"]);this._forEachNode(s,function(l){var c=l.getAttribute("href");if(c)if(c.indexOf("javascript:")===0)if(l.childNodes.length===1&&l.childNodes[0].nodeType===this.TEXT_NODE){var h=this._doc.createTextNode(l.textContent);l.parentNode.replaceChild(h,l)}else{for(var u=this._doc.createElement("span");l.firstChild;)u.appendChild(l.firstChild);l.parentNode.replaceChild(u,l)}else l.setAttribute("href",i(c))});var a=this._getAllNodesWithTag(n,["img","picture","figure","video","audio","source"]);this._forEachNode(a,function(l){var c=l.getAttribute("src"),h=l.getAttribute("poster"),u=l.getAttribute("srcset");if(c&&l.setAttribute("src",i(c)),h&&l.setAttribute("poster",i(h)),u){var d=u.replace(this.REGEXPS.srcsetUrl,function(f,m,g,v){return i(m)+(g||"")+v});l.setAttribute("srcset",d)}})},_simplifyNestedElements(n){for(var r=n;r;){if(r.parentNode&&["DIV","SECTION"].includes(r.tagName)&&!(r.id&&r.id.startsWith("readability"))){if(this._isElementWithoutContent(r)){r=this._removeAndGetNext(r);continue}else if(this._hasSingleTagInsideElement(r,"DIV")||this._hasSingleTagInsideElement(r,"SECTION")){for(var o=r.children[0],i=0;i<r.attributes.length;i++)o.setAttributeNode(r.attributes[i].cloneNode());r.parentNode.replaceChild(o,r),r=o;continue}}r=this._getNextNode(r)}},_getArticleTitle(){var n=this._doc,r="",o="";try{r=o=n.title.trim(),typeof r!="string"&&(r=o=this._getInnerText(n.getElementsByTagName("title")[0]))}catch{}var i=!1;function s(d){return d.split(/\s+/).length}if(/ [\|\-\\\/>»] /.test(r)){i=/ [\\\/>»] /.test(r);let d=Array.from(o.matchAll(/ [\|\-\\\/>»] /gi));r=o.substring(0,d.pop().index),s(r)<3&&(r=o.replace(/^[^\|\-\\\/>»]*[\|\-\\\/>»]/gi,""))}else if(r.includes(": ")){var a=this._getAllNodesWithTag(n,["h1","h2"]),l=r.trim(),c=this._someNode(a,function(d){return d.textContent.trim()===l});c||(r=o.substring(o.lastIndexOf(":")+1),s(r)<3?r=o.substring(o.indexOf(":")+1):s(o.substr(0,o.indexOf(":")))>5&&(r=o))}else if(r.length>150||r.length<15){var h=n.getElementsByTagName("h1");h.length===1&&(r=this._getInnerText(h[0]))}r=r.trim().replace(this.REGEXPS.normalize," ");var u=s(r);return u<=4&&(!i||u!=s(o.replace(/[\|\-\\\/>»]+/g,""))-1)&&(r=o),r},_prepDocument(){var n=this._doc;this._removeNodes(this._getAllNodesWithTag(n,["style"])),n.body&&this._replaceBrs(n.body),this._replaceNodeTags(this._getAllNodesWithTag(n,["font"]),"SPAN")},_nextNode(n){for(var r=n;r&&r.nodeType!=this.ELEMENT_NODE&&this.REGEXPS.whitespace.test(r.textContent);)r=r.nextSibling;return r},_replaceBrs(n){this._forEachNode(this._getAllNodesWithTag(n,["br"]),function(r){for(var o=r.nextSibling,i=!1;(o=this._nextNode(o))&&o.tagName=="BR";){i=!0;var s=o.nextSibling;o.remove(),o=s}if(i){var a=this._doc.createElement("p");for(r.parentNode.replaceChild(a,r),o=a.nextSibling;o;){if(o.tagName=="BR"){var l=this._nextNode(o.nextSibling);if(l&&l.tagName=="BR")break}if(!this._isPhrasingContent(o))break;var c=o.nextSibling;a.appendChild(o),o=c}for(;a.lastChild&&this._isWhitespace(a.lastChild);)a.lastChild.remove();a.parentNode.tagName==="P"&&this._setNodeTag(a.parentNode,"DIV")}})},_setNodeTag(n,r){if(this.log("_setNodeTag",n,r),this._docJSDOMParser)return n.localName=r.toLowerCase(),n.tagName=r.toUpperCase(),n;for(var o=n.ownerDocument.createElement(r);n.firstChild;)o.appendChild(n.firstChild);n.parentNode.replaceChild(o,n),n.readability&&(o.readability=n.readability);for(var i=0;i<n.attributes.length;i++)o.setAttributeNode(n.attributes[i].cloneNode());return o},_prepArticle(n){this._cleanStyles(n),this._markDataTables(n),this._fixLazyImages(n),this._cleanConditionally(n,"form"),this._cleanConditionally(n,"fieldset"),this._clean(n,"object"),this._clean(n,"embed"),this._clean(n,"footer"),this._clean(n,"link"),this._clean(n,"aside");var r=this.DEFAULT_CHAR_THRESHOLD;this._forEachNode(n.children,function(o){this._cleanMatchedNodes(o,function(i,s){return this.REGEXPS.shareElements.test(s)&&i.textContent.length<r})}),this._clean(n,"iframe"),this._clean(n,"input"),this._clean(n,"textarea"),this._clean(n,"select"),this._clean(n,"button"),this._cleanHeaders(n),this._cleanConditionally(n,"table"),this._cleanConditionally(n,"ul"),this._cleanConditionally(n,"div"),this._replaceNodeTags(this._getAllNodesWithTag(n,["h1"]),"h2"),this._removeNodes(this._getAllNodesWithTag(n,["p"]),function(o){var i=this._getAllNodesWithTag(o,["img","embed","object","iframe"]).length;return i===0&&!this._getInnerText(o,!1)}),this._forEachNode(this._getAllNodesWithTag(n,["br"]),function(o){var i=this._nextNode(o.nextSibling);i&&i.tagName=="P"&&o.remove()}),this._forEachNode(this._getAllNodesWithTag(n,["table"]),function(o){var i=this._hasSingleTagInsideElement(o,"TBODY")?o.firstElementChild:o;if(this._hasSingleTagInsideElement(i,"TR")){var s=i.firstElementChild;if(this._hasSingleTagInsideElement(s,"TD")){var a=s.firstElementChild;a=this._setNodeTag(a,this._everyNode(a.childNodes,this._isPhrasingContent)?"P":"DIV"),o.parentNode.replaceChild(a,o)}}})},_initializeNode(n){switch(n.readability={contentScore:0},n.tagName){case"DIV":n.readability.contentScore+=5;break;case"PRE":case"TD":case"BLOCKQUOTE":n.readability.contentScore+=3;break;case"ADDRESS":case"OL":case"UL":case"DL":case"DD":case"DT":case"LI":case"FORM":n.readability.contentScore-=3;break;case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"TH":n.readability.contentScore-=5;break}n.readability.contentScore+=this._getClassWeight(n)},_removeAndGetNext(n){var r=this._getNextNode(n,!0);return n.remove(),r},_getNextNode(n,r){if(!r&&n.firstElementChild)return n.firstElementChild;if(n.nextElementSibling)return n.nextElementSibling;do n=n.parentNode;while(n&&!n.nextElementSibling);return n&&n.nextElementSibling},_textSimilarity(n,r){var o=n.toLowerCase().split(this.REGEXPS.tokenize).filter(Boolean),i=r.toLowerCase().split(this.REGEXPS.tokenize).filter(Boolean);if(!o.length||!i.length)return 0;var s=i.filter(l=>!o.includes(l)),a=s.join(" ").length/i.join(" ").length;return 1-a},_isValidByline(n,r){var o=n.getAttribute("rel"),i=n.getAttribute("itemprop"),s=n.textContent.trim().length;return(o==="author"||i&&i.includes("author")||this.REGEXPS.byline.test(r))&&!!s&&s<100},_getNodeAncestors(n,r){r=r||0;for(var o=0,i=[];n.parentNode&&(i.push(n.parentNode),!(r&&++o===r));)n=n.parentNode;return i},_grabArticle(n){this.log("**** grabArticle ****");var r=this._doc,o=n!==null;if(n=n||this._doc.body,!n)return this.log("No body found in document. Abort."),null;for(var i=n.innerHTML;;){this.log("Starting grabArticle loop");var s=this._flagIsActive(this.FLAG_STRIP_UNLIKELYS),a=[],l=this._doc.documentElement;let ie=!0;for(;l;){l.tagName==="HTML"&&(this._articleLang=l.getAttribute("lang"));var c=l.className+" "+l.id;if(!this._isProbablyVisible(l)){this.log("Removing hidden node - "+c),l=this._removeAndGetNext(l);continue}if(l.getAttribute("aria-modal")=="true"&&l.getAttribute("role")=="dialog"){l=this._removeAndGetNext(l);continue}if(!this._articleByline&&!this._metadata.byline&&this._isValidByline(l,c)){for(var h=this._getNextNode(l,!0),u=this._getNextNode(l),d=null;u&&u!=h;){var f=u.getAttribute("itemprop");if(f&&f.includes("name")){d=u;break}else u=this._getNextNode(u)}this._articleByline=(d??l).textContent.trim(),l=this._removeAndGetNext(l);continue}if(ie&&this._headerDuplicatesTitle(l)){this.log("Removing header: ",l.textContent.trim(),this._articleTitle.trim()),ie=!1,l=this._removeAndGetNext(l);continue}if(s){if(this.REGEXPS.unlikelyCandidates.test(c)&&!this.REGEXPS.okMaybeItsACandidate.test(c)&&!this._hasAncestorTag(l,"table")&&!this._hasAncestorTag(l,"code")&&l.tagName!=="BODY"&&l.tagName!=="A"){this.log("Removing unlikely candidate - "+c),l=this._removeAndGetNext(l);continue}if(this.UNLIKELY_ROLES.includes(l.getAttribute("role"))){this.log("Removing content with role "+l.getAttribute("role")+" - "+c),l=this._removeAndGetNext(l);continue}}if((l.tagName==="DIV"||l.tagName==="SECTION"||l.tagName==="HEADER"||l.tagName==="H1"||l.tagName==="H2"||l.tagName==="H3"||l.tagName==="H4"||l.tagName==="H5"||l.tagName==="H6")&&this._isElementWithoutContent(l)){l=this._removeAndGetNext(l);continue}if(this.DEFAULT_TAGS_TO_SCORE.includes(l.tagName)&&a.push(l),l.tagName==="DIV"){for(var m=null,g=l.firstChild;g;){var v=g.nextSibling;if(this._isPhrasingContent(g))m!==null?m.appendChild(g):this._isWhitespace(g)||(m=r.createElement("p"),l.replaceChild(m,g),m.appendChild(g));else if(m!==null){for(;m.lastChild&&this._isWhitespace(m.lastChild);)m.lastChild.remove();m=null}g=v}if(this._hasSingleTagInsideElement(l,"P")&&this._getLinkDensity(l)<.25){var w=l.children[0];l.parentNode.replaceChild(w,l),l=w,a.push(l)}else this._hasChildBlockElement(l)||(l=this._setNodeTag(l,"P"),a.push(l))}l=this._getNextNode(l)}var S=[];this._forEachNode(a,function(se){if(!(!se.parentNode||typeof se.parentNode.tagName>"u")){var ue=this._getInnerText(se);if(!(ue.length<25)){var Re=this._getNodeAncestors(se,5);if(Re.length!==0){var De=0;De+=1,De+=ue.split(this.REGEXPS.commas).length,De+=Math.min(Math.floor(ue.length/100),3),this._forEachNode(Re,function(me,Le){if(!(!me.tagName||!me.parentNode||typeof me.parentNode.tagName>"u")){if(typeof me.readability>"u"&&(this._initializeNode(me),S.push(me)),Le===0)var ze=1;else Le===1?ze=2:ze=Le*3;me.readability.contentScore+=De/ze}})}}}});for(var p=[],b=0,C=S.length;b<C;b+=1){var E=S[b],k=E.readability.contentScore*(1-this._getLinkDensity(E));E.readability.contentScore=k,this.log("Candidate:",E,"with score "+k);for(var P=0;P<this._nbTopCandidates;P++){var L=p[P];if(!L||k>L.readability.contentScore){p.splice(P,0,E),p.length>this._nbTopCandidates&&p.pop();break}}}var O=p[0]||null,z=!1,M;if(O===null||O.tagName==="BODY"){for(O=r.createElement("DIV"),z=!0;n.firstChild;)this.log("Moving child out:",n.firstChild),O.appendChild(n.firstChild);n.appendChild(O),this._initializeNode(O)}else if(O){for(var B=[],_=1;_<p.length;_++)p[_].readability.contentScore/O.readability.contentScore>=.75&&B.push(this._getNodeAncestors(p[_]));var A=3;if(B.length>=A)for(M=O.parentNode;M.tagName!=="BODY";){for(var T=0,$=0;$<B.length&&T<A;$++)T+=Number(B[$].includes(M));if(T>=A){O=M;break}M=M.parentNode}O.readability||this._initializeNode(O),M=O.parentNode;for(var R=O.readability.contentScore,D=R/3;M.tagName!=="BODY";){if(!M.readability){M=M.parentNode;continue}var F=M.readability.contentScore;if(F<D)break;if(F>R){O=M;break}R=M.readability.contentScore,M=M.parentNode}for(M=O.parentNode;M.tagName!="BODY"&&M.children.length==1;)O=M,M=O.parentNode;O.readability||this._initializeNode(O)}var y=r.createElement("DIV");o&&(y.id="readability-content");var N=Math.max(10,O.readability.contentScore*.2);M=O.parentNode;for(var j=M.children,H=0,W=j.length;H<W;H++){var X=j[H],G=!1;if(this.log("Looking at sibling node:",X,X.readability?"with score "+X.readability.contentScore:""),this.log("Sibling has score",X.readability?X.readability.contentScore:"Unknown"),X===O)G=!0;else{var V=0;if(X.className===O.className&&O.className!==""&&(V+=O.readability.contentScore*.2),X.readability&&X.readability.contentScore+V>=N)G=!0;else if(X.nodeName==="P"){var Y=this._getLinkDensity(X),J=this._getInnerText(X),Q=J.length;(Q>80&&Y<.25||Q<80&&Q>0&&Y===0&&J.search(/\.( |$)/)!==-1)&&(G=!0)}}G&&(this.log("Appending node:",X),this.ALTER_TO_DIV_EXCEPTIONS.includes(X.nodeName)||(this.log("Altering sibling:",X,"to div."),X=this._setNodeTag(X,"DIV")),y.appendChild(X),j=M.children,H-=1,W-=1)}if(this._debug&&this.log("Article content pre-prep: "+y.innerHTML),this._prepArticle(y),this._debug&&this.log("Article content post-prep: "+y.innerHTML),z)O.id="readability-page-1",O.className="page";else{var U=r.createElement("DIV");for(U.id="readability-page-1",U.className="page";y.firstChild;)U.appendChild(y.firstChild);y.appendChild(U)}this._debug&&this.log("Article content after paging: "+y.innerHTML);var Z=!0,ee=this._getInnerText(y,!0).length;if(ee<this._charThreshold)if(Z=!1,n.innerHTML=i,this._attempts.push({articleContent:y,textLength:ee}),this._flagIsActive(this.FLAG_STRIP_UNLIKELYS))this._removeFlag(this.FLAG_STRIP_UNLIKELYS);else if(this._flagIsActive(this.FLAG_WEIGHT_CLASSES))this._removeFlag(this.FLAG_WEIGHT_CLASSES);else if(this._flagIsActive(this.FLAG_CLEAN_CONDITIONALLY))this._removeFlag(this.FLAG_CLEAN_CONDITIONALLY);else{if(this._attempts.sort(function(se,ue){return ue.textLength-se.textLength}),!this._attempts[0].textLength)return null;y=this._attempts[0].articleContent,Z=!0}if(Z){var oe=[M,O].concat(this._getNodeAncestors(M));return this._someNode(oe,function(se){if(!se.tagName)return!1;var ue=se.getAttribute("dir");return ue?(this._articleDir=ue,!0):!1}),y}}},_unescapeHtmlEntities(n){if(!n)return n;var r=this.HTML_ESCAPE_MAP;return n.replace(/&(quot|amp|apos|lt|gt);/g,function(o,i){return r[i]}).replace(/&#(?:x([0-9a-f]+)|([0-9]+));/gi,function(o,i,s){var a=parseInt(i||s,i?16:10);return(a==0||a>1114111||a>=55296&&a<=57343)&&(a=65533),String.fromCodePoint(a)})},_getJSONLD(n){var r=this._getAllNodesWithTag(n,["script"]),o;return this._forEachNode(r,function(i){if(!o&&i.getAttribute("type")==="application/ld+json")try{var s=i.textContent.replace(/^\s*<!\[CDATA\[|\]\]>\s*$/g,""),a=JSON.parse(s);if(Array.isArray(a)&&(a=a.find(f=>f["@type"]&&f["@type"].match(this.REGEXPS.jsonLdArticleTypes)),!a))return;var l=/^https?\:\/\/schema\.org\/?$/,c=typeof a["@context"]=="string"&&a["@context"].match(l)||typeof a["@context"]=="object"&&typeof a["@context"]["@vocab"]=="string"&&a["@context"]["@vocab"].match(l);if(!c||(!a["@type"]&&Array.isArray(a["@graph"])&&(a=a["@graph"].find(f=>(f["@type"]||"").match(this.REGEXPS.jsonLdArticleTypes))),!a||!a["@type"]||!a["@type"].match(this.REGEXPS.jsonLdArticleTypes)))return;if(o={},typeof a.name=="string"&&typeof a.headline=="string"&&a.name!==a.headline){var h=this._getArticleTitle(),u=this._textSimilarity(a.name,h)>.75,d=this._textSimilarity(a.headline,h)>.75;d&&!u?o.title=a.headline:o.title=a.name}else typeof a.name=="string"?o.title=a.name.trim():typeof a.headline=="string"&&(o.title=a.headline.trim());a.author&&(typeof a.author.name=="string"?o.byline=a.author.name.trim():Array.isArray(a.author)&&a.author[0]&&typeof a.author[0].name=="string"&&(o.byline=a.author.filter(function(f){return f&&typeof f.name=="string"}).map(function(f){return f.name.trim()}).join(", "))),typeof a.description=="string"&&(o.excerpt=a.description.trim()),a.publisher&&typeof a.publisher.name=="string"&&(o.siteName=a.publisher.name.trim()),typeof a.datePublished=="string"&&(o.datePublished=a.datePublished.trim())}catch(f){this.log(f.message)}}),o||{}},_getArticleMetadata(n){var r={},o={},i=this._doc.getElementsByTagName("meta"),s=/\s*(article|dc|dcterm|og|twitter)\s*:\s*(author|creator|description|published_time|title|site_name)\s*/gi,a=/^\s*(?:(dc|dcterm|og|twitter|parsely|weibo:(article|webpage))\s*[-\.:]\s*)?(author|creator|pub-date|description|title|site_name)\s*$/i;this._forEachNode(i,function(c){var h=c.getAttribute("name"),u=c.getAttribute("property"),d=c.getAttribute("content");if(d){var f=null,m=null;u&&(f=u.match(s),f&&(m=f[0].toLowerCase().replace(/\s/g,""),o[m]=d.trim())),!f&&h&&a.test(h)&&(m=h,d&&(m=m.toLowerCase().replace(/\s/g,"").replace(/\./g,":"),o[m]=d.trim()))}}),r.title=n.title||o["dc:title"]||o["dcterm:title"]||o["og:title"]||o["weibo:article:title"]||o["weibo:webpage:title"]||o.title||o["twitter:title"]||o["parsely-title"],r.title||(r.title=this._getArticleTitle());const l=typeof o["article:author"]=="string"&&!this._isUrl(o["article:author"])?o["article:author"]:void 0;return r.byline=n.byline||o["dc:creator"]||o["dcterm:creator"]||o.author||o["parsely-author"]||l,r.excerpt=n.excerpt||o["dc:description"]||o["dcterm:description"]||o["og:description"]||o["weibo:article:description"]||o["weibo:webpage:description"]||o.description||o["twitter:description"],r.siteName=n.siteName||o["og:site_name"],r.publishedTime=n.datePublished||o["article:published_time"]||o["parsely-pub-date"]||null,r.title=this._unescapeHtmlEntities(r.title),r.byline=this._unescapeHtmlEntities(r.byline),r.excerpt=this._unescapeHtmlEntities(r.excerpt),r.siteName=this._unescapeHtmlEntities(r.siteName),r.publishedTime=this._unescapeHtmlEntities(r.publishedTime),r},_isSingleImage(n){for(;n;){if(n.tagName==="IMG")return!0;if(n.children.length!==1||n.textContent.trim()!=="")return!1;n=n.children[0]}return!1},_unwrapNoscriptImages(n){var r=Array.from(n.getElementsByTagName("img"));this._forEachNode(r,function(i){for(var s=0;s<i.attributes.length;s++){var a=i.attributes[s];switch(a.name){case"src":case"srcset":case"data-src":case"data-srcset":return}if(/\.(jpg|jpeg|png|webp)/i.test(a.value))return}i.remove()});var o=Array.from(n.getElementsByTagName("noscript"));this._forEachNode(o,function(i){if(this._isSingleImage(i)){var s=n.createElement("div");s.innerHTML=i.innerHTML;var a=i.previousElementSibling;if(a&&this._isSingleImage(a)){var l=a;l.tagName!=="IMG"&&(l=a.getElementsByTagName("img")[0]);for(var c=s.getElementsByTagName("img")[0],h=0;h<l.attributes.length;h++){var u=l.attributes[h];if(u.value!==""&&(u.name==="src"||u.name==="srcset"||/\.(jpg|jpeg|png|webp)/i.test(u.value))){if(c.getAttribute(u.name)===u.value)continue;var d=u.name;c.hasAttribute(d)&&(d="data-old-"+d),c.setAttribute(d,u.value)}}i.parentNode.replaceChild(s.firstElementChild,a)}}})},_removeScripts(n){this._removeNodes(this._getAllNodesWithTag(n,["script","noscript"]))},_hasSingleTagInsideElement(n,r){return n.children.length!=1||n.children[0].tagName!==r?!1:!this._someNode(n.childNodes,function(o){return o.nodeType===this.TEXT_NODE&&this.REGEXPS.hasContent.test(o.textContent)})},_isElementWithoutContent(n){return n.nodeType===this.ELEMENT_NODE&&!n.textContent.trim().length&&(!n.children.length||n.children.length==n.getElementsByTagName("br").length+n.getElementsByTagName("hr").length)},_hasChildBlockElement(n){return this._someNode(n.childNodes,function(r){return this.DIV_TO_P_ELEMS.has(r.tagName)||this._hasChildBlockElement(r)})},_isPhrasingContent(n){return n.nodeType===this.TEXT_NODE||this.PHRASING_ELEMS.includes(n.tagName)||(n.tagName==="A"||n.tagName==="DEL"||n.tagName==="INS")&&this._everyNode(n.childNodes,this._isPhrasingContent)},_isWhitespace(n){return n.nodeType===this.TEXT_NODE&&n.textContent.trim().length===0||n.nodeType===this.ELEMENT_NODE&&n.tagName==="BR"},_getInnerText(n,r){r=typeof r>"u"?!0:r;var o=n.textContent.trim();return r?o.replace(this.REGEXPS.normalize," "):o},_getCharCount(n,r){return r=r||",",this._getInnerText(n).split(r).length-1},_cleanStyles(n){if(!(!n||n.tagName.toLowerCase()==="svg")){for(var r=0;r<this.PRESENTATIONAL_ATTRIBUTES.length;r++)n.removeAttribute(this.PRESENTATIONAL_ATTRIBUTES[r]);this.DEPRECATED_SIZE_ATTRIBUTE_ELEMS.includes(n.tagName)&&(n.removeAttribute("width"),n.removeAttribute("height"));for(var o=n.firstElementChild;o!==null;)this._cleanStyles(o),o=o.nextElementSibling}},_getLinkDensity(n){var r=this._getInnerText(n).length;if(r===0)return 0;var o=0;return this._forEachNode(n.getElementsByTagName("a"),function(i){var s=i.getAttribute("href"),a=s&&this.REGEXPS.hashUrl.test(s)?.3:1;o+=this._getInnerText(i).length*a}),o/r},_getClassWeight(n){if(!this._flagIsActive(this.FLAG_WEIGHT_CLASSES))return 0;var r=0;return typeof n.className=="string"&&n.className!==""&&(this.REGEXPS.negative.test(n.className)&&(r-=25),this.REGEXPS.positive.test(n.className)&&(r+=25)),typeof n.id=="string"&&n.id!==""&&(this.REGEXPS.negative.test(n.id)&&(r-=25),this.REGEXPS.positive.test(n.id)&&(r+=25)),r},_clean(n,r){var o=["object","embed","iframe"].includes(r);this._removeNodes(this._getAllNodesWithTag(n,[r]),function(i){if(o){for(var s=0;s<i.attributes.length;s++)if(this._allowedVideoRegex.test(i.attributes[s].value))return!1;if(i.tagName==="object"&&this._allowedVideoRegex.test(i.innerHTML))return!1}return!0})},_hasAncestorTag(n,r,o,i){o=o||3,r=r.toUpperCase();for(var s=0;n.parentNode;){if(o>0&&s>o)return!1;if(n.parentNode.tagName===r&&(!i||i(n.parentNode)))return!0;n=n.parentNode,s++}return!1},_getRowAndColumnCount(n){for(var r=0,o=0,i=n.getElementsByTagName("tr"),s=0;s<i.length;s++){var a=i[s].getAttribute("rowspan")||0;a&&(a=parseInt(a,10)),r+=a||1;for(var l=0,c=i[s].getElementsByTagName("td"),h=0;h<c.length;h++){var u=c[h].getAttribute("colspan")||0;u&&(u=parseInt(u,10)),l+=u||1}o=Math.max(o,l)}return{rows:r,columns:o}},_markDataTables(n){for(var r=n.getElementsByTagName("table"),o=0;o<r.length;o++){var i=r[o],s=i.getAttribute("role");if(s=="presentation"){i._readabilityDataTable=!1;continue}var a=i.getAttribute("datatable");if(a=="0"){i._readabilityDataTable=!1;continue}var l=i.getAttribute("summary");if(l){i._readabilityDataTable=!0;continue}var c=i.getElementsByTagName("caption")[0];if(c&&c.childNodes.length){i._readabilityDataTable=!0;continue}var h=["col","colgroup","tfoot","thead","th"],u=function(f){return!!i.getElementsByTagName(f)[0]};if(h.some(u)){this.log("Data table because found data-y descendant"),i._readabilityDataTable=!0;continue}if(i.getElementsByTagName("table")[0]){i._readabilityDataTable=!1;continue}var d=this._getRowAndColumnCount(i);if(d.columns==1||d.rows==1){i._readabilityDataTable=!1;continue}if(d.rows>=10||d.columns>4){i._readabilityDataTable=!0;continue}i._readabilityDataTable=d.rows*d.columns>10}},_fixLazyImages(n){this._forEachNode(this._getAllNodesWithTag(n,["img","picture","figure"]),function(r){if(r.src&&this.REGEXPS.b64DataUrl.test(r.src)){var o=this.REGEXPS.b64DataUrl.exec(r.src);if(o[1]==="image/svg+xml")return;for(var i=!1,s=0;s<r.attributes.length;s++){var a=r.attributes[s];if(a.name!=="src"&&/\.(jpg|jpeg|png|webp)/i.test(a.value)){i=!0;break}}if(i){var l=o[0].length,c=r.src.length-l;c<133&&r.removeAttribute("src")}}if(!((r.src||r.srcset&&r.srcset!="null")&&!r.className.toLowerCase().includes("lazy"))){for(var h=0;h<r.attributes.length;h++)if(a=r.attributes[h],!(a.name==="src"||a.name==="srcset"||a.name==="alt")){var u=null;if(/\.(jpg|jpeg|png|webp)\s+\d/.test(a.value)?u="srcset":/^\s*\S+\.(jpg|jpeg|png|webp)\S*\s*$/.test(a.value)&&(u="src"),u){if(r.tagName==="IMG"||r.tagName==="PICTURE")r.setAttribute(u,a.value);else if(r.tagName==="FIGURE"&&!this._getAllNodesWithTag(r,["img","picture"]).length){var d=this._doc.createElement("img");d.setAttribute(u,a.value),r.appendChild(d)}}}}})},_getTextDensity(n,r){var o=this._getInnerText(n,!0).length;if(o===0)return 0;var i=0,s=this._getAllNodesWithTag(n,r);return this._forEachNode(s,a=>i+=this._getInnerText(a,!0).length),i/o},_cleanConditionally(n,r){this._flagIsActive(this.FLAG_CLEAN_CONDITIONALLY)&&this._removeNodes(this._getAllNodesWithTag(n,[r]),function(o){var i=function(M){return M._readabilityDataTable},s=r==="ul"||r==="ol";if(!s){var a=0,l=this._getAllNodesWithTag(o,["ul","ol"]);this._forEachNode(l,M=>a+=this._getInnerText(M).length),s=a/this._getInnerText(o).length>.9}if(r==="table"&&i(o)||this._hasAncestorTag(o,"table",-1,i)||this._hasAncestorTag(o,"code")||[...o.getElementsByTagName("table")].some(M=>M._readabilityDataTable))return!1;var c=this._getClassWeight(o);this.log("Cleaning Conditionally",o);var h=0;if(c+h<0)return!0;if(this._getCharCount(o,",")<10){for(var u=o.getElementsByTagName("p").length,d=o.getElementsByTagName("img").length,f=o.getElementsByTagName("li").length-100,m=o.getElementsByTagName("input").length,g=this._getTextDensity(o,["h1","h2","h3","h4","h5","h6"]),v=0,w=this._getAllNodesWithTag(o,["object","embed","iframe"]),S=0;S<w.length;S++){for(var p=0;p<w[S].attributes.length;p++)if(this._allowedVideoRegex.test(w[S].attributes[p].value))return!1;if(w[S].tagName==="object"&&this._allowedVideoRegex.test(w[S].innerHTML))return!1;v++}var b=this._getInnerText(o);if(this.REGEXPS.adWords.test(b)||this.REGEXPS.loadingWords.test(b))return!0;var C=b.length,E=this._getLinkDensity(o),k=["SPAN","LI","TD"].concat(Array.from(this.DIV_TO_P_ELEMS)),P=this._getTextDensity(o,k),L=this._hasAncestorTag(o,"figure"),O=(()=>{const B=[];return!L&&d>1&&u/d<.5&&B.push(`Bad p to img ratio (img=${d}, p=${u})`),!s&&f>u&&B.push(`Too many li's outside of a list. (li=${f} > p=${u})`),m>Math.floor(u/3)&&B.push(`Too many inputs per p. (input=${m}, p=${u})`),!s&&!L&&g<.9&&C<25&&(d===0||d>2)&&E>0&&B.push(`Suspiciously short. (headingDensity=${g}, img=${d}, linkDensity=${E})`),!s&&c<25&&E>.2+this._linkDensityModifier&&B.push(`Low weight and a little linky. (linkDensity=${E})`),c>=25&&E>.5+this._linkDensityModifier&&B.push(`High weight and mostly links. (linkDensity=${E})`),(v===1&&C<75||v>1)&&B.push(`Suspicious embed. (embedCount=${v}, contentLength=${C})`),d===0&&P===0&&B.push(`No useful content. (img=${d}, textDensity=${P})`),B.length?(this.log("Checks failed",B),!0):!1})();if(s&&O){for(var z=0;z<o.children.length;z++)if(o.children[z].children.length>1)return O;let B=o.getElementsByTagName("li").length;if(d==B)return!1}return O}return!1})},_cleanMatchedNodes(n,r){for(var o=this._getNextNode(n,!0),i=this._getNextNode(n);i&&i!=o;)r.call(this,i,i.className+" "+i.id)?i=this._removeAndGetNext(i):i=this._getNextNode(i)},_cleanHeaders(n){let r=this._getAllNodesWithTag(n,["h1","h2"]);this._removeNodes(r,function(o){let i=this._getClassWeight(o)<0;return i&&this.log("Removing header with low class weight:",o),i})},_headerDuplicatesTitle(n){if(n.tagName!="H1"&&n.tagName!="H2")return!1;var r=this._getInnerText(n,!1);return this.log("Evaluating similarity of header:",r,this._articleTitle),this._textSimilarity(this._articleTitle,r)>.75},_flagIsActive(n){return(this._flags&n)>0},_removeFlag(n){this._flags=this._flags&~n},_isProbablyVisible(n){return(!n.style||n.style.display!="none")&&(!n.style||n.style.visibility!="hidden")&&!n.hasAttribute("hidden")&&(!n.hasAttribute("aria-hidden")||n.getAttribute("aria-hidden")!="true"||n.className&&n.className.includes&&n.className.includes("fallback-image"))},parse(){if(this._maxElemsToParse>0){var n=this._doc.getElementsByTagName("*").length;if(n>this._maxElemsToParse)throw new Error("Aborting parsing document; "+n+" elements found")}this._unwrapNoscriptImages(this._doc);var r=this._disableJSONLD?{}:this._getJSONLD(this._doc);this._removeScripts(this._doc),this._prepDocument();var o=this._getArticleMetadata(r);this._metadata=o,this._articleTitle=o.title;var i=this._grabArticle();if(!i)return null;if(this.log("Grabbed: "+i.innerHTML),this._postProcessContent(i),!o.excerpt){var s=i.getElementsByTagName("p");s.length&&(o.excerpt=s[0].textContent.trim())}var a=i.textContent;return{title:this._articleTitle,byline:o.byline||this._articleByline,dir:this._articleDir,lang:this._articleLang,content:this._serializer(i),textContent:a,length:a.length,excerpt:o.excerpt,siteName:o.siteName||this._articleSiteName,publishedTime:o.publishedTime}}},e.exports=t})(jn)),jn.exports}var Fn={exports:{}},no;function Ga(){return no||(no=1,(function(e){var t={unlikelyCandidates:/-ad-|ai2html|banner|breadcrumbs|combx|comment|community|cover-wrap|disqus|extra|footer|gdpr|header|legends|menu|related|remark|replies|rss|shoutbox|sidebar|skyscraper|social|sponsor|supplemental|ad-break|agegate|pagination|pager|popup|yom-remote/i,okMaybeItsACandidate:/and|article|body|column|content|main|shadow/i};function n(o){return(!o.style||o.style.display!="none")&&!o.hasAttribute("hidden")&&(!o.hasAttribute("aria-hidden")||o.getAttribute("aria-hidden")!="true"||o.className&&o.className.includes&&o.className.includes("fallback-image"))}function r(o,i={}){typeof i=="function"&&(i={visibilityChecker:i});var s={minScore:20,minContentLength:140,visibilityChecker:n};i=Object.assign(s,i);var a=o.querySelectorAll("p, pre, article"),l=o.querySelectorAll("div > br");if(l.length){var c=new Set(a);[].forEach.call(l,function(u){c.add(u.parentNode)}),a=Array.from(c)}var h=0;return[].some.call(a,function(u){if(!i.visibilityChecker(u))return!1;var d=u.className+" "+u.id;if(t.unlikelyCandidates.test(d)&&!t.okMaybeItsACandidate.test(d)||u.matches("li p"))return!1;var f=u.textContent.trim().length;return f<i.minContentLength?!1:(h+=Math.sqrt(f-i.minContentLength),h>i.minScore)})}e.exports=r})(Fn)),Fn.exports}var Vn,ro;function Xa(){if(ro)return Vn;ro=1;var e=Va(),t=Ga();return Vn={Readability:e,isProbablyReaderable:t},Vn}var Wa=Xa();const Ya=(e,t)=>{try{const r=new DOMParser().parseFromString(e,"text/html");t&&Object.defineProperty(r,"documentURI",{value:t});const i=new Wa.Readability(r).parse();if(!i)throw new Error("Readability failed to parse the content");return(i.title?`Title: ${i.title}

`:"")+(i.textContent||i.content||"")}catch(n){throw console.error("Readability extraction failed:",n),new Error(`Failed to extract article content: ${n instanceof Error?n.message:String(n)}`)}};async function qa(e,t){try{const{html:n,url:r}=await Fa(e,t);return Ya(n,r)}catch(n){return console.error("Failed to get page text from tab:",n),`Error: ${n instanceof Error?n.message:String(n)}`}}const Ua={...ja,executor:async(e,t,n,r)=>await qa(n,r)},Za={...{type:"getSelection",label:"Get Selected Text",description:"Get the text currently selected on the page",color:"bg-blue-600/70",icon:"MousePointerClick",category:"input"},executor:async(e,t,n,r)=>{try{if(r?.selectedText){const s=r.selectedText;if(!s||s.trim()==="")throw new Error("No text is currently selected on the page");return s}if(!chrome.scripting)throw new Error("Cannot access selected text in this context");const o=await chrome.scripting.executeScript({target:{tabId:n},func:()=>{const s=window.getSelection();return s?s.toString():""}});if(!o||!o[0]?.result)throw new Error("Failed to get selection from page");const i=o[0].result;if(!i||i.trim()==="")throw new Error("No text is currently selected on the page");return i}catch(o){throw console.error("Failed to get selected text:",o),o instanceof Error?o:new Error("Failed to get selected text from page")}}},Ka={type:"summarize",label:"Summarize",description:"Summarize text using the built-in AI Summarizer API",color:"bg-purple-600/70",icon:"Sparkles",category:"processing",defaultConfig:{type:"tldr",length:"medium"}},Qa=async(e,t={})=>"Summarizer"in self?await(await Summarizer.create({type:t.type||"tldr",length:t.length||"medium",format:"plain-text"})).summarize(e):"Summarizer API not supported in this browser.",Ja={...Ka,executor:async(e,t)=>{if(!t)throw new Error("No input to summarize");const{type:n="tldr",length:r="medium"}=e.data;return await Qa(t,{type:n,length:r})},getComponent:async()=>(await Promise.resolve().then(()=>mm)).SummarizeNode},el={type:"translate",label:"Translate",description:"Translate text using the built-in AI Translator API",color:"bg-blue-600/70",icon:"Languages",category:"processing",defaultConfig:{sourceLanguage:"en",targetLanguage:"fr"}};async function tl(e,t="en",n="fr"){if(!("Translator"in self))throw new Error("Translator API not supported");return await(await Translator.create({sourceLanguage:t,targetLanguage:n})).translate(e)}const nl={...el,executor:async(e,t)=>{if(!t)throw new Error("No input to translate");const{sourceLanguage:n="en",targetLanguage:r="fr"}=e.data;return await tl(t,n,r)},getComponent:async()=>(await Promise.resolve().then(()=>wm)).TranslateNode},rl={...{type:"prompt",label:"Prompt",description:"Send a custom prompt to Gemini Nano with the previous node output as context",color:"bg-purple-600/70",icon:"MessageSquare",category:"processing",defaultConfig:{prompt:""}},executor:async(e,t)=>{if(!window.LanguageModel)throw new Error("Prompt API not available. Enable it in chrome://flags/#prompt-api-for-gemini-nano");const n=e.data.prompt||"";if(await window.LanguageModel.availability()==="unavailable")throw new Error("Gemini Nano model is not available on this device");try{const o=await window.LanguageModel.create(),i=t?`Input text: ${t}

Instruction: ${n}`:n,s=await o.prompt(i);return o.destroy(),s}catch(o){throw o instanceof Error?o.message.includes("download")?new Error("Gemini Nano model is downloading. Please try again in a few moments."):o:new Error("Failed to process prompt with Gemini Nano")}},getComponent:async()=>(await Promise.resolve().then(()=>_m)).PromptNodeComponent},ol={...{type:"textOutput",label:"Output",description:"Display output in the flosheet builder (visual mode only)",color:"bg-emerald-600/70",icon:"MonitorPlay",category:"output"},getComponent:async()=>(await Promise.resolve().then(()=>Nm)).TextOutputNode},il={type:"selectionPopover",label:"Selection Popover",description:"Display result in a popover near the selected text",color:"bg-emerald-600/70",icon:"Box",category:"output"};function oo(e,t){document.querySelectorAll(".workflow-popover").forEach(s=>s.remove());const n=document.createElement("div");n.className="workflow-popover",n.style.cssText=`
          position: absolute;
          background: white;
          color: black;
          padding: 16px;
          border-radius: 8px;
          box-shadow: 0 4px 12px rgba(0,0,0,0.15);
          z-index: 999999;
          max-width: 400px;
          font-family: system-ui, -apple-system, sans-serif;
          font-size: 14px;
          line-height: 1.5;
          border: 1px solid #e5e7eb;
        `,t?(n.style.top=`${t.top+10}px`,n.style.left=`${Math.max(10,Math.min(window.innerWidth-410,t.left))}px`):(n.style.position="fixed",n.style.top="50%",n.style.left="50%",n.style.transform="translate(-50%, -50%)");const r=document.createElement("div");r.textContent=e,r.style.whiteSpace="pre-wrap",n.appendChild(r),document.body.appendChild(n);const o=()=>{const s=window.getSelection();(!s||s.toString()==="")&&(n.remove(),document.removeEventListener("selectionchange",o))};document.addEventListener("selectionchange",o);const i=s=>{n.contains(s.target)||(n.remove(),document.removeEventListener("click",i),document.removeEventListener("selectionchange",o))};setTimeout(()=>{document.addEventListener("click",i)},100)}const sl={...il,executor:async(e,t,n,r)=>{if(!t)throw new Error("No input to display in popover");try{if(r){const s=window.getSelection();let a=null;if(s&&s.rangeCount>0){const c=s.getRangeAt(0).getBoundingClientRect();a={top:c.bottom+window.scrollY,left:c.left+window.scrollX,width:c.width}}return oo(t,a),"Popover displayed"}if(!chrome.scripting)throw new Error("Cannot display popover in this context");const i=(await chrome.scripting.executeScript({target:{tabId:n},func:()=>{const s=window.getSelection();if(!s||s.rangeCount===0)return null;const l=s.getRangeAt(0).getBoundingClientRect();return{top:l.bottom+window.scrollY,left:l.left+window.scrollX,width:l.width}}}))?.[0]?.result;return await chrome.scripting.executeScript({target:{tabId:n},func:oo,args:[t,i]}),"Popover displayed"}catch(o){throw console.error("Failed to display popover:",o),new Error("Failed to display popover on page")}}};var Gn={exports:{}},K={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var io;function al(){if(io)return K;io=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),u=Symbol.for("react.activity"),d=Symbol.iterator;function f(y){return y===null||typeof y!="object"?null:(y=d&&y[d]||y["@@iterator"],typeof y=="function"?y:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,v={};function w(y,N,j){this.props=y,this.context=N,this.refs=v,this.updater=j||m}w.prototype.isReactComponent={},w.prototype.setState=function(y,N){if(typeof y!="object"&&typeof y!="function"&&y!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,y,N,"setState")},w.prototype.forceUpdate=function(y){this.updater.enqueueForceUpdate(this,y,"forceUpdate")};function S(){}S.prototype=w.prototype;function p(y,N,j){this.props=y,this.context=N,this.refs=v,this.updater=j||m}var b=p.prototype=new S;b.constructor=p,g(b,w.prototype),b.isPureReactComponent=!0;var C=Array.isArray;function E(){}var k={H:null,A:null,T:null,S:null},P=Object.prototype.hasOwnProperty;function L(y,N,j){var H=j.ref;return{$$typeof:e,type:y,key:N,ref:H!==void 0?H:null,props:j}}function O(y,N){return L(y.type,N,y.props)}function z(y){return typeof y=="object"&&y!==null&&y.$$typeof===e}function M(y){var N={"=":"=0",":":"=2"};return"$"+y.replace(/[=:]/g,function(j){return N[j]})}var B=/\/+/g;function _(y,N){return typeof y=="object"&&y!==null&&y.key!=null?M(""+y.key):N.toString(36)}function A(y){switch(y.status){case"fulfilled":return y.value;case"rejected":throw y.reason;default:switch(typeof y.status=="string"?y.then(E,E):(y.status="pending",y.then(function(N){y.status==="pending"&&(y.status="fulfilled",y.value=N)},function(N){y.status==="pending"&&(y.status="rejected",y.reason=N)})),y.status){case"fulfilled":return y.value;case"rejected":throw y.reason}}throw y}function T(y,N,j,H,W){var X=typeof y;(X==="undefined"||X==="boolean")&&(y=null);var G=!1;if(y===null)G=!0;else switch(X){case"bigint":case"string":case"number":G=!0;break;case"object":switch(y.$$typeof){case e:case t:G=!0;break;case h:return G=y._init,T(G(y._payload),N,j,H,W)}}if(G)return W=W(y),G=H===""?"."+_(y,0):H,C(W)?(j="",G!=null&&(j=G.replace(B,"$&/")+"/"),T(W,N,j,"",function(J){return J})):W!=null&&(z(W)&&(W=O(W,j+(W.key==null||y&&y.key===W.key?"":(""+W.key).replace(B,"$&/")+"/")+G)),N.push(W)),1;G=0;var V=H===""?".":H+":";if(C(y))for(var Y=0;Y<y.length;Y++)H=y[Y],X=V+_(H,Y),G+=T(H,N,j,X,W);else if(Y=f(y),typeof Y=="function")for(y=Y.call(y),Y=0;!(H=y.next()).done;)H=H.value,X=V+_(H,Y++),G+=T(H,N,j,X,W);else if(X==="object"){if(typeof y.then=="function")return T(A(y),N,j,H,W);throw N=String(y),Error("Objects are not valid as a React child (found: "+(N==="[object Object]"?"object with keys {"+Object.keys(y).join(", ")+"}":N)+"). If you meant to render a collection of children, use an array instead.")}return G}function $(y,N,j){if(y==null)return y;var H=[],W=0;return T(y,H,"","",function(X){return N.call(j,X,W++)}),H}function R(y){if(y._status===-1){var N=y._result;N=N(),N.then(function(j){(y._status===0||y._status===-1)&&(y._status=1,y._result=j)},function(j){(y._status===0||y._status===-1)&&(y._status=2,y._result=j)}),y._status===-1&&(y._status=0,y._result=N)}if(y._status===1)return y._result.default;throw y._result}var D=typeof reportError=="function"?reportError:function(y){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var N=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof y=="object"&&y!==null&&typeof y.message=="string"?String(y.message):String(y),error:y});if(!window.dispatchEvent(N))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",y);return}console.error(y)},F={map:$,forEach:function(y,N,j){$(y,function(){N.apply(this,arguments)},j)},count:function(y){var N=0;return $(y,function(){N++}),N},toArray:function(y){return $(y,function(N){return N})||[]},only:function(y){if(!z(y))throw Error("React.Children.only expected to receive a single React element child.");return y}};return K.Activity=u,K.Children=F,K.Component=w,K.Fragment=n,K.Profiler=o,K.PureComponent=p,K.StrictMode=r,K.Suspense=l,K.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,K.__COMPILER_RUNTIME={__proto__:null,c:function(y){return k.H.useMemoCache(y)}},K.cache=function(y){return function(){return y.apply(null,arguments)}},K.cacheSignal=function(){return null},K.cloneElement=function(y,N,j){if(y==null)throw Error("The argument must be a React element, but you passed "+y+".");var H=g({},y.props),W=y.key;if(N!=null)for(X in N.key!==void 0&&(W=""+N.key),N)!P.call(N,X)||X==="key"||X==="__self"||X==="__source"||X==="ref"&&N.ref===void 0||(H[X]=N[X]);var X=arguments.length-2;if(X===1)H.children=j;else if(1<X){for(var G=Array(X),V=0;V<X;V++)G[V]=arguments[V+2];H.children=G}return L(y.type,W,H)},K.createContext=function(y){return y={$$typeof:s,_currentValue:y,_currentValue2:y,_threadCount:0,Provider:null,Consumer:null},y.Provider=y,y.Consumer={$$typeof:i,_context:y},y},K.createElement=function(y,N,j){var H,W={},X=null;if(N!=null)for(H in N.key!==void 0&&(X=""+N.key),N)P.call(N,H)&&H!=="key"&&H!=="__self"&&H!=="__source"&&(W[H]=N[H]);var G=arguments.length-2;if(G===1)W.children=j;else if(1<G){for(var V=Array(G),Y=0;Y<G;Y++)V[Y]=arguments[Y+2];W.children=V}if(y&&y.defaultProps)for(H in G=y.defaultProps,G)W[H]===void 0&&(W[H]=G[H]);return L(y,X,W)},K.createRef=function(){return{current:null}},K.forwardRef=function(y){return{$$typeof:a,render:y}},K.isValidElement=z,K.lazy=function(y){return{$$typeof:h,_payload:{_status:-1,_result:y},_init:R}},K.memo=function(y,N){return{$$typeof:c,type:y,compare:N===void 0?null:N}},K.startTransition=function(y){var N=k.T,j={};k.T=j;try{var H=y(),W=k.S;W!==null&&W(j,H),typeof H=="object"&&H!==null&&typeof H.then=="function"&&H.then(E,D)}catch(X){D(X)}finally{N!==null&&j.types!==null&&(N.types=j.types),k.T=N}},K.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},K.use=function(y){return k.H.use(y)},K.useActionState=function(y,N,j){return k.H.useActionState(y,N,j)},K.useCallback=function(y,N){return k.H.useCallback(y,N)},K.useContext=function(y){return k.H.useContext(y)},K.useDebugValue=function(){},K.useDeferredValue=function(y,N){return k.H.useDeferredValue(y,N)},K.useEffect=function(y,N){return k.H.useEffect(y,N)},K.useEffectEvent=function(y){return k.H.useEffectEvent(y)},K.useId=function(){return k.H.useId()},K.useImperativeHandle=function(y,N,j){return k.H.useImperativeHandle(y,N,j)},K.useInsertionEffect=function(y,N){return k.H.useInsertionEffect(y,N)},K.useLayoutEffect=function(y,N){return k.H.useLayoutEffect(y,N)},K.useMemo=function(y,N){return k.H.useMemo(y,N)},K.useOptimistic=function(y,N){return k.H.useOptimistic(y,N)},K.useReducer=function(y,N,j){return k.H.useReducer(y,N,j)},K.useRef=function(y){return k.H.useRef(y)},K.useState=function(y){return k.H.useState(y)},K.useSyncExternalStore=function(y,N,j){return k.H.useSyncExternalStore(y,N,j)},K.useTransition=function(){return k.H.useTransition()},K.version="19.2.0",K}var so;function Vt(){return so||(so=1,Gn.exports=al()),Gn.exports}var I=Vt();const ll=eo(I);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cl=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ul=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),ao=e=>{const t=ul(e);return t.charAt(0).toUpperCase()+t.slice(1)},lo=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim(),dl=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var hl={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fl=I.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:o="",children:i,iconNode:s,...a},l)=>I.createElement("svg",{ref:l,...hl,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:lo("lucide",o),...!i&&!dl(a)&&{"aria-hidden":"true"},...a},[...s.map(([c,h])=>I.createElement(c,h)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=(e,t)=>{const n=I.forwardRef(({className:r,...o},i)=>I.createElement(fl,{ref:i,iconNode:t,className:lo(`lucide-${cl(ao(e))}`,`lucide-${e}`,r),...o}));return n.displayName=ao(e),n};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pl=Be("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=Be("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gl=Be("languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xn=Be("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ml=Be("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const co=Be("monitor-play",[["path",{d:"M15.033 9.44a.647.647 0 0 1 0 1.12l-4.065 2.352a.645.645 0 0 1-.968-.56V7.648a.645.645 0 0 1 .967-.56z",key:"vbtd3f"}],["path",{d:"M12 17v4",key:"1riwvh"}],["path",{d:"M8 21h8",key:"1ev6f3"}],["rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",key:"x3v2xh"}]]);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yl=Be("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=Be("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),xl={type:"pageModal",label:"Page Modal",description:"Display output in a modal overlay on the page",category:"output",icon:co,color:"#66BB6A",defaultConfig:{}};function Wn(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Ve=Wn();function uo(e){Ve=e}var dt={exec:()=>null};function ne(e,t=""){let n=typeof e=="string"?e:e.source,r={replace:(o,i)=>{let s=typeof i=="string"?i:i.source;return s=s.replace(he.caret,"$1"),n=n.replace(o,s),r},getRegex:()=>new RegExp(n,t)};return r}var he={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},wl=/^(?:[ \t]*(?:\n|$))+/,bl=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,vl=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,ht=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,_l=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Yn=/(?:[*+-]|\d{1,9}[.)])/,ho=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,fo=ne(ho).replace(/bull/g,Yn).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),El=ne(ho).replace(/bull/g,Yn).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),qn=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,kl=/^[^\n]+/,Un=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Nl=ne(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Un).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Sl=ne(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Yn).getRegex(),Wt="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Zn=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Cl=ne("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Zn).replace("tag",Wt).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),po=ne(qn).replace("hr",ht).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Wt).getRegex(),Tl=ne(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",po).getRegex(),Kn={blockquote:Tl,code:bl,def:Nl,fences:vl,heading:_l,hr:ht,html:Cl,lheading:fo,list:Sl,newline:wl,paragraph:po,table:dt,text:kl},go=ne("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",ht).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Wt).getRegex(),Al={...Kn,lheading:El,table:go,paragraph:ne(qn).replace("hr",ht).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",go).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Wt).getRegex()},Rl={...Kn,html:ne(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Zn).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:dt,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:ne(qn).replace("hr",ht).replace("heading",` *#{1,6} *[^
]`).replace("lheading",fo).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Ml=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,$l=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,mo=/^( {2,}|\\)\n(?!\s*$)/,Il=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Yt=/[\p{P}\p{S}]/u,Qn=/[\s\p{P}\p{S}]/u,yo=/[^\s\p{P}\p{S}]/u,Pl=ne(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Qn).getRegex(),xo=/(?!~)[\p{P}\p{S}]/u,Dl=/(?!~)[\s\p{P}\p{S}]/u,Ll=/(?:[^\s\p{P}\p{S}]|~)/u,zl=ne(/link|code|html/,"g").replace("link",new RegExp("\\[(?:[^\\[\\]`]|(?<!`)(?<a>`+)[^`]+\\k<a>(?!`))*?\\]\\((?:\\\\[\\s\\S]|[^\\\\\\(\\)]|\\((?:\\\\[\\s\\S]|[^\\\\\\(\\)])*\\))*\\)")).replace("code",new RegExp("(?<!`)(?<b>`+)[^`]+\\k<b>(?!`)")).replace("html",/<(?! )[^<>]*?>/).getRegex(),wo=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Bl=ne(wo,"u").replace(/punct/g,Yt).getRegex(),Hl=ne(wo,"u").replace(/punct/g,xo).getRegex(),bo="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Ol=ne(bo,"gu").replace(/notPunctSpace/g,yo).replace(/punctSpace/g,Qn).replace(/punct/g,Yt).getRegex(),jl=ne(bo,"gu").replace(/notPunctSpace/g,Ll).replace(/punctSpace/g,Dl).replace(/punct/g,xo).getRegex(),Fl=ne("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,yo).replace(/punctSpace/g,Qn).replace(/punct/g,Yt).getRegex(),Vl=ne(/\\(punct)/,"gu").replace(/punct/g,Yt).getRegex(),Gl=ne(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Xl=ne(Zn).replace("(?:-->|$)","-->").getRegex(),Wl=ne("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Xl).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),qt=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,Yl=ne(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",qt).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),vo=ne(/^!?\[(label)\]\[(ref)\]/).replace("label",qt).replace("ref",Un).getRegex(),_o=ne(/^!?\[(ref)\](?:\[\])?/).replace("ref",Un).getRegex(),ql=ne("reflink|nolink(?!\\()","g").replace("reflink",vo).replace("nolink",_o).getRegex(),Eo=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Jn={_backpedal:dt,anyPunctuation:Vl,autolink:Gl,blockSkip:zl,br:mo,code:$l,del:dt,emStrongLDelim:Bl,emStrongRDelimAst:Ol,emStrongRDelimUnd:Fl,escape:Ml,link:Yl,nolink:_o,punctuation:Pl,reflink:vo,reflinkSearch:ql,tag:Wl,text:Il,url:dt},Ul={...Jn,link:ne(/^!?\[(label)\]\((.*?)\)/).replace("label",qt).getRegex(),reflink:ne(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",qt).getRegex()},er={...Jn,emStrongRDelimAst:jl,emStrongLDelim:Hl,url:ne(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Eo).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:ne(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Eo).getRegex()},Zl={...er,br:ne(mo).replace("{2,}","*").getRegex(),text:ne(er.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Ut={normal:Kn,gfm:Al,pedantic:Rl},ft={normal:Jn,gfm:er,breaks:Zl,pedantic:Ul},Kl={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ko=e=>Kl[e];function Ne(e,t){if(t){if(he.escapeTest.test(e))return e.replace(he.escapeReplace,ko)}else if(he.escapeTestNoEncode.test(e))return e.replace(he.escapeReplaceNoEncode,ko);return e}function No(e){try{e=encodeURI(e).replace(he.percentDecode,"%")}catch{return null}return e}function So(e,t){let n=e.replace(he.findPipe,(i,s,a)=>{let l=!1,c=s;for(;--c>=0&&a[c]==="\\";)l=!l;return l?"|":" |"}),r=n.split(he.splitPipe),o=0;if(r[0].trim()||r.shift(),r.length>0&&!r.at(-1)?.trim()&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;o<r.length;o++)r[o]=r[o].trim().replace(he.slashPipe,"|");return r}function pt(e,t,n){let r=e.length;if(r===0)return"";let o=0;for(;o<r&&e.charAt(r-o-1)===t;)o++;return e.slice(0,r-o)}function Ql(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let r=0;r<e.length;r++)if(e[r]==="\\")r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return n>0?-2:-1}function Co(e,t,n,r,o){let i=t.href,s=t.title||null,a=e[1].replace(o.other.outputLinkReplace,"$1");r.state.inLink=!0;let l={type:e[0].charAt(0)==="!"?"image":"link",raw:n,href:i,title:s,text:a,tokens:r.inlineTokens(a)};return r.state.inLink=!1,l}function Jl(e,t,n){let r=e.match(n.other.indentCodeCompensation);if(r===null)return t;let o=r[1];return t.split(`
`).map(i=>{let s=i.match(n.other.beginningSpace);if(s===null)return i;let[a]=s;return a.length>=o.length?i.slice(o.length):i}).join(`
`)}var Zt=class{options;rules;lexer;constructor(e){this.options=e||Ve}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:pt(n,`
`)}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let n=t[0],r=Jl(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){let r=pt(n,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:pt(t[0],`
`)}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let n=pt(t[0],`
`).split(`
`),r="",o="",i=[];for(;n.length>0;){let s=!1,a=[],l;for(l=0;l<n.length;l++)if(this.rules.other.blockquoteStart.test(n[l]))a.push(n[l]),s=!0;else if(!s)a.push(n[l]);else break;n=n.slice(l);let c=a.join(`
`),h=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${c}`:c,o=o?`${o}
${h}`:h;let u=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(h,i,!0),this.lexer.state.top=u,n.length===0)break;let d=i.at(-1);if(d?.type==="code")break;if(d?.type==="blockquote"){let f=d,m=f.raw+`
`+n.join(`
`),g=this.blockquote(m);i[i.length-1]=g,r=r.substring(0,r.length-f.raw.length)+g.raw,o=o.substring(0,o.length-f.text.length)+g.text;break}else if(d?.type==="list"){let f=d,m=f.raw+`
`+n.join(`
`),g=this.list(m);i[i.length-1]=g,r=r.substring(0,r.length-d.raw.length)+g.raw,o=o.substring(0,o.length-f.raw.length)+g.raw,n=m.substring(i.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:i,text:o}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim(),r=n.length>1,o={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");let i=this.rules.other.listItemRegex(n),s=!1;for(;e;){let l=!1,c="",h="";if(!(t=i.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let u=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,w=>" ".repeat(3*w.length)),d=e.split(`
`,1)[0],f=!u.trim(),m=0;if(this.options.pedantic?(m=2,h=u.trimStart()):f?m=t[1].length+1:(m=t[2].search(this.rules.other.nonSpaceChar),m=m>4?1:m,h=u.slice(m),m+=t[1].length),f&&this.rules.other.blankLine.test(d)&&(c+=d+`
`,e=e.substring(d.length+1),l=!0),!l){let w=this.rules.other.nextBulletRegex(m),S=this.rules.other.hrRegex(m),p=this.rules.other.fencesBeginRegex(m),b=this.rules.other.headingBeginRegex(m),C=this.rules.other.htmlBeginRegex(m);for(;e;){let E=e.split(`
`,1)[0],k;if(d=E,this.options.pedantic?(d=d.replace(this.rules.other.listReplaceNesting,"  "),k=d):k=d.replace(this.rules.other.tabCharGlobal,"    "),p.test(d)||b.test(d)||C.test(d)||w.test(d)||S.test(d))break;if(k.search(this.rules.other.nonSpaceChar)>=m||!d.trim())h+=`
`+k.slice(m);else{if(f||u.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||p.test(u)||b.test(u)||S.test(u))break;h+=`
`+d}!f&&!d.trim()&&(f=!0),c+=E+`
`,e=e.substring(E.length+1),u=k.slice(m)}}o.loose||(s?o.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(s=!0));let g=null,v;this.options.gfm&&(g=this.rules.other.listIsTask.exec(h),g&&(v=g[0]!=="[ ] ",h=h.replace(this.rules.other.listReplaceTask,""))),o.items.push({type:"list_item",raw:c,task:!!g,checked:v,loose:!1,text:h,tokens:[]}),o.raw+=c}let a=o.items.at(-1);if(a)a.raw=a.raw.trimEnd(),a.text=a.text.trimEnd();else return;o.raw=o.raw.trimEnd();for(let l=0;l<o.items.length;l++)if(this.lexer.state.top=!1,o.items[l].tokens=this.lexer.blockTokens(o.items[l].text,[]),!o.loose){let c=o.items[l].tokens.filter(u=>u.type==="space"),h=c.length>0&&c.some(u=>this.rules.other.anyLine.test(u.raw));o.loose=h}if(o.loose)for(let l=0;l<o.items.length;l++)o.items[l].loose=!0;return o}}html(e){let t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){let t=this.rules.block.def.exec(e);if(t){let n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",o=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:r,title:o}}}table(e){let t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;let n=So(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),o=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],i={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(let s of r)this.rules.other.tableAlignRight.test(s)?i.align.push("right"):this.rules.other.tableAlignCenter.test(s)?i.align.push("center"):this.rules.other.tableAlignLeft.test(s)?i.align.push("left"):i.align.push(null);for(let s=0;s<n.length;s++)i.header.push({text:n[s],tokens:this.lexer.inline(n[s]),header:!0,align:i.align[s]});for(let s of o)i.rows.push(So(s,i.header.length).map((a,l)=>({text:a,tokens:this.lexer.inline(a),header:!1,align:i.align[l]})));return i}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let i=pt(n.slice(0,-1),"\\");if((n.length-i.length)%2===0)return}else{let i=Ql(t[2],"()");if(i===-2)return;if(i>-1){let s=(t[0].indexOf("!")===0?5:4)+t[1].length+i;t[2]=t[2].substring(0,i),t[0]=t[0].substring(0,s).trim(),t[3]=""}}let r=t[2],o="";if(this.options.pedantic){let i=this.rules.other.pedanticHrefTitle.exec(r);i&&(r=i[1],o=i[3])}else o=t[3]?t[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),Co(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:o&&o.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),o=t[r.toLowerCase()];if(!o){let i=n[0].charAt(0);return{type:"text",raw:i,text:i}}return Co(n,o,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))&&(!(r[1]||r[2])||!n||this.rules.inline.punctuation.exec(n))){let o=[...r[0]].length-1,i,s,a=o,l=0,c=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(c.lastIndex=0,t=t.slice(-1*e.length+o);(r=c.exec(t))!=null;){if(i=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!i)continue;if(s=[...i].length,r[3]||r[4]){a+=s;continue}else if((r[5]||r[6])&&o%3&&!((o+s)%3)){l+=s;continue}if(a-=s,a>0)continue;s=Math.min(s,s+a+l);let h=[...r[0]][0].length,u=e.slice(0,o+r.index+h+s);if(Math.min(o,s)%2){let f=u.slice(1,-1);return{type:"em",raw:u,text:f,tokens:this.lexer.inlineTokens(f)}}let d=u.slice(2,-2);return{type:"strong",raw:u,text:d,tokens:this.lexer.inlineTokens(d)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," "),r=this.rules.other.nonSpaceChar.test(n),o=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&o&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){let t=this.rules.inline.autolink.exec(e);if(t){let n,r;return t[2]==="@"?(n=t[1],r="mailto:"+n):(n=t[1],r=n),{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let n,r;if(t[2]==="@")n=t[0],r="mailto:"+n;else{let o;do o=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??"";while(o!==t[0]);n=t[0],t[1]==="www."?r="http://"+t[0]:r=t[0]}return{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e){let t=this.rules.inline.text.exec(e);if(t){let n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},ye=class Qr{tokens;options;state;tokenizer;inlineQueue;constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||Ve,this.options.tokenizer=this.options.tokenizer||new Zt,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let n={other:he,block:Ut.normal,inline:ft.normal};this.options.pedantic?(n.block=Ut.pedantic,n.inline=ft.pedantic):this.options.gfm&&(n.block=Ut.gfm,this.options.breaks?n.inline=ft.breaks:n.inline=ft.gfm),this.tokenizer.rules=n}static get rules(){return{block:Ut,inline:ft}}static lex(t,n){return new Qr(n).lex(t)}static lexInline(t,n){return new Qr(n).inlineTokens(t)}lex(t){t=t.replace(he.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){let r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],r=!1){for(this.options.pedantic&&(t=t.replace(he.tabCharGlobal,"    ").replace(he.spaceLine,""));t;){let o;if(this.options.extensions?.block?.some(s=>(o=s.call({lexer:this},t,n))?(t=t.substring(o.raw.length),n.push(o),!0):!1))continue;if(o=this.tokenizer.space(t)){t=t.substring(o.raw.length);let s=n.at(-1);o.raw.length===1&&s!==void 0?s.raw+=`
`:n.push(o);continue}if(o=this.tokenizer.code(t)){t=t.substring(o.raw.length);let s=n.at(-1);s?.type==="paragraph"||s?.type==="text"?(s.raw+=(s.raw.endsWith(`
`)?"":`
`)+o.raw,s.text+=`
`+o.text,this.inlineQueue.at(-1).src=s.text):n.push(o);continue}if(o=this.tokenizer.fences(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.heading(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.hr(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.blockquote(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.list(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.html(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.def(t)){t=t.substring(o.raw.length);let s=n.at(-1);s?.type==="paragraph"||s?.type==="text"?(s.raw+=(s.raw.endsWith(`
`)?"":`
`)+o.raw,s.text+=`
`+o.raw,this.inlineQueue.at(-1).src=s.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title},n.push(o));continue}if(o=this.tokenizer.table(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.lheading(t)){t=t.substring(o.raw.length),n.push(o);continue}let i=t;if(this.options.extensions?.startBlock){let s=1/0,a=t.slice(1),l;this.options.extensions.startBlock.forEach(c=>{l=c.call({lexer:this},a),typeof l=="number"&&l>=0&&(s=Math.min(s,l))}),s<1/0&&s>=0&&(i=t.substring(0,s+1))}if(this.state.top&&(o=this.tokenizer.paragraph(i))){let s=n.at(-1);r&&s?.type==="paragraph"?(s.raw+=(s.raw.endsWith(`
`)?"":`
`)+o.raw,s.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=s.text):n.push(o),r=i.length!==t.length,t=t.substring(o.raw.length);continue}if(o=this.tokenizer.text(t)){t=t.substring(o.raw.length);let s=n.at(-1);s?.type==="text"?(s.raw+=(s.raw.endsWith(`
`)?"":`
`)+o.raw,s.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=s.text):n.push(o);continue}if(t){let s="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(s);break}else throw new Error(s)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){let r=t,o=null;if(this.tokens.links){let a=Object.keys(this.tokens.links);if(a.length>0)for(;(o=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)a.includes(o[0].slice(o[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(o=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,o.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(o=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);r=this.options.hooks?.emStrongMask?.call({lexer:this},r)??r;let i=!1,s="";for(;t;){i||(s=""),i=!1;let a;if(this.options.extensions?.inline?.some(c=>(a=c.call({lexer:this},t,n))?(t=t.substring(a.raw.length),n.push(a),!0):!1))continue;if(a=this.tokenizer.escape(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.tag(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.link(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(a.raw.length);let c=n.at(-1);a.type==="text"&&c?.type==="text"?(c.raw+=a.raw,c.text+=a.text):n.push(a);continue}if(a=this.tokenizer.emStrong(t,r,s)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.codespan(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.br(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.del(t)){t=t.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.autolink(t)){t=t.substring(a.raw.length),n.push(a);continue}if(!this.state.inLink&&(a=this.tokenizer.url(t))){t=t.substring(a.raw.length),n.push(a);continue}let l=t;if(this.options.extensions?.startInline){let c=1/0,h=t.slice(1),u;this.options.extensions.startInline.forEach(d=>{u=d.call({lexer:this},h),typeof u=="number"&&u>=0&&(c=Math.min(c,u))}),c<1/0&&c>=0&&(l=t.substring(0,c+1))}if(a=this.tokenizer.inlineText(l)){t=t.substring(a.raw.length),a.raw.slice(-1)!=="_"&&(s=a.raw.slice(-1)),i=!0;let c=n.at(-1);c?.type==="text"?(c.raw+=a.raw,c.text+=a.text):n.push(a);continue}if(t){let c="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return n}},Kt=class{options;parser;constructor(e){this.options=e||Ve}space(e){return""}code({text:e,lang:t,escaped:n}){let r=(t||"").match(he.notSpaceStart)?.[0],o=e.replace(he.endingNewline,"")+`
`;return r?'<pre><code class="language-'+Ne(r)+'">'+(n?o:Ne(o,!0))+`</code></pre>
`:"<pre><code>"+(n?o:Ne(o,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}def(e){return""}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){let t=e.ordered,n=e.start,r="";for(let s=0;s<e.items.length;s++){let a=e.items[s];r+=this.listitem(a)}let o=t?"ol":"ul",i=t&&n!==1?' start="'+n+'"':"";return"<"+o+i+`>
`+r+"</"+o+`>
`}listitem(e){let t="";if(e.task){let n=this.checkbox({checked:!!e.checked});e.loose?e.tokens[0]?.type==="paragraph"?(e.tokens[0].text=n+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=n+" "+Ne(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:n+" ",text:n+" ",escaped:!0}):t+=n+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let o=0;o<e.header.length;o++)n+=this.tablecell(e.header[o]);t+=this.tablerow({text:n});let r="";for(let o=0;o<e.rows.length;o++){let i=e.rows[o];n="";for(let s=0;s<i.length;s++)n+=this.tablecell(i[s]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){let t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${Ne(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){let r=this.parser.parseInline(n),o=No(e);if(o===null)return r;e=o;let i='<a href="'+e+'"';return t&&(i+=' title="'+Ne(t)+'"'),i+=">"+r+"</a>",i}image({href:e,title:t,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));let o=No(e);if(o===null)return Ne(n);e=o;let i=`<img src="${e}" alt="${n}"`;return t&&(i+=` title="${Ne(t)}"`),i+=">",i}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:Ne(e.text)}},tr=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},xe=class Jr{options;renderer;textRenderer;constructor(t){this.options=t||Ve,this.options.renderer=this.options.renderer||new Kt,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new tr}static parse(t,n){return new Jr(n).parse(t)}static parseInline(t,n){return new Jr(n).parseInline(t)}parse(t,n=!0){let r="";for(let o=0;o<t.length;o++){let i=t[o];if(this.options.extensions?.renderers?.[i.type]){let a=i,l=this.options.extensions.renderers[a.type].call({parser:this},a);if(l!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(a.type)){r+=l||"";continue}}let s=i;switch(s.type){case"space":{r+=this.renderer.space(s);continue}case"hr":{r+=this.renderer.hr(s);continue}case"heading":{r+=this.renderer.heading(s);continue}case"code":{r+=this.renderer.code(s);continue}case"table":{r+=this.renderer.table(s);continue}case"blockquote":{r+=this.renderer.blockquote(s);continue}case"list":{r+=this.renderer.list(s);continue}case"html":{r+=this.renderer.html(s);continue}case"def":{r+=this.renderer.def(s);continue}case"paragraph":{r+=this.renderer.paragraph(s);continue}case"text":{let a=s,l=this.renderer.text(a);for(;o+1<t.length&&t[o+1].type==="text";)a=t[++o],l+=`
`+this.renderer.text(a);n?r+=this.renderer.paragraph({type:"paragraph",raw:l,text:l,tokens:[{type:"text",raw:l,text:l,escaped:!0}]}):r+=l;continue}default:{let a='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return r}parseInline(t,n=this.renderer){let r="";for(let o=0;o<t.length;o++){let i=t[o];if(this.options.extensions?.renderers?.[i.type]){let a=this.options.extensions.renderers[i.type].call({parser:this},i);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(i.type)){r+=a||"";continue}}let s=i;switch(s.type){case"escape":{r+=n.text(s);break}case"html":{r+=n.html(s);break}case"link":{r+=n.link(s);break}case"image":{r+=n.image(s);break}case"strong":{r+=n.strong(s);break}case"em":{r+=n.em(s);break}case"codespan":{r+=n.codespan(s);break}case"br":{r+=n.br(s);break}case"del":{r+=n.del(s);break}case"text":{r+=n.text(s);break}default:{let a='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return r}},gt=class{options;block;constructor(e){this.options=e||Ve}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens","emStrongMask"]);static passThroughHooksRespectAsync=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}emStrongMask(e){return e}provideLexer(){return this.block?ye.lex:ye.lexInline}provideParser(){return this.block?xe.parse:xe.parseInline}},ec=class{defaults=Wn();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=xe;Renderer=Kt;TextRenderer=tr;Lexer=ye;Tokenizer=Zt;Hooks=gt;constructor(...e){this.use(...e)}walkTokens(e,t){let n=[];for(let r of e)switch(n=n.concat(t.call(this,r)),r.type){case"table":{let o=r;for(let i of o.header)n=n.concat(this.walkTokens(i.tokens,t));for(let i of o.rows)for(let s of i)n=n.concat(this.walkTokens(s.tokens,t));break}case"list":{let o=r;n=n.concat(this.walkTokens(o.items,t));break}default:{let o=r;this.defaults.extensions?.childTokens?.[o.type]?this.defaults.extensions.childTokens[o.type].forEach(i=>{let s=o[i].flat(1/0);n=n.concat(this.walkTokens(s,t))}):o.tokens&&(n=n.concat(this.walkTokens(o.tokens,t)))}}return n}use(...e){let t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{let r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(o=>{if(!o.name)throw new Error("extension name required");if("renderer"in o){let i=t.renderers[o.name];i?t.renderers[o.name]=function(...s){let a=o.renderer.apply(this,s);return a===!1&&(a=i.apply(this,s)),a}:t.renderers[o.name]=o.renderer}if("tokenizer"in o){if(!o.level||o.level!=="block"&&o.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let i=t[o.level];i?i.unshift(o.tokenizer):t[o.level]=[o.tokenizer],o.start&&(o.level==="block"?t.startBlock?t.startBlock.push(o.start):t.startBlock=[o.start]:o.level==="inline"&&(t.startInline?t.startInline.push(o.start):t.startInline=[o.start]))}"childTokens"in o&&o.childTokens&&(t.childTokens[o.name]=o.childTokens)}),r.extensions=t),n.renderer){let o=this.defaults.renderer||new Kt(this.defaults);for(let i in n.renderer){if(!(i in o))throw new Error(`renderer '${i}' does not exist`);if(["options","parser"].includes(i))continue;let s=i,a=n.renderer[s],l=o[s];o[s]=(...c)=>{let h=a.apply(o,c);return h===!1&&(h=l.apply(o,c)),h||""}}r.renderer=o}if(n.tokenizer){let o=this.defaults.tokenizer||new Zt(this.defaults);for(let i in n.tokenizer){if(!(i in o))throw new Error(`tokenizer '${i}' does not exist`);if(["options","rules","lexer"].includes(i))continue;let s=i,a=n.tokenizer[s],l=o[s];o[s]=(...c)=>{let h=a.apply(o,c);return h===!1&&(h=l.apply(o,c)),h}}r.tokenizer=o}if(n.hooks){let o=this.defaults.hooks||new gt;for(let i in n.hooks){if(!(i in o))throw new Error(`hook '${i}' does not exist`);if(["options","block"].includes(i))continue;let s=i,a=n.hooks[s],l=o[s];gt.passThroughHooks.has(i)?o[s]=c=>{if(this.defaults.async&&gt.passThroughHooksRespectAsync.has(i))return(async()=>{let u=await a.call(o,c);return l.call(o,u)})();let h=a.call(o,c);return l.call(o,h)}:o[s]=(...c)=>{if(this.defaults.async)return(async()=>{let u=await a.apply(o,c);return u===!1&&(u=await l.apply(o,c)),u})();let h=a.apply(o,c);return h===!1&&(h=l.apply(o,c)),h}}r.hooks=o}if(n.walkTokens){let o=this.defaults.walkTokens,i=n.walkTokens;r.walkTokens=function(s){let a=[];return a.push(i.call(this,s)),o&&(a=a.concat(o.call(this,s))),a}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return ye.lex(e,t??this.defaults)}parser(e,t){return xe.parse(e,t??this.defaults)}parseMarkdown(e){return(t,n)=>{let r={...n},o={...this.defaults,...r},i=this.onError(!!o.silent,!!o.async);if(this.defaults.async===!0&&r.async===!1)return i(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return i(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return i(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));if(o.hooks&&(o.hooks.options=o,o.hooks.block=e),o.async)return(async()=>{let s=o.hooks?await o.hooks.preprocess(t):t,a=await(o.hooks?await o.hooks.provideLexer():e?ye.lex:ye.lexInline)(s,o),l=o.hooks?await o.hooks.processAllTokens(a):a;o.walkTokens&&await Promise.all(this.walkTokens(l,o.walkTokens));let c=await(o.hooks?await o.hooks.provideParser():e?xe.parse:xe.parseInline)(l,o);return o.hooks?await o.hooks.postprocess(c):c})().catch(i);try{o.hooks&&(t=o.hooks.preprocess(t));let s=(o.hooks?o.hooks.provideLexer():e?ye.lex:ye.lexInline)(t,o);o.hooks&&(s=o.hooks.processAllTokens(s)),o.walkTokens&&this.walkTokens(s,o.walkTokens);let a=(o.hooks?o.hooks.provideParser():e?xe.parse:xe.parseInline)(s,o);return o.hooks&&(a=o.hooks.postprocess(a)),a}catch(s){return i(s)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){let r="<p>An error occurred:</p><pre>"+Ne(n.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(n);throw n}}},Ge=new ec;function re(e,t){return Ge.parse(e,t)}re.options=re.setOptions=function(e){return Ge.setOptions(e),re.defaults=Ge.defaults,uo(re.defaults),re},re.getDefaults=Wn,re.defaults=Ve,re.use=function(...e){return Ge.use(...e),re.defaults=Ge.defaults,uo(re.defaults),re},re.walkTokens=function(e,t){return Ge.walkTokens(e,t)},re.parseInline=Ge.parseInline,re.Parser=xe,re.parser=xe.parse,re.Renderer=Kt,re.TextRenderer=tr,re.Lexer=ye,re.lexer=ye.lex,re.Tokenizer=Zt,re.Hooks=gt,re.parse=re,re.options,re.setOptions,re.use,re.walkTokens,re.parseInline,xe.parse,ye.lex;function To(e,t){document.querySelectorAll(".workflow-page-modal-overlay").forEach(h=>h.remove());const n=document.createElement("div");n.className="workflow-page-modal-overlay",n.style.cssText=`
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 999998;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
  `;const r=document.createElement("div");r.className="workflow-page-modal",r.style.cssText=`
    background: white;
    border-radius: 8px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    z-index: 999999;
    max-width: 700px;
    width: 100%;
    max-height: 80vh;
    display: flex;
    flex-direction: column;
    position: relative;
    overflow: hidden;
  `;const o=document.createElement("div");o.style.cssText=`
    padding: 20px 24px;
    background-color: #E8F5E9;
    display: flex;
    justify-content: space-between;
    align-items: center;
  `;const i=document.createElement("h2");i.textContent=t?`${t} - Result`:"Flosheet Output",i.style.cssText=`
    margin: 0;
    font-size: 19px;
    font-weight: 600;
    color: #66BB6A;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  `;const s=document.createElement("button");s.innerHTML="×",s.style.cssText=`
    background: #E8F5E9;
    color: #66BB6A;
    border: 2px solid #66BB6A;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 22px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.2s;
    padding: 0;
    line-height: 1;
  `,s.onmouseover=()=>{s.style.transform="scale(1.1)"},s.onmouseout=()=>{s.style.transform="scale(1)"},o.appendChild(i),o.appendChild(s);const a=document.createElement("div");if(a.className="workflow-markdown-content",a.innerHTML=e,a.style.cssText=`
    padding: 20px;
    overflow-y: auto;
    flex: 1;
    word-wrap: break-word;
    background: white;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    font-size: 14px;
    font-weight: 500;
    line-height: 1.6;
    color: #2C2C2C;
  `,!document.querySelector(".workflow-markdown-styles")){const h=document.createElement("style");h.className="workflow-markdown-styles",h.textContent=`
      .workflow-markdown-content h1,
      .workflow-markdown-content h2,
      .workflow-markdown-content h3,
      .workflow-markdown-content h4 {
        margin-top: 24px;
        margin-bottom: 12px;
        font-weight: 600;
        line-height: 1.25;
        color: #1f2937;
      }
      .workflow-markdown-content h1 { font-size: 2em; border-bottom: 1px solid #e5e7eb; padding-bottom: 8px; }
      .workflow-markdown-content h2 { font-size: 1.5em; border-bottom: 1px solid #e5e7eb; padding-bottom: 6px; }
      .workflow-markdown-content h3 { font-size: 1.25em; }
      .workflow-markdown-content h4 { font-size: 1em; }
      .workflow-markdown-content h1:first-child,
      .workflow-markdown-content h2:first-child,
      .workflow-markdown-content h3:first-child { margin-top: 0; }
      .workflow-markdown-content p { margin-bottom: 16px; }
      .workflow-markdown-content ul,
      .workflow-markdown-content ol { margin-bottom: 16px; padding-left: 24px; }
      .workflow-markdown-content li { margin-bottom: 4px; }
      .workflow-markdown-content code {
        background: #f3f4f6;
        padding: 2px 6px;
        border-radius: 3px;
        font-family: 'Monaco', 'Courier New', monospace;
        font-size: 0.9em;
        color: #e83e8c;
      }
      .workflow-markdown-content pre {
        background: #f3f4f6;
        padding: 16px;
        border-radius: 6px;
        overflow-x: auto;
        margin-bottom: 16px;
      }
      .workflow-markdown-content pre code {
        background: none;
        padding: 0;
        color: #374151;
      }
      .workflow-markdown-content blockquote {
        border-left: 4px solid #e5e7eb;
        padding-left: 16px;
        margin-left: 0;
        margin-bottom: 16px;
        color: #6b7280;
        font-style: italic;
      }
      .workflow-markdown-content a { color: #3b82f6; text-decoration: none; }
      .workflow-markdown-content a:hover { text-decoration: underline; }
      .workflow-markdown-content hr { border: none; border-top: 1px solid #e5e7eb; margin: 24px 0; }
      .workflow-markdown-content table { 
        border-collapse: collapse; 
        width: 100%; 
        margin-bottom: 16px; 
      }
      .workflow-markdown-content th,
      .workflow-markdown-content td { 
        border: 1px solid #e5e7eb; 
        padding: 8px 12px; 
        text-align: left;
      }
      .workflow-markdown-content th { background: #f9fafb; font-weight: 600; }
      .workflow-markdown-content img { max-width: 100%; height: auto; border-radius: 6px; }
      .workflow-markdown-content strong { font-weight: 600; }
      .workflow-markdown-content em { font-style: italic; }
    `,document.head.appendChild(h)}r.appendChild(o),r.appendChild(a),n.appendChild(r),document.body.appendChild(n);const l=()=>{n.remove()};s.onclick=l,n.onclick=h=>{h.target===n&&l()};const c=h=>{h.key==="Escape"&&(l(),document.removeEventListener("keydown",c))};document.addEventListener("keydown",c)}const tc={...xl,executor:async(e,t,n,r,o)=>{if(!t)throw new Error("No input to display in modal");try{let i;try{i=re.parse(t)}catch{i=`<pre style="white-space: pre-wrap; margin: 0; font-family: inherit;">${t}</pre>`}if(r)return To(i,o),"Modal displayed";if(!chrome.scripting)throw new Error("Cannot display modal in this context");return await chrome.scripting.executeScript({target:{tabId:n},func:To,args:[i,o]}),"Modal displayed"}catch(i){throw console.error("Failed to display modal:",i),new Error("Failed to display modal on page")}}},nc=Object.fromEntries([Ua,Za,Ja,nl,rl,ol,sl,tc].map(e=>[e.type,e]));async function rc(e,t){const n=oc(e.nodes,e.edges),r=new Map;let o="";for(const i of n){const s=nc[i.type];if(!s){console.warn(`Unknown node type: ${i.type}`);continue}try{t.onNodeStart?.(i.id);const a=ic(i.id,e.edges,r);if(s.executor){const l=await s.executor(i,a,t.tabId,t.pageContext,t.workflowName);r.set(i.id,l),o=l,t.onNodeComplete?.(i.id,l)}else r.set(i.id,a),o=a,t.onNodeComplete?.(i.id,a)}catch(a){const l=a instanceof Error?a.message:String(a);throw t.onNodeError?.(i.id,l),a}}return o}function oc(e,t){const n=new Map,r=new Map,o=new Map;e.forEach(a=>{o.set(a.id,a),n.set(a.id,0),r.set(a.id,[])}),t.forEach(a=>{r.get(a.source)?.push(a.target),n.set(a.target,(n.get(a.target)||0)+1)});const i=[];n.forEach((a,l)=>{a===0&&i.push(l)});const s=[];for(;i.length>0;){const a=i.shift(),l=o.get(a);l&&s.push(l),(r.get(a)||[]).forEach(h=>{const u=(n.get(h)||0)-1;n.set(h,u),u===0&&i.push(h)})}return s}function ic(e,t,n){const r=t.filter(i=>i.target===e);if(r.length===0)return"";const o=r[0].source;return n.get(o)||""}const sc=Object.freeze(Object.defineProperty({__proto__:null,executeWorkflow:rc},Symbol.toStringTag,{value:"Module"}));var nr={exports:{}},mt={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ao;function ac(){if(Ao)return mt;Ao=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,o,i){var s=null;if(i!==void 0&&(s=""+i),o.key!==void 0&&(s=""+o.key),"key"in o){i={};for(var a in o)a!=="key"&&(i[a]=o[a])}else i=o;return o=i.ref,{$$typeof:e,type:r,key:s,ref:o!==void 0?o:null,props:i}}return mt.Fragment=t,mt.jsx=n,mt.jsxs=n,mt}var Ro;function lc(){return Ro||(Ro=1,nr.exports=ac()),nr.exports}var x=lc();function ce(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=ce(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var cc={value:()=>{}};function Qt(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Jt(n)}function Jt(e){this._=e}function uc(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Jt.prototype=Qt.prototype={constructor:Jt,on:function(e,t){var n=this._,r=uc(e+"",n),o,i=-1,s=r.length;if(arguments.length<2){for(;++i<s;)if((o=(e=r[i]).type)&&(o=dc(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(o=(e=r[i]).type)n[o]=Mo(n[o],e.name,t);else if(t==null)for(o in n)n[o]=Mo(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Jt(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,i;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,i=r.length;o<i;++o)r[o].value.apply(t,n)}};function dc(e,t){for(var n=0,r=e.length,o;n<r;++n)if((o=e[n]).name===t)return o.value}function Mo(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=cc,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var rr="http://www.w3.org/1999/xhtml";const $o={svg:"http://www.w3.org/2000/svg",xhtml:rr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function en(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),$o.hasOwnProperty(t)?{space:$o[t],local:e}:e}function hc(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===rr&&t.documentElement.namespaceURI===rr?t.createElement(e):t.createElementNS(n,e)}}function fc(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Io(e){var t=en(e);return(t.local?fc:hc)(t)}function pc(){}function or(e){return e==null?pc:function(){return this.querySelector(e)}}function gc(e){typeof e!="function"&&(e=or(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=new Array(s),l,c,h=0;h<s;++h)(l=i[h])&&(c=e.call(l,l.__data__,h,i))&&("__data__"in l&&(c.__data__=l.__data__),a[h]=c);return new pe(r,this._parents)}function mc(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function yc(){return[]}function Po(e){return e==null?yc:function(){return this.querySelectorAll(e)}}function xc(e){return function(){return mc(e.apply(this,arguments))}}function wc(e){typeof e=="function"?e=xc(e):e=Po(e);for(var t=this._groups,n=t.length,r=[],o=[],i=0;i<n;++i)for(var s=t[i],a=s.length,l,c=0;c<a;++c)(l=s[c])&&(r.push(e.call(l,l.__data__,c,s)),o.push(l));return new pe(r,o)}function Do(e){return function(){return this.matches(e)}}function Lo(e){return function(t){return t.matches(e)}}var bc=Array.prototype.find;function vc(e){return function(){return bc.call(this.children,e)}}function _c(){return this.firstElementChild}function Ec(e){return this.select(e==null?_c:vc(typeof e=="function"?e:Lo(e)))}var kc=Array.prototype.filter;function Nc(){return Array.from(this.children)}function Sc(e){return function(){return kc.call(this.children,e)}}function Cc(e){return this.selectAll(e==null?Nc:Sc(typeof e=="function"?e:Lo(e)))}function Tc(e){typeof e!="function"&&(e=Do(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=[],l,c=0;c<s;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&a.push(l);return new pe(r,this._parents)}function zo(e){return new Array(e.length)}function Ac(){return new pe(this._enter||this._groups.map(zo),this._parents)}function tn(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}tn.prototype={constructor:tn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Rc(e){return function(){return e}}function Mc(e,t,n,r,o,i){for(var s=0,a,l=t.length,c=i.length;s<c;++s)(a=t[s])?(a.__data__=i[s],r[s]=a):n[s]=new tn(e,i[s]);for(;s<l;++s)(a=t[s])&&(o[s]=a)}function $c(e,t,n,r,o,i,s){var a,l,c=new Map,h=t.length,u=i.length,d=new Array(h),f;for(a=0;a<h;++a)(l=t[a])&&(d[a]=f=s.call(l,l.__data__,a,t)+"",c.has(f)?o[a]=l:c.set(f,l));for(a=0;a<u;++a)f=s.call(e,i[a],a,i)+"",(l=c.get(f))?(r[a]=l,l.__data__=i[a],c.delete(f)):n[a]=new tn(e,i[a]);for(a=0;a<h;++a)(l=t[a])&&c.get(d[a])===l&&(o[a]=l)}function Ic(e){return e.__data__}function Pc(e,t){if(!arguments.length)return Array.from(this,Ic);var n=t?$c:Mc,r=this._parents,o=this._groups;typeof e!="function"&&(e=Rc(e));for(var i=o.length,s=new Array(i),a=new Array(i),l=new Array(i),c=0;c<i;++c){var h=r[c],u=o[c],d=u.length,f=Dc(e.call(h,h&&h.__data__,c,r)),m=f.length,g=a[c]=new Array(m),v=s[c]=new Array(m),w=l[c]=new Array(d);n(h,u,g,v,w,f,t);for(var S=0,p=0,b,C;S<m;++S)if(b=g[S]){for(S>=p&&(p=S+1);!(C=v[p])&&++p<m;);b._next=C||null}}return s=new pe(s,r),s._enter=a,s._exit=l,s}function Dc(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Lc(){return new pe(this._exit||this._groups.map(zo),this._parents)}function zc(e,t,n){var r=this.enter(),o=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?i.remove():n(i),r&&o?r.merge(o).order():o}function Bc(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,i=r.length,s=Math.min(o,i),a=new Array(o),l=0;l<s;++l)for(var c=n[l],h=r[l],u=c.length,d=a[l]=new Array(u),f,m=0;m<u;++m)(f=c[m]||h[m])&&(d[m]=f);for(;l<o;++l)a[l]=n[l];return new pe(a,this._parents)}function Hc(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],o=r.length-1,i=r[o],s;--o>=0;)(s=r[o])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function Oc(e){e||(e=jc);function t(u,d){return u&&d?e(u.__data__,d.__data__):!u-!d}for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var s=n[i],a=s.length,l=o[i]=new Array(a),c,h=0;h<a;++h)(c=s[h])&&(l[h]=c);l.sort(t)}return new pe(o,this._parents).order()}function jc(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Fc(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Vc(){return Array.from(this)}function Gc(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length;o<i;++o){var s=r[o];if(s)return s}return null}function Xc(){let e=0;for(const t of this)++e;return e}function Wc(){return!this.node()}function Yc(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o=t[n],i=0,s=o.length,a;i<s;++i)(a=o[i])&&e.call(a,a.__data__,i,o);return this}function qc(e){return function(){this.removeAttribute(e)}}function Uc(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Zc(e,t){return function(){this.setAttribute(e,t)}}function Kc(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Qc(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Jc(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function eu(e,t){var n=en(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Uc:qc:typeof t=="function"?n.local?Jc:Qc:n.local?Kc:Zc)(n,t))}function Bo(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function tu(e){return function(){this.style.removeProperty(e)}}function nu(e,t,n){return function(){this.style.setProperty(e,t,n)}}function ru(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function ou(e,t,n){return arguments.length>1?this.each((t==null?tu:typeof t=="function"?ru:nu)(e,t,n??"")):Qe(this.node(),e)}function Qe(e,t){return e.style.getPropertyValue(t)||Bo(e).getComputedStyle(e,null).getPropertyValue(t)}function iu(e){return function(){delete this[e]}}function su(e,t){return function(){this[e]=t}}function au(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function lu(e,t){return arguments.length>1?this.each((t==null?iu:typeof t=="function"?au:su)(e,t)):this.node()[e]}function Ho(e){return e.trim().split(/^|\s+/)}function ir(e){return e.classList||new Oo(e)}function Oo(e){this._node=e,this._names=Ho(e.getAttribute("class")||"")}Oo.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function jo(e,t){for(var n=ir(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function Fo(e,t){for(var n=ir(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function cu(e){return function(){jo(this,e)}}function uu(e){return function(){Fo(this,e)}}function du(e,t){return function(){(t.apply(this,arguments)?jo:Fo)(this,e)}}function hu(e,t){var n=Ho(e+"");if(arguments.length<2){for(var r=ir(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?du:t?cu:uu)(n,t))}function fu(){this.textContent=""}function pu(e){return function(){this.textContent=e}}function gu(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function mu(e){return arguments.length?this.each(e==null?fu:(typeof e=="function"?gu:pu)(e)):this.node().textContent}function yu(){this.innerHTML=""}function xu(e){return function(){this.innerHTML=e}}function wu(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function bu(e){return arguments.length?this.each(e==null?yu:(typeof e=="function"?wu:xu)(e)):this.node().innerHTML}function vu(){this.nextSibling&&this.parentNode.appendChild(this)}function _u(){return this.each(vu)}function Eu(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ku(){return this.each(Eu)}function Nu(e){var t=typeof e=="function"?e:Io(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Su(){return null}function Cu(e,t){var n=typeof e=="function"?e:Io(e),r=t==null?Su:typeof t=="function"?t:or(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Tu(){var e=this.parentNode;e&&e.removeChild(this)}function Au(){return this.each(Tu)}function Ru(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Mu(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function $u(e){return this.select(e?Mu:Ru)}function Iu(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Pu(e){return function(t){e.call(this,t,this.__data__)}}function Du(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Lu(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,o=t.length,i;n<o;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function zu(e,t,n){return function(){var r=this.__on,o,i=Pu(t);if(r){for(var s=0,a=r.length;s<a;++s)if((o=r[s]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=n),o.value=t;return}}this.addEventListener(e.type,i,n),o={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(o):this.__on=[o]}}function Bu(e,t,n){var r=Du(e+""),o,i=r.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,h;l<c;++l)for(o=0,h=a[l];o<i;++o)if((s=r[o]).type===h.type&&s.name===h.name)return h.value}return}for(a=t?zu:Lu,o=0;o<i;++o)this.each(a(r[o],t,n));return this}function Vo(e,t,n){var r=Bo(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function Hu(e,t){return function(){return Vo(this,e,t)}}function Ou(e,t){return function(){return Vo(this,e,t.apply(this,arguments))}}function ju(e,t){return this.each((typeof t=="function"?Ou:Hu)(e,t))}function*Fu(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length,s;o<i;++o)(s=r[o])&&(yield s)}var Go=[null];function pe(e,t){this._groups=e,this._parents=t}function yt(){return new pe([[document.documentElement]],Go)}function Vu(){return this}pe.prototype=yt.prototype={constructor:pe,select:gc,selectAll:wc,selectChild:Ec,selectChildren:Cc,filter:Tc,data:Pc,enter:Ac,exit:Lc,join:zc,merge:Bc,selection:Vu,order:Hc,sort:Oc,call:Fc,nodes:Vc,node:Gc,size:Xc,empty:Wc,each:Yc,attr:eu,style:ou,property:lu,classed:hu,text:mu,html:bu,raise:_u,lower:ku,append:Nu,insert:Cu,remove:Au,clone:$u,datum:Iu,on:Bu,dispatch:ju,[Symbol.iterator]:Fu};function ge(e){return typeof e=="string"?new pe([[document.querySelector(e)]],[document.documentElement]):new pe([[e]],Go)}function Gu(e){let t;for(;t=e.sourceEvent;)e=t;return e}function we(e,t){if(e=Gu(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const Xu={passive:!1},xt={capture:!0,passive:!1};function sr(e){e.stopImmediatePropagation()}function Je(e){e.preventDefault(),e.stopImmediatePropagation()}function Xo(e){var t=e.document.documentElement,n=ge(e).on("dragstart.drag",Je,xt);"onselectstart"in t?n.on("selectstart.drag",Je,xt):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Wo(e,t){var n=e.document.documentElement,r=ge(e).on("dragstart.drag",null);t&&(r.on("click.drag",Je,xt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const nn=e=>()=>e;function ar(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:i,x:s,y:a,dx:l,dy:c,dispatch:h}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:h}})}ar.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Wu(e){return!e.ctrlKey&&!e.button}function Yu(){return this.parentNode}function qu(e,t){return t??{x:e.x,y:e.y}}function Uu(){return navigator.maxTouchPoints||"ontouchstart"in this}function Yo(){var e=Wu,t=Yu,n=qu,r=Uu,o={},i=Qt("start","drag","end"),s=0,a,l,c,h,u=0;function d(b){b.on("mousedown.drag",f).filter(r).on("touchstart.drag",v).on("touchmove.drag",w,Xu).on("touchend.drag touchcancel.drag",S).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(b,C){if(!(h||!e.call(this,b,C))){var E=p(this,t.call(this,b,C),b,C,"mouse");E&&(ge(b.view).on("mousemove.drag",m,xt).on("mouseup.drag",g,xt),Xo(b.view),sr(b),c=!1,a=b.clientX,l=b.clientY,E("start",b))}}function m(b){if(Je(b),!c){var C=b.clientX-a,E=b.clientY-l;c=C*C+E*E>u}o.mouse("drag",b)}function g(b){ge(b.view).on("mousemove.drag mouseup.drag",null),Wo(b.view,c),Je(b),o.mouse("end",b)}function v(b,C){if(e.call(this,b,C)){var E=b.changedTouches,k=t.call(this,b,C),P=E.length,L,O;for(L=0;L<P;++L)(O=p(this,k,b,C,E[L].identifier,E[L]))&&(sr(b),O("start",b,E[L]))}}function w(b){var C=b.changedTouches,E=C.length,k,P;for(k=0;k<E;++k)(P=o[C[k].identifier])&&(Je(b),P("drag",b,C[k]))}function S(b){var C=b.changedTouches,E=C.length,k,P;for(h&&clearTimeout(h),h=setTimeout(function(){h=null},500),k=0;k<E;++k)(P=o[C[k].identifier])&&(sr(b),P("end",b,C[k]))}function p(b,C,E,k,P,L){var O=i.copy(),z=we(L||E,C),M,B,_;if((_=n.call(b,new ar("beforestart",{sourceEvent:E,target:d,identifier:P,active:s,x:z[0],y:z[1],dx:0,dy:0,dispatch:O}),k))!=null)return M=_.x-z[0]||0,B=_.y-z[1]||0,function A(T,$,R){var D=z,F;switch(T){case"start":o[P]=A,F=s++;break;case"end":delete o[P],--s;case"drag":z=we(R||$,C),F=s;break}O.call(T,b,new ar(T,{sourceEvent:$,subject:_,target:d,identifier:P,active:F,x:z[0]+M,y:z[1]+B,dx:z[0]-D[0],dy:z[1]-D[1],dispatch:O}),k)}}return d.filter=function(b){return arguments.length?(e=typeof b=="function"?b:nn(!!b),d):e},d.container=function(b){return arguments.length?(t=typeof b=="function"?b:nn(b),d):t},d.subject=function(b){return arguments.length?(n=typeof b=="function"?b:nn(b),d):n},d.touchable=function(b){return arguments.length?(r=typeof b=="function"?b:nn(!!b),d):r},d.on=function(){var b=i.on.apply(i,arguments);return b===i?d:b},d.clickDistance=function(b){return arguments.length?(u=(b=+b)*b,d):Math.sqrt(u)},d}function lr(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function qo(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function wt(){}var bt=.7,rn=1/bt,et="\\s*([+-]?\\d+)\\s*",vt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Se="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Zu=/^#([0-9a-f]{3,8})$/,Ku=new RegExp(`^rgb\\(${et},${et},${et}\\)$`),Qu=new RegExp(`^rgb\\(${Se},${Se},${Se}\\)$`),Ju=new RegExp(`^rgba\\(${et},${et},${et},${vt}\\)$`),ed=new RegExp(`^rgba\\(${Se},${Se},${Se},${vt}\\)$`),td=new RegExp(`^hsl\\(${vt},${Se},${Se}\\)$`),nd=new RegExp(`^hsla\\(${vt},${Se},${Se},${vt}\\)$`),Uo={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};lr(wt,Xe,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Zo,formatHex:Zo,formatHex8:rd,formatHsl:od,formatRgb:Ko,toString:Ko});function Zo(){return this.rgb().formatHex()}function rd(){return this.rgb().formatHex8()}function od(){return ni(this).formatHsl()}function Ko(){return this.rgb().formatRgb()}function Xe(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Zu.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Qo(t):n===3?new fe(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?on(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?on(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Ku.exec(e))?new fe(t[1],t[2],t[3],1):(t=Qu.exec(e))?new fe(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Ju.exec(e))?on(t[1],t[2],t[3],t[4]):(t=ed.exec(e))?on(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=td.exec(e))?ti(t[1],t[2]/100,t[3]/100,1):(t=nd.exec(e))?ti(t[1],t[2]/100,t[3]/100,t[4]):Uo.hasOwnProperty(e)?Qo(Uo[e]):e==="transparent"?new fe(NaN,NaN,NaN,0):null}function Qo(e){return new fe(e>>16&255,e>>8&255,e&255,1)}function on(e,t,n,r){return r<=0&&(e=t=n=NaN),new fe(e,t,n,r)}function id(e){return e instanceof wt||(e=Xe(e)),e?(e=e.rgb(),new fe(e.r,e.g,e.b,e.opacity)):new fe}function cr(e,t,n,r){return arguments.length===1?id(e):new fe(e,t,n,r??1)}function fe(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}lr(fe,cr,qo(wt,{brighter(e){return e=e==null?rn:Math.pow(rn,e),new fe(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?bt:Math.pow(bt,e),new fe(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new fe(We(this.r),We(this.g),We(this.b),sn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Jo,formatHex:Jo,formatHex8:sd,formatRgb:ei,toString:ei}));function Jo(){return`#${Ye(this.r)}${Ye(this.g)}${Ye(this.b)}`}function sd(){return`#${Ye(this.r)}${Ye(this.g)}${Ye(this.b)}${Ye((isNaN(this.opacity)?1:this.opacity)*255)}`}function ei(){const e=sn(this.opacity);return`${e===1?"rgb(":"rgba("}${We(this.r)}, ${We(this.g)}, ${We(this.b)}${e===1?")":`, ${e})`}`}function sn(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function We(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ye(e){return e=We(e),(e<16?"0":"")+e.toString(16)}function ti(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new be(e,t,n,r)}function ni(e){if(e instanceof be)return new be(e.h,e.s,e.l,e.opacity);if(e instanceof wt||(e=Xe(e)),!e)return new be;if(e instanceof be)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),i=Math.max(t,n,r),s=NaN,a=i-o,l=(i+o)/2;return a?(t===i?s=(n-r)/a+(n<r)*6:n===i?s=(r-t)/a+2:s=(t-n)/a+4,a/=l<.5?i+o:2-i-o,s*=60):a=l>0&&l<1?0:s,new be(s,a,l,e.opacity)}function ad(e,t,n,r){return arguments.length===1?ni(e):new be(e,t,n,r??1)}function be(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}lr(be,ad,qo(wt,{brighter(e){return e=e==null?rn:Math.pow(rn,e),new be(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?bt:Math.pow(bt,e),new be(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new fe(ur(e>=240?e-240:e+120,o,r),ur(e,o,r),ur(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new be(ri(this.h),an(this.s),an(this.l),sn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=sn(this.opacity);return`${e===1?"hsl(":"hsla("}${ri(this.h)}, ${an(this.s)*100}%, ${an(this.l)*100}%${e===1?")":`, ${e})`}`}}));function ri(e){return e=(e||0)%360,e<0?e+360:e}function an(e){return Math.max(0,Math.min(1,e||0))}function ur(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const dr=e=>()=>e;function ld(e,t){return function(n){return e+n*t}}function cd(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function ud(e){return(e=+e)==1?oi:function(t,n){return n-t?cd(t,n,e):dr(isNaN(t)?n:t)}}function oi(e,t){var n=t-e;return n?ld(e,n):dr(isNaN(e)?t:e)}const ln=(function e(t){var n=ud(t);function r(o,i){var s=n((o=cr(o)).r,(i=cr(i)).r),a=n(o.g,i.g),l=n(o.b,i.b),c=oi(o.opacity,i.opacity);return function(h){return o.r=s(h),o.g=a(h),o.b=l(h),o.opacity=c(h),o+""}}return r.gamma=e,r})(1);function dd(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),o;return function(i){for(o=0;o<n;++o)r[o]=e[o]*(1-i)+t[o]*i;return r}}function hd(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function fd(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,o=new Array(r),i=new Array(n),s;for(s=0;s<r;++s)o[s]=_t(e[s],t[s]);for(;s<n;++s)i[s]=t[s];return function(a){for(s=0;s<r;++s)i[s]=o[s](a);return i}}function pd(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Ce(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function gd(e,t){var n={},r={},o;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(o in t)o in e?n[o]=_t(e[o],t[o]):r[o]=t[o];return function(i){for(o in n)r[o]=n[o](i);return r}}var hr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,fr=new RegExp(hr.source,"g");function md(e){return function(){return e}}function yd(e){return function(t){return e(t)+""}}function ii(e,t){var n=hr.lastIndex=fr.lastIndex=0,r,o,i,s=-1,a=[],l=[];for(e=e+"",t=t+"";(r=hr.exec(e))&&(o=fr.exec(t));)(i=o.index)>n&&(i=t.slice(n,i),a[s]?a[s]+=i:a[++s]=i),(r=r[0])===(o=o[0])?a[s]?a[s]+=o:a[++s]=o:(a[++s]=null,l.push({i:s,x:Ce(r,o)})),n=fr.lastIndex;return n<t.length&&(i=t.slice(n),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?yd(l[0].x):md(t):(t=l.length,function(c){for(var h=0,u;h<t;++h)a[(u=l[h]).i]=u.x(c);return a.join("")})}function _t(e,t){var n=typeof t,r;return t==null||n==="boolean"?dr(t):(n==="number"?Ce:n==="string"?(r=Xe(t))?(t=r,ln):ii:t instanceof Xe?ln:t instanceof Date?pd:hd(t)?dd:Array.isArray(t)?fd:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?gd:Ce)(e,t)}var si=180/Math.PI,pr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ai(e,t,n,r,o,i){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),e*r<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:o,translateY:i,rotate:Math.atan2(t,e)*si,skewX:Math.atan(l)*si,scaleX:s,scaleY:a}}var cn;function xd(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?pr:ai(t.a,t.b,t.c,t.d,t.e,t.f)}function wd(e){return e==null||(cn||(cn=document.createElementNS("http://www.w3.org/2000/svg","g")),cn.setAttribute("transform",e),!(e=cn.transform.baseVal.consolidate()))?pr:(e=e.matrix,ai(e.a,e.b,e.c,e.d,e.e,e.f))}function li(e,t,n,r){function o(c){return c.length?c.pop()+" ":""}function i(c,h,u,d,f,m){if(c!==u||h!==d){var g=f.push("translate(",null,t,null,n);m.push({i:g-4,x:Ce(c,u)},{i:g-2,x:Ce(h,d)})}else(u||d)&&f.push("translate("+u+t+d+n)}function s(c,h,u,d){c!==h?(c-h>180?h+=360:h-c>180&&(c+=360),d.push({i:u.push(o(u)+"rotate(",null,r)-2,x:Ce(c,h)})):h&&u.push(o(u)+"rotate("+h+r)}function a(c,h,u,d){c!==h?d.push({i:u.push(o(u)+"skewX(",null,r)-2,x:Ce(c,h)}):h&&u.push(o(u)+"skewX("+h+r)}function l(c,h,u,d,f,m){if(c!==u||h!==d){var g=f.push(o(f)+"scale(",null,",",null,")");m.push({i:g-4,x:Ce(c,u)},{i:g-2,x:Ce(h,d)})}else(u!==1||d!==1)&&f.push(o(f)+"scale("+u+","+d+")")}return function(c,h){var u=[],d=[];return c=e(c),h=e(h),i(c.translateX,c.translateY,h.translateX,h.translateY,u,d),s(c.rotate,h.rotate,u,d),a(c.skewX,h.skewX,u,d),l(c.scaleX,c.scaleY,h.scaleX,h.scaleY,u,d),c=h=null,function(f){for(var m=-1,g=d.length,v;++m<g;)u[(v=d[m]).i]=v.x(f);return u.join("")}}}var bd=li(xd,"px, ","px)","deg)"),vd=li(wd,", ",")",")"),_d=1e-12;function ci(e){return((e=Math.exp(e))+1/e)/2}function Ed(e){return((e=Math.exp(e))-1/e)/2}function kd(e){return((e=Math.exp(2*e))-1)/(e+1)}const un=(function e(t,n,r){function o(i,s){var a=i[0],l=i[1],c=i[2],h=s[0],u=s[1],d=s[2],f=h-a,m=u-l,g=f*f+m*m,v,w;if(g<_d)w=Math.log(d/c)/t,v=function(k){return[a+k*f,l+k*m,c*Math.exp(t*k*w)]};else{var S=Math.sqrt(g),p=(d*d-c*c+r*g)/(2*c*n*S),b=(d*d-c*c-r*g)/(2*d*n*S),C=Math.log(Math.sqrt(p*p+1)-p),E=Math.log(Math.sqrt(b*b+1)-b);w=(E-C)/t,v=function(k){var P=k*w,L=ci(C),O=c/(n*S)*(L*kd(t*P+C)-Ed(C));return[a+O*f,l+O*m,c*L/ci(t*P+C)]}}return v.duration=w*1e3*t/Math.SQRT2,v}return o.rho=function(i){var s=Math.max(.001,+i),a=s*s,l=a*a;return e(s,a,l)},o})(Math.SQRT2,2,4);var tt=0,Et=0,kt=0,ui=1e3,dn,Nt,hn=0,qe=0,fn=0,St=typeof performance=="object"&&performance.now?performance:Date,di=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function gr(){return qe||(di(Nd),qe=St.now()+fn)}function Nd(){qe=0}function pn(){this._call=this._time=this._next=null}pn.prototype=hi.prototype={constructor:pn,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?gr():+n)+(t==null?0:+t),!this._next&&Nt!==this&&(Nt?Nt._next=this:dn=this,Nt=this),this._call=e,this._time=n,mr()},stop:function(){this._call&&(this._call=null,this._time=1/0,mr())}};function hi(e,t,n){var r=new pn;return r.restart(e,t,n),r}function Sd(){gr(),++tt;for(var e=dn,t;e;)(t=qe-e._time)>=0&&e._call.call(void 0,t),e=e._next;--tt}function fi(){qe=(hn=St.now())+fn,tt=Et=0;try{Sd()}finally{tt=0,Td(),qe=0}}function Cd(){var e=St.now(),t=e-hn;t>ui&&(fn-=t,hn=e)}function Td(){for(var e,t=dn,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:dn=n);Nt=e,mr(r)}function mr(e){if(!tt){Et&&(Et=clearTimeout(Et));var t=e-qe;t>24?(e<1/0&&(Et=setTimeout(fi,e-St.now()-fn)),kt&&(kt=clearInterval(kt))):(kt||(hn=St.now(),kt=setInterval(Cd,ui)),tt=1,di(fi))}}function pi(e,t,n){var r=new pn;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,n),r}var Ad=Qt("start","end","cancel","interrupt"),Rd=[],gi=0,mi=1,yr=2,gn=3,yi=4,xr=5,mn=6;function yn(e,t,n,r,o,i){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;Md(e,n,{name:t,index:r,group:o,on:Ad,tween:Rd,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:gi})}function wr(e,t){var n=ve(e,t);if(n.state>gi)throw new Error("too late; already scheduled");return n}function Te(e,t){var n=ve(e,t);if(n.state>gn)throw new Error("too late; already running");return n}function ve(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Md(e,t,n){var r=e.__transition,o;r[t]=n,n.timer=hi(i,0,n.time);function i(c){n.state=mi,n.timer.restart(s,n.delay,n.time),n.delay<=c&&s(c-n.delay)}function s(c){var h,u,d,f;if(n.state!==mi)return l();for(h in r)if(f=r[h],f.name===n.name){if(f.state===gn)return pi(s);f.state===yi?(f.state=mn,f.timer.stop(),f.on.call("interrupt",e,e.__data__,f.index,f.group),delete r[h]):+h<t&&(f.state=mn,f.timer.stop(),f.on.call("cancel",e,e.__data__,f.index,f.group),delete r[h])}if(pi(function(){n.state===gn&&(n.state=yi,n.timer.restart(a,n.delay,n.time),a(c))}),n.state=yr,n.on.call("start",e,e.__data__,n.index,n.group),n.state===yr){for(n.state=gn,o=new Array(d=n.tween.length),h=0,u=-1;h<d;++h)(f=n.tween[h].value.call(e,e.__data__,n.index,n.group))&&(o[++u]=f);o.length=u+1}}function a(c){for(var h=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=xr,1),u=-1,d=o.length;++u<d;)o[u].call(e,h);n.state===xr&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=mn,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function xn(e,t){var n=e.__transition,r,o,i=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((r=n[s]).name!==t){i=!1;continue}o=r.state>yr&&r.state<xr,r.state=mn,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[s]}i&&delete e.__transition}}function $d(e){return this.each(function(){xn(this,e)})}function Id(e,t){var n,r;return function(){var o=Te(this,e),i=o.tween;if(i!==n){r=n=i;for(var s=0,a=r.length;s<a;++s)if(r[s].name===t){r=r.slice(),r.splice(s,1);break}}o.tween=r}}function Pd(e,t,n){var r,o;if(typeof n!="function")throw new Error;return function(){var i=Te(this,e),s=i.tween;if(s!==r){o=(r=s).slice();for(var a={name:t,value:n},l=0,c=o.length;l<c;++l)if(o[l].name===t){o[l]=a;break}l===c&&o.push(a)}i.tween=o}}function Dd(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=ve(this.node(),n).tween,o=0,i=r.length,s;o<i;++o)if((s=r[o]).name===e)return s.value;return null}return this.each((t==null?Id:Pd)(n,e,t))}function br(e,t,n){var r=e._id;return e.each(function(){var o=Te(this,r);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return ve(o,r).value[t]}}function xi(e,t){var n;return(typeof t=="number"?Ce:t instanceof Xe?ln:(n=Xe(t))?(t=n,ln):ii)(e,t)}function Ld(e){return function(){this.removeAttribute(e)}}function zd(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Bd(e,t,n){var r,o=n+"",i;return function(){var s=this.getAttribute(e);return s===o?null:s===r?i:i=t(r=s,n)}}function Hd(e,t,n){var r,o=n+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===o?null:s===r?i:i=t(r=s,n)}}function Od(e,t,n){var r,o,i;return function(){var s,a=n(this),l;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),l=a+"",s===l?null:s===r&&l===o?i:(o=l,i=t(r=s,a)))}}function jd(e,t,n){var r,o,i;return function(){var s,a=n(this),l;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),l=a+"",s===l?null:s===r&&l===o?i:(o=l,i=t(r=s,a)))}}function Fd(e,t){var n=en(e),r=n==="transform"?vd:xi;return this.attrTween(e,typeof t=="function"?(n.local?jd:Od)(n,r,br(this,"attr."+e,t)):t==null?(n.local?zd:Ld)(n):(n.local?Hd:Bd)(n,r,t))}function Vd(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Gd(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Xd(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&Gd(e,i)),n}return o._value=t,o}function Wd(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&Vd(e,i)),n}return o._value=t,o}function Yd(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=en(e);return this.tween(n,(r.local?Xd:Wd)(r,t))}function qd(e,t){return function(){wr(this,e).delay=+t.apply(this,arguments)}}function Ud(e,t){return t=+t,function(){wr(this,e).delay=t}}function Zd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?qd:Ud)(t,e)):ve(this.node(),t).delay}function Kd(e,t){return function(){Te(this,e).duration=+t.apply(this,arguments)}}function Qd(e,t){return t=+t,function(){Te(this,e).duration=t}}function Jd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Kd:Qd)(t,e)):ve(this.node(),t).duration}function eh(e,t){if(typeof t!="function")throw new Error;return function(){Te(this,e).ease=t}}function th(e){var t=this._id;return arguments.length?this.each(eh(t,e)):ve(this.node(),t).ease}function nh(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Te(this,e).ease=n}}function rh(e){if(typeof e!="function")throw new Error;return this.each(nh(this._id,e))}function oh(e){typeof e!="function"&&(e=Do(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=[],l,c=0;c<s;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&a.push(l);return new Me(r,this._parents,this._name,this._id)}function ih(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,i=Math.min(r,o),s=new Array(r),a=0;a<i;++a)for(var l=t[a],c=n[a],h=l.length,u=s[a]=new Array(h),d,f=0;f<h;++f)(d=l[f]||c[f])&&(u[f]=d);for(;a<r;++a)s[a]=t[a];return new Me(s,this._parents,this._name,this._id)}function sh(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function ah(e,t,n){var r,o,i=sh(t)?wr:Te;return function(){var s=i(this,e),a=s.on;a!==r&&(o=(r=a).copy()).on(t,n),s.on=o}}function lh(e,t){var n=this._id;return arguments.length<2?ve(this.node(),n).on.on(e):this.each(ah(n,e,t))}function ch(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function uh(){return this.on("end.remove",ch(this._id))}function dh(e){var t=this._name,n=this._id;typeof e!="function"&&(e=or(e));for(var r=this._groups,o=r.length,i=new Array(o),s=0;s<o;++s)for(var a=r[s],l=a.length,c=i[s]=new Array(l),h,u,d=0;d<l;++d)(h=a[d])&&(u=e.call(h,h.__data__,d,a))&&("__data__"in h&&(u.__data__=h.__data__),c[d]=u,yn(c[d],t,n,d,c,ve(h,n)));return new Me(i,this._parents,t,n)}function hh(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Po(e));for(var r=this._groups,o=r.length,i=[],s=[],a=0;a<o;++a)for(var l=r[a],c=l.length,h,u=0;u<c;++u)if(h=l[u]){for(var d=e.call(h,h.__data__,u,l),f,m=ve(h,n),g=0,v=d.length;g<v;++g)(f=d[g])&&yn(f,t,n,g,d,m);i.push(d),s.push(h)}return new Me(i,s,t,n)}var fh=yt.prototype.constructor;function ph(){return new fh(this._groups,this._parents)}function gh(e,t){var n,r,o;return function(){var i=Qe(this,e),s=(this.style.removeProperty(e),Qe(this,e));return i===s?null:i===n&&s===r?o:o=t(n=i,r=s)}}function wi(e){return function(){this.style.removeProperty(e)}}function mh(e,t,n){var r,o=n+"",i;return function(){var s=Qe(this,e);return s===o?null:s===r?i:i=t(r=s,n)}}function yh(e,t,n){var r,o,i;return function(){var s=Qe(this,e),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(e),Qe(this,e))),s===l?null:s===r&&l===o?i:(o=l,i=t(r=s,a))}}function xh(e,t){var n,r,o,i="style."+t,s="end."+i,a;return function(){var l=Te(this,e),c=l.on,h=l.value[i]==null?a||(a=wi(t)):void 0;(c!==n||o!==h)&&(r=(n=c).copy()).on(s,o=h),l.on=r}}function wh(e,t,n){var r=(e+="")=="transform"?bd:xi;return t==null?this.styleTween(e,gh(e,r)).on("end.style."+e,wi(e)):typeof t=="function"?this.styleTween(e,yh(e,r,br(this,"style."+e,t))).each(xh(this._id,e)):this.styleTween(e,mh(e,r,t),n).on("end.style."+e,null)}function bh(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function vh(e,t,n){var r,o;function i(){var s=t.apply(this,arguments);return s!==o&&(r=(o=s)&&bh(e,s,n)),r}return i._value=t,i}function _h(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,vh(e,t,n??""))}function Eh(e){return function(){this.textContent=e}}function kh(e){return function(){var t=e(this);this.textContent=t??""}}function Nh(e){return this.tween("text",typeof e=="function"?kh(br(this,"text",e)):Eh(e==null?"":e+""))}function Sh(e){return function(t){this.textContent=e.call(this,t)}}function Ch(e){var t,n;function r(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&Sh(o)),t}return r._value=e,r}function Th(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Ch(e))}function Ah(){for(var e=this._name,t=this._id,n=bi(),r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,l,c=0;c<a;++c)if(l=s[c]){var h=ve(l,t);yn(l,e,n,c,s,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new Me(r,this._parents,e,n)}function Rh(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(i,s){var a={value:s},l={value:function(){--o===0&&i()}};n.each(function(){var c=Te(this,r),h=c.on;h!==e&&(t=(e=h).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),c.on=t}),o===0&&i()})}var Mh=0;function Me(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function bi(){return++Mh}var $e=yt.prototype;Me.prototype={constructor:Me,select:dh,selectAll:hh,selectChild:$e.selectChild,selectChildren:$e.selectChildren,filter:oh,merge:ih,selection:ph,transition:Ah,call:$e.call,nodes:$e.nodes,node:$e.node,size:$e.size,empty:$e.empty,each:$e.each,on:lh,attr:Fd,attrTween:Yd,style:wh,styleTween:_h,text:Nh,textTween:Th,remove:uh,tween:Dd,delay:Zd,duration:Jd,ease:th,easeVarying:rh,end:Rh,[Symbol.iterator]:$e[Symbol.iterator]};function $h(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Ih={time:null,delay:0,duration:250,ease:$h};function Ph(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Dh(e){var t,n;e instanceof Me?(t=e._id,e=e._name):(t=bi(),(n=Ih).time=gr(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,l,c=0;c<a;++c)(l=s[c])&&yn(l,e,t,c,s,n||Ph(l,t));return new Me(r,this._parents,e,t)}yt.prototype.interrupt=$d,yt.prototype.transition=Dh;const wn=e=>()=>e;function Lh(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function Ie(e,t,n){this.k=e,this.x=t,this.y=n}Ie.prototype={constructor:Ie,scale:function(e){return e===1?this:new Ie(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ie(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var bn=new Ie(1,0,0);vi.prototype=Ie.prototype;function vi(e){for(;!e.__zoom;)if(!(e=e.parentNode))return bn;return e.__zoom}function vr(e){e.stopImmediatePropagation()}function Ct(e){e.preventDefault(),e.stopImmediatePropagation()}function zh(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Bh(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function _i(){return this.__zoom||bn}function Hh(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Oh(){return navigator.maxTouchPoints||"ontouchstart"in this}function jh(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function Ei(){var e=zh,t=Bh,n=jh,r=Hh,o=Oh,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,l=un,c=Qt("start","zoom","end"),h,u,d,f=500,m=150,g=0,v=10;function w(_){_.property("__zoom",_i).on("wheel.zoom",P,{passive:!1}).on("mousedown.zoom",L).on("dblclick.zoom",O).filter(o).on("touchstart.zoom",z).on("touchmove.zoom",M).on("touchend.zoom touchcancel.zoom",B).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}w.transform=function(_,A,T,$){var R=_.selection?_.selection():_;R.property("__zoom",_i),_!==R?C(_,A,T,$):R.interrupt().each(function(){E(this,arguments).event($).start().zoom(null,typeof A=="function"?A.apply(this,arguments):A).end()})},w.scaleBy=function(_,A,T,$){w.scaleTo(_,function(){var R=this.__zoom.k,D=typeof A=="function"?A.apply(this,arguments):A;return R*D},T,$)},w.scaleTo=function(_,A,T,$){w.transform(_,function(){var R=t.apply(this,arguments),D=this.__zoom,F=T==null?b(R):typeof T=="function"?T.apply(this,arguments):T,y=D.invert(F),N=typeof A=="function"?A.apply(this,arguments):A;return n(p(S(D,N),F,y),R,s)},T,$)},w.translateBy=function(_,A,T,$){w.transform(_,function(){return n(this.__zoom.translate(typeof A=="function"?A.apply(this,arguments):A,typeof T=="function"?T.apply(this,arguments):T),t.apply(this,arguments),s)},null,$)},w.translateTo=function(_,A,T,$,R){w.transform(_,function(){var D=t.apply(this,arguments),F=this.__zoom,y=$==null?b(D):typeof $=="function"?$.apply(this,arguments):$;return n(bn.translate(y[0],y[1]).scale(F.k).translate(typeof A=="function"?-A.apply(this,arguments):-A,typeof T=="function"?-T.apply(this,arguments):-T),D,s)},$,R)};function S(_,A){return A=Math.max(i[0],Math.min(i[1],A)),A===_.k?_:new Ie(A,_.x,_.y)}function p(_,A,T){var $=A[0]-T[0]*_.k,R=A[1]-T[1]*_.k;return $===_.x&&R===_.y?_:new Ie(_.k,$,R)}function b(_){return[(+_[0][0]+ +_[1][0])/2,(+_[0][1]+ +_[1][1])/2]}function C(_,A,T,$){_.on("start.zoom",function(){E(this,arguments).event($).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event($).end()}).tween("zoom",function(){var R=this,D=arguments,F=E(R,D).event($),y=t.apply(R,D),N=T==null?b(y):typeof T=="function"?T.apply(R,D):T,j=Math.max(y[1][0]-y[0][0],y[1][1]-y[0][1]),H=R.__zoom,W=typeof A=="function"?A.apply(R,D):A,X=l(H.invert(N).concat(j/H.k),W.invert(N).concat(j/W.k));return function(G){if(G===1)G=W;else{var V=X(G),Y=j/V[2];G=new Ie(Y,N[0]-V[0]*Y,N[1]-V[1]*Y)}F.zoom(null,G)}})}function E(_,A,T){return!T&&_.__zooming||new k(_,A)}function k(_,A){this.that=_,this.args=A,this.active=0,this.sourceEvent=null,this.extent=t.apply(_,A),this.taps=0}k.prototype={event:function(_){return _&&(this.sourceEvent=_),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(_,A){return this.mouse&&_!=="mouse"&&(this.mouse[1]=A.invert(this.mouse[0])),this.touch0&&_!=="touch"&&(this.touch0[1]=A.invert(this.touch0[0])),this.touch1&&_!=="touch"&&(this.touch1[1]=A.invert(this.touch1[0])),this.that.__zoom=A,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(_){var A=ge(this.that).datum();c.call(_,this.that,new Lh(_,{sourceEvent:this.sourceEvent,target:w,transform:this.that.__zoom,dispatch:c}),A)}};function P(_,...A){if(!e.apply(this,arguments))return;var T=E(this,A).event(_),$=this.__zoom,R=Math.max(i[0],Math.min(i[1],$.k*Math.pow(2,r.apply(this,arguments)))),D=we(_);if(T.wheel)(T.mouse[0][0]!==D[0]||T.mouse[0][1]!==D[1])&&(T.mouse[1]=$.invert(T.mouse[0]=D)),clearTimeout(T.wheel);else{if($.k===R)return;T.mouse=[D,$.invert(D)],xn(this),T.start()}Ct(_),T.wheel=setTimeout(F,m),T.zoom("mouse",n(p(S($,R),T.mouse[0],T.mouse[1]),T.extent,s));function F(){T.wheel=null,T.end()}}function L(_,...A){if(d||!e.apply(this,arguments))return;var T=_.currentTarget,$=E(this,A,!0).event(_),R=ge(_.view).on("mousemove.zoom",N,!0).on("mouseup.zoom",j,!0),D=we(_,T),F=_.clientX,y=_.clientY;Xo(_.view),vr(_),$.mouse=[D,this.__zoom.invert(D)],xn(this),$.start();function N(H){if(Ct(H),!$.moved){var W=H.clientX-F,X=H.clientY-y;$.moved=W*W+X*X>g}$.event(H).zoom("mouse",n(p($.that.__zoom,$.mouse[0]=we(H,T),$.mouse[1]),$.extent,s))}function j(H){R.on("mousemove.zoom mouseup.zoom",null),Wo(H.view,$.moved),Ct(H),$.event(H).end()}}function O(_,...A){if(e.apply(this,arguments)){var T=this.__zoom,$=we(_.changedTouches?_.changedTouches[0]:_,this),R=T.invert($),D=T.k*(_.shiftKey?.5:2),F=n(p(S(T,D),$,R),t.apply(this,A),s);Ct(_),a>0?ge(this).transition().duration(a).call(C,F,$,_):ge(this).call(w.transform,F,$,_)}}function z(_,...A){if(e.apply(this,arguments)){var T=_.touches,$=T.length,R=E(this,A,_.changedTouches.length===$).event(_),D,F,y,N;for(vr(_),F=0;F<$;++F)y=T[F],N=we(y,this),N=[N,this.__zoom.invert(N),y.identifier],R.touch0?!R.touch1&&R.touch0[2]!==N[2]&&(R.touch1=N,R.taps=0):(R.touch0=N,D=!0,R.taps=1+!!h);h&&(h=clearTimeout(h)),D&&(R.taps<2&&(u=N[0],h=setTimeout(function(){h=null},f)),xn(this),R.start())}}function M(_,...A){if(this.__zooming){var T=E(this,A).event(_),$=_.changedTouches,R=$.length,D,F,y,N;for(Ct(_),D=0;D<R;++D)F=$[D],y=we(F,this),T.touch0&&T.touch0[2]===F.identifier?T.touch0[0]=y:T.touch1&&T.touch1[2]===F.identifier&&(T.touch1[0]=y);if(F=T.that.__zoom,T.touch1){var j=T.touch0[0],H=T.touch0[1],W=T.touch1[0],X=T.touch1[1],G=(G=W[0]-j[0])*G+(G=W[1]-j[1])*G,V=(V=X[0]-H[0])*V+(V=X[1]-H[1])*V;F=S(F,Math.sqrt(G/V)),y=[(j[0]+W[0])/2,(j[1]+W[1])/2],N=[(H[0]+X[0])/2,(H[1]+X[1])/2]}else if(T.touch0)y=T.touch0[0],N=T.touch0[1];else return;T.zoom("touch",n(p(F,y,N),T.extent,s))}}function B(_,...A){if(this.__zooming){var T=E(this,A).event(_),$=_.changedTouches,R=$.length,D,F;for(vr(_),d&&clearTimeout(d),d=setTimeout(function(){d=null},f),D=0;D<R;++D)F=$[D],T.touch0&&T.touch0[2]===F.identifier?delete T.touch0:T.touch1&&T.touch1[2]===F.identifier&&delete T.touch1;if(T.touch1&&!T.touch0&&(T.touch0=T.touch1,delete T.touch1),T.touch0)T.touch0[1]=this.__zoom.invert(T.touch0[0]);else if(T.end(),T.taps===2&&(F=we(F,this),Math.hypot(u[0]-F[0],u[1]-F[1])<v)){var y=ge(this).on("dblclick.zoom");y&&y.apply(this,arguments)}}}return w.wheelDelta=function(_){return arguments.length?(r=typeof _=="function"?_:wn(+_),w):r},w.filter=function(_){return arguments.length?(e=typeof _=="function"?_:wn(!!_),w):e},w.touchable=function(_){return arguments.length?(o=typeof _=="function"?_:wn(!!_),w):o},w.extent=function(_){return arguments.length?(t=typeof _=="function"?_:wn([[+_[0][0],+_[0][1]],[+_[1][0],+_[1][1]]]),w):t},w.scaleExtent=function(_){return arguments.length?(i[0]=+_[0],i[1]=+_[1],w):[i[0],i[1]]},w.translateExtent=function(_){return arguments.length?(s[0][0]=+_[0][0],s[1][0]=+_[1][0],s[0][1]=+_[0][1],s[1][1]=+_[1][1],w):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},w.constrain=function(_){return arguments.length?(n=_,w):n},w.duration=function(_){return arguments.length?(a=+_,w):a},w.interpolate=function(_){return arguments.length?(l=_,w):l},w.on=function(){var _=c.on.apply(c,arguments);return _===c?w:_},w.clickDistance=function(_){return arguments.length?(g=(_=+_)*_,w):Math.sqrt(g)},w.tapDistance=function(_){return arguments.length?(v=+_,w):v},w}const Ae={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},Tt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],ki=["Enter"," ","Escape"],Ni={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var nt;(function(e){e.Strict="strict",e.Loose="loose"})(nt||(nt={}));var Ue;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Ue||(Ue={}));var At;(function(e){e.Partial="partial",e.Full="full"})(At||(At={}));const Si={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var He;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(He||(He={}));var vn;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(vn||(vn={}));var q;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(q||(q={}));const Ci={[q.Left]:q.Right,[q.Right]:q.Left,[q.Top]:q.Bottom,[q.Bottom]:q.Top};function Ti(e){return e===null?null:e?"valid":"invalid"}const Ai=e=>"id"in e&&"source"in e&&"target"in e,Fh=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),_r=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Rt=(e,t=[0,0])=>{const{width:n,height:r}=Pe(e),o=e.origin??t,i=n*o[0],s=r*o[1];return{x:e.position.x-i,y:e.position.y-s}},Vh=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,o)=>{const i=typeof o=="string";let s=!t.nodeLookup&&!i?o:void 0;t.nodeLookup&&(s=i?t.nodeLookup.get(o):_r(o)?o:t.nodeLookup.get(o.id));const a=s?kn(s,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return _n(r,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return En(n)},Mt=(e,t={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},r=!1;return e.forEach(o=>{(t.filter===void 0||t.filter(o))&&(n=_n(n,kn(o)),r=!0)}),r?En(n):{x:0,y:0,width:0,height:0}},Er=(e,t,[n,r,o]=[0,0,1],i=!1,s=!1)=>{const a={...Pt(t,[n,r,o]),width:t.width/o,height:t.height/o},l=[];for(const c of e.values()){const{measured:h,selectable:u=!0,hidden:d=!1}=c;if(s&&!u||d)continue;const f=h.width??c.width??c.initialWidth??null,m=h.height??c.height??c.initialHeight??null,g=$t(a,ot(c)),v=(f??0)*(m??0),w=i&&g>0;(!c.internals.handleBounds||w||g>=v||c.dragging)&&l.push(c)}return l},Gh=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function Xh(e,t){const n=new Map,r=t?.nodes?new Set(t.nodes.map(o=>o.id)):null;return e.forEach(o=>{o.measured.width&&o.measured.height&&(t?.includeHiddenNodes||!o.hidden)&&(!r||r.has(o.id))&&n.set(o.id,o)}),n}async function Wh({nodes:e,width:t,height:n,panZoom:r,minZoom:o,maxZoom:i},s){if(e.size===0)return Promise.resolve(!0);const a=Xh(e,s),l=Mt(a),c=Nr(l,t,n,s?.minZoom??o,s?.maxZoom??i,s?.padding??.1);return await r.setViewport(c,{duration:s?.duration,ease:s?.ease,interpolate:s?.interpolate}),Promise.resolve(!0)}function Ri({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:o,onError:i}){const s=n.get(e),a=s.parentId?n.get(s.parentId):void 0,{x:l,y:c}=a?a.internals.positionAbsolute:{x:0,y:0},h=s.origin??r;let u=s.extent||o;if(s.extent==="parent"&&!s.expandParent)if(!a)i?.("005",Ae.error005());else{const f=a.measured.width,m=a.measured.height;f&&m&&(u=[[l,c],[l+f,c+m]])}else a&&st(s.extent)&&(u=[[s.extent[0][0]+l,s.extent[0][1]+c],[s.extent[1][0]+l,s.extent[1][1]+c]]);const d=st(u)?Ze(t,u,s.measured):t;return(s.measured.width===void 0||s.measured.height===void 0)&&i?.("015",Ae.error015()),{position:{x:d.x-l+(s.measured.width??0)*h[0],y:d.y-c+(s.measured.height??0)*h[1]},positionAbsolute:d}}async function Yh({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:o}){const i=new Set(e.map(d=>d.id)),s=[];for(const d of n){if(d.deletable===!1)continue;const f=i.has(d.id),m=!f&&d.parentId&&s.find(g=>g.id===d.parentId);(f||m)&&s.push(d)}const a=new Set(t.map(d=>d.id)),l=r.filter(d=>d.deletable!==!1),h=Gh(s,l);for(const d of l)a.has(d.id)&&!h.find(m=>m.id===d.id)&&h.push(d);if(!o)return{edges:h,nodes:s};const u=await o({nodes:s,edges:h});return typeof u=="boolean"?u?{edges:h,nodes:s}:{edges:[],nodes:[]}:u}const rt=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Ze=(e={x:0,y:0},t,n)=>({x:rt(e.x,t[0][0],t[1][0]-(n?.width??0)),y:rt(e.y,t[0][1],t[1][1]-(n?.height??0))});function Mi(e,t,n){const{width:r,height:o}=Pe(n),{x:i,y:s}=n.internals.positionAbsolute;return Ze(e,[[i,s],[i+r,s+o]],t)}const $i=(e,t,n)=>e<t?rt(Math.abs(e-t),1,t)/t:e>n?-rt(Math.abs(e-n),1,t)/t:0,Ii=(e,t,n=15,r=40)=>{const o=$i(e.x,r,t.width-r)*n,i=$i(e.y,r,t.height-r)*n;return[o,i]},_n=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),kr=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),En=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),ot=(e,t=[0,0])=>{const{x:n,y:r}=_r(e)?e.internals.positionAbsolute:Rt(e,t);return{x:n,y:r,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},kn=(e,t=[0,0])=>{const{x:n,y:r}=_r(e)?e.internals.positionAbsolute:Rt(e,t);return{x:n,y:r,x2:n+(e.measured?.width??e.width??e.initialWidth??0),y2:r+(e.measured?.height??e.height??e.initialHeight??0)}},Pi=(e,t)=>En(_n(kr(e),kr(t))),$t=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},Di=e=>_e(e.width)&&_e(e.height)&&_e(e.x)&&_e(e.y),_e=e=>!isNaN(e)&&isFinite(e),qh=(e,t)=>{},It=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Pt=({x:e,y:t},[n,r,o],i=!1,s=[1,1])=>{const a={x:(e-n)/o,y:(t-r)/o};return i?It(a,s):a},Nn=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r});function it(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function Uh(e,t,n){if(typeof e=="string"||typeof e=="number"){const r=it(e,n),o=it(e,t);return{top:r,right:o,bottom:r,left:o,x:o*2,y:r*2}}if(typeof e=="object"){const r=it(e.top??e.y??0,n),o=it(e.bottom??e.y??0,n),i=it(e.left??e.x??0,t),s=it(e.right??e.x??0,t);return{top:r,right:s,bottom:o,left:i,x:i+s,y:r+o}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function Zh(e,t,n,r,o,i){const{x:s,y:a}=Nn(e,[t,n,r]),{x:l,y:c}=Nn({x:e.x+e.width,y:e.y+e.height},[t,n,r]),h=o-l,u=i-c;return{left:Math.floor(s),top:Math.floor(a),right:Math.floor(h),bottom:Math.floor(u)}}const Nr=(e,t,n,r,o,i)=>{const s=Uh(i,t,n),a=(t-s.x)/e.width,l=(n-s.y)/e.height,c=Math.min(a,l),h=rt(c,r,o),u=e.x+e.width/2,d=e.y+e.height/2,f=t/2-u*h,m=n/2-d*h,g=Zh(e,f,m,h,t,n),v={left:Math.min(g.left-s.left,0),top:Math.min(g.top-s.top,0),right:Math.min(g.right-s.right,0),bottom:Math.min(g.bottom-s.bottom,0)};return{x:f-v.left+v.right,y:m-v.top+v.bottom,zoom:h}},Dt=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function st(e){return e!=null&&e!=="parent"}function Pe(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function Li(e){return(e.measured?.width??e.width??e.initialWidth)!==void 0&&(e.measured?.height??e.height??e.initialHeight)!==void 0}function zi(e,t={width:0,height:0},n,r,o){const i={...e},s=r.get(n);if(s){const a=s.origin||o;i.x+=s.internals.positionAbsolute.x-(t.width??0)*a[0],i.y+=s.internals.positionAbsolute.y-(t.height??0)*a[1]}return i}function Bi(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Kh(){let e,t;return{promise:new Promise((r,o)=>{e=r,t=o}),resolve:e,reject:t}}function Qh(e){return{...Ni,...e||{}}}function Lt(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:o}){const{x:i,y:s}=Ee(e),a=Pt({x:i-(o?.left??0),y:s-(o?.top??0)},r),{x:l,y:c}=n?It(a,t):a;return{xSnapped:l,ySnapped:c,...a}}const Sr=e=>({width:e.offsetWidth,height:e.offsetHeight}),Hi=e=>e?.getRootNode?.()||window?.document,Jh=["INPUT","SELECT","TEXTAREA"];function Oi(e){const t=e.composedPath?.()?.[0]||e.target;return t?.nodeType!==1?!1:Jh.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const ji=e=>"clientX"in e,Ee=(e,t)=>{const n=ji(e),r=n?e.clientX:e.touches?.[0].clientX,o=n?e.clientY:e.touches?.[0].clientY;return{x:r-(t?.left??0),y:o-(t?.top??0)}},Fi=(e,t,n,r,o)=>{const i=t.querySelectorAll(`.${e}`);return!i||!i.length?null:Array.from(i).map(s=>{const a=s.getBoundingClientRect();return{id:s.getAttribute("data-handleid"),type:e,nodeId:o,position:s.getAttribute("data-handlepos"),x:(a.left-n.left)/r,y:(a.top-n.top)/r,...Sr(s)}})};function Vi({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:i,targetControlX:s,targetControlY:a}){const l=e*.125+o*.375+s*.375+n*.125,c=t*.125+i*.375+a*.375+r*.125,h=Math.abs(l-e),u=Math.abs(c-t);return[l,c,h,u]}function Sn(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Gi({pos:e,x1:t,y1:n,x2:r,y2:o,c:i}){switch(e){case q.Left:return[t-Sn(t-r,i),n];case q.Right:return[t+Sn(r-t,i),n];case q.Top:return[t,n-Sn(n-o,i)];case q.Bottom:return[t,n+Sn(o-n,i)]}}function Xi({sourceX:e,sourceY:t,sourcePosition:n=q.Bottom,targetX:r,targetY:o,targetPosition:i=q.Top,curvature:s=.25}){const[a,l]=Gi({pos:n,x1:e,y1:t,x2:r,y2:o,c:s}),[c,h]=Gi({pos:i,x1:r,y1:o,x2:e,y2:t,c:s}),[u,d,f,m]=Vi({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:h});return[`M${e},${t} C${a},${l} ${c},${h} ${r},${o}`,u,d,f,m]}function Wi({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,i=n<e?n+o:n-o,s=Math.abs(r-t)/2,a=r<t?r+s:r-s;return[i,a,o,s]}function ef({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r,elevateOnSelect:o=!1}){if(r!==void 0)return r;const i=o&&n?1e3:0,s=Math.max(e.parentId||o&&e.selected?e.internals.z:0,t.parentId||o&&t.selected?t.internals.z:0);return i+s}function tf({sourceNode:e,targetNode:t,width:n,height:r,transform:o}){const i=_n(kn(e),kn(t));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);const s={x:-o[0]/o[2],y:-o[1]/o[2],width:n/o[2],height:r/o[2]};return $t(s,En(i))>0}const nf=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,rf=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),of=(e,t)=>{if(!e.source||!e.target)return t;let n;return Ai(e)?n={...e}:n={...e,id:nf(e)},rf(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function Yi({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,i,s,a]=Wi({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,i,s,a]}const qi={[q.Left]:{x:-1,y:0},[q.Right]:{x:1,y:0},[q.Top]:{x:0,y:-1},[q.Bottom]:{x:0,y:1}},sf=({source:e,sourcePosition:t=q.Bottom,target:n})=>t===q.Left||t===q.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Ui=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function af({source:e,sourcePosition:t=q.Bottom,target:n,targetPosition:r=q.Top,center:o,offset:i,stepPosition:s}){const a=qi[t],l=qi[r],c={x:e.x+a.x*i,y:e.y+a.y*i},h={x:n.x+l.x*i,y:n.y+l.y*i},u=sf({source:c,sourcePosition:t,target:h}),d=u.x!==0?"x":"y",f=u[d];let m=[],g,v;const w={x:0,y:0},S={x:0,y:0},[,,p,b]=Wi({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(a[d]*l[d]===-1){d==="x"?(g=o.x??c.x+(h.x-c.x)*s,v=o.y??(c.y+h.y)/2):(g=o.x??(c.x+h.x)/2,v=o.y??c.y+(h.y-c.y)*s);const E=[{x:g,y:c.y},{x:g,y:h.y}],k=[{x:c.x,y:v},{x:h.x,y:v}];a[d]===f?m=d==="x"?E:k:m=d==="x"?k:E}else{const E=[{x:c.x,y:h.y}],k=[{x:h.x,y:c.y}];if(d==="x"?m=a.x===f?k:E:m=a.y===f?E:k,t===r){const M=Math.abs(e[d]-n[d]);if(M<=i){const B=Math.min(i-1,i-M);a[d]===f?w[d]=(c[d]>e[d]?-1:1)*B:S[d]=(h[d]>n[d]?-1:1)*B}}if(t!==r){const M=d==="x"?"y":"x",B=a[d]===l[M],_=c[M]>h[M],A=c[M]<h[M];(a[d]===1&&(!B&&_||B&&A)||a[d]!==1&&(!B&&A||B&&_))&&(m=d==="x"?E:k)}const P={x:c.x+w.x,y:c.y+w.y},L={x:h.x+S.x,y:h.y+S.y},O=Math.max(Math.abs(P.x-m[0].x),Math.abs(L.x-m[0].x)),z=Math.max(Math.abs(P.y-m[0].y),Math.abs(L.y-m[0].y));O>=z?(g=(P.x+L.x)/2,v=m[0].y):(g=m[0].x,v=(P.y+L.y)/2)}return[[e,{x:c.x+w.x,y:c.y+w.y},...m,{x:h.x+S.x,y:h.y+S.y},n],g,v,p,b]}function lf(e,t,n,r){const o=Math.min(Ui(e,t)/2,Ui(t,n)/2,r),{x:i,y:s}=t;if(e.x===i&&i===n.x||e.y===s&&s===n.y)return`L${i} ${s}`;if(e.y===s){const c=e.x<n.x?-1:1,h=e.y<n.y?1:-1;return`L ${i+o*c},${s}Q ${i},${s} ${i},${s+o*h}`}const a=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${i},${s+o*l}Q ${i},${s} ${i+o*a},${s}`}function Cr({sourceX:e,sourceY:t,sourcePosition:n=q.Bottom,targetX:r,targetY:o,targetPosition:i=q.Top,borderRadius:s=5,centerX:a,centerY:l,offset:c=20,stepPosition:h=.5}){const[u,d,f,m,g]=af({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:i,center:{x:a,y:l},offset:c,stepPosition:h});return[u.reduce((w,S,p)=>{let b="";return p>0&&p<u.length-1?b=lf(u[p-1],S,u[p+1],s):b=`${p===0?"M":"L"}${S.x} ${S.y}`,w+=b,w},""),d,f,m,g]}function Zi(e){return e&&!!(e.internals.handleBounds||e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function cf(e){const{sourceNode:t,targetNode:n}=e;if(!Zi(t)||!Zi(n))return null;const r=t.internals.handleBounds||Ki(t.handles),o=n.internals.handleBounds||Ki(n.handles),i=Qi(r?.source??[],e.sourceHandle),s=Qi(e.connectionMode===nt.Strict?o?.target??[]:(o?.target??[]).concat(o?.source??[]),e.targetHandle);if(!i||!s)return e.onError?.("008",Ae.error008(i?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=i?.position||q.Bottom,l=s?.position||q.Top,c=zt(t,i,a),h=zt(n,s,l);return{sourceX:c.x,sourceY:c.y,targetX:h.x,targetY:h.y,sourcePosition:a,targetPosition:l}}function Ki(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function zt(e,t,n=q.Left,r=!1){const o=(t?.x??0)+e.internals.positionAbsolute.x,i=(t?.y??0)+e.internals.positionAbsolute.y,{width:s,height:a}=t??Pe(e);if(r)return{x:o+s/2,y:i+a/2};switch(t?.position??n){case q.Top:return{x:o+s/2,y:i};case q.Right:return{x:o+s,y:i+a/2};case q.Bottom:return{x:o+s/2,y:i+a};case q.Left:return{x:o,y:i+a/2}}}function Qi(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function Tr(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`:""}function uf(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:o}){const i=new Set;return e.reduce((s,a)=>([a.markerStart||r,a.markerEnd||o].forEach(l=>{if(l&&typeof l=="object"){const c=Tr(l,t);i.has(c)||(s.push({id:c,color:l.color||n,...l}),i.add(c))}}),s),[]).sort((s,a)=>s.id.localeCompare(a.id))}const Ji=1e3,df=10,Ar={nodeOrigin:[0,0],nodeExtent:Tt,elevateNodesOnSelect:!0,defaults:{}},hf={...Ar,checkEquality:!0};function Rr(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function ff(e,t,n){const r=Rr(Ar,n);for(const o of e.values())if(o.parentId)$r(o,e,t,r);else{const i=Rt(o,r.nodeOrigin),s=st(o.extent)?o.extent:r.nodeExtent,a=Ze(i,s,Pe(o));o.internals.positionAbsolute=a}}function pf(e,t){if(!e.handles)return e.measured?t?.internals.handleBounds:void 0;const n=[],r=[];for(const o of e.handles){const i={id:o.id,width:o.width??1,height:o.height??1,nodeId:e.id,x:o.x,y:o.y,position:o.position,type:o.type};o.type==="source"?n.push(i):o.type==="target"&&r.push(i)}return{source:n,target:r}}function Mr(e,t,n,r){const o=Rr(hf,r);let i={i:-1},s=e.length>0;const a=new Map(t),l=o?.elevateNodesOnSelect?Ji:0;t.clear(),n.clear();for(const c of e){let h=a.get(c.id);if(o.checkEquality&&c===h?.internals.userNode)t.set(c.id,h);else{const u=Rt(c,o.nodeOrigin),d=st(c.extent)?c.extent:o.nodeExtent,f=Ze(u,d,Pe(c));h={...o.defaults,...c,measured:{width:c.measured?.width,height:c.measured?.height},internals:{positionAbsolute:f,handleBounds:pf(c,h),z:es(c,l),userNode:c}},t.set(c.id,h)}(h.measured===void 0||h.measured.width===void 0||h.measured.height===void 0)&&!h.hidden&&(s=!1),c.parentId&&$r(h,t,n,r,i)}return s}function gf(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function $r(e,t,n,r,o){const{elevateNodesOnSelect:i,nodeOrigin:s,nodeExtent:a}=Rr(Ar,r),l=e.parentId,c=t.get(l);if(!c){console.warn(`Parent node ${l} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}gf(e,n),o&&!c.parentId&&c.internals.rootParentIndex===void 0&&(c.internals.rootParentIndex=++o.i,c.internals.z=c.internals.z+o.i*df),o&&c.internals.rootParentIndex!==void 0&&(o.i=c.internals.rootParentIndex);const h=i?Ji:0,{x:u,y:d,z:f}=mf(e,c,s,a,h),{positionAbsolute:m}=e.internals,g=u!==m.x||d!==m.y;(g||f!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:g?{x:u,y:d}:m,z:f}})}function es(e,t){return(_e(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function mf(e,t,n,r,o){const{x:i,y:s}=t.internals.positionAbsolute,a=Pe(e),l=Rt(e,n),c=st(e.extent)?Ze(l,e.extent,a):l;let h=Ze({x:i+c.x,y:s+c.y},r,a);e.extent==="parent"&&(h=Mi(h,a,t));const u=es(e,o),d=t.internals.z??0;return{x:h.x,y:h.y,z:d>=u?d+1:u}}function Ir(e,t,n,r=[0,0]){const o=[],i=new Map;for(const s of e){const a=t.get(s.parentId);if(!a)continue;const l=i.get(s.parentId)?.expandedRect??ot(a),c=Pi(l,s.rect);i.set(s.parentId,{expandedRect:c,parent:a})}return i.size>0&&i.forEach(({expandedRect:s,parent:a},l)=>{const c=a.internals.positionAbsolute,h=Pe(a),u=a.origin??r,d=s.x<c.x?Math.round(Math.abs(c.x-s.x)):0,f=s.y<c.y?Math.round(Math.abs(c.y-s.y)):0,m=Math.max(h.width,Math.round(s.width)),g=Math.max(h.height,Math.round(s.height)),v=(m-h.width)*u[0],w=(g-h.height)*u[1];(d>0||f>0||v||w)&&(o.push({id:l,type:"position",position:{x:a.position.x-d+v,y:a.position.y-f+w}}),n.get(l)?.forEach(S=>{e.some(p=>p.id===S.id)||o.push({id:S.id,type:"position",position:{x:S.position.x+d,y:S.position.y+f}})})),(h.width<s.width||h.height<s.height||d||f)&&o.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:m+(d?u[0]*d-v:0),height:g+(f?u[1]*f-w:0)}})}),o}function yf(e,t,n,r,o,i){const s=r?.querySelector(".xyflow__viewport");let a=!1;if(!s)return{changes:[],updatedInternals:a};const l=[],c=window.getComputedStyle(s),{m22:h}=new window.DOMMatrixReadOnly(c.transform),u=[];for(const d of e.values()){const f=t.get(d.id);if(!f)continue;if(f.hidden){t.set(f.id,{...f,internals:{...f.internals,handleBounds:void 0}}),a=!0;continue}const m=Sr(d.nodeElement),g=f.measured.width!==m.width||f.measured.height!==m.height;if(!!(m.width&&m.height&&(g||!f.internals.handleBounds||d.force))){const w=d.nodeElement.getBoundingClientRect(),S=st(f.extent)?f.extent:i;let{positionAbsolute:p}=f.internals;f.parentId&&f.extent==="parent"?p=Mi(p,m,t.get(f.parentId)):S&&(p=Ze(p,S,m));const b={...f,measured:m,internals:{...f.internals,positionAbsolute:p,handleBounds:{source:Fi("source",d.nodeElement,w,h,f.id),target:Fi("target",d.nodeElement,w,h,f.id)}}};t.set(f.id,b),f.parentId&&$r(b,t,n,{nodeOrigin:o}),a=!0,g&&(l.push({id:f.id,type:"dimensions",dimensions:m}),f.expandParent&&f.parentId&&u.push({id:f.id,parentId:f.parentId,rect:ot(b,o)}))}}if(u.length>0){const d=Ir(u,t,n,o);l.push(...d)}return{changes:l,updatedInternals:a}}async function xf({delta:e,panZoom:t,transform:n,translateExtent:r,width:o,height:i}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const s=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[o,i]],r),a=!!s&&(s.x!==n[0]||s.y!==n[1]||s.k!==n[2]);return Promise.resolve(a)}function ts(e,t,n,r,o,i){let s=o;const a=r.get(s)||new Map;r.set(s,a.set(n,t)),s=`${o}-${e}`;const l=r.get(s)||new Map;if(r.set(s,l.set(n,t)),i){s=`${o}-${e}-${i}`;const c=r.get(s)||new Map;r.set(s,c.set(n,t))}}function ns(e,t,n){e.clear(),t.clear();for(const r of n){const{source:o,target:i,sourceHandle:s=null,targetHandle:a=null}=r,l={edgeId:r.id,source:o,target:i,sourceHandle:s,targetHandle:a},c=`${o}-${s}--${i}-${a}`,h=`${i}-${a}--${o}-${s}`;ts("source",l,h,e,o,s),ts("target",l,c,e,i,a),t.set(r.id,r)}}function rs(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:rs(n,t):!1}function os(e,t,n){let r=e;do{if(r?.matches?.(t))return!0;if(r===n)return!1;r=r?.parentElement}while(r);return!1}function wf(e,t,n,r){const o=new Map;for(const[i,s]of e)if((s.selected||s.id===r)&&(!s.parentId||!rs(s,e))&&(s.draggable||t&&typeof s.draggable>"u")){const a=e.get(i);a&&o.set(i,{id:i,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return o}function Pr({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){const o=[];for(const[s,a]of t){const l=n.get(s)?.internals.userNode;l&&o.push({...l,position:a.position,dragging:r})}if(!e)return[o[0],o];const i=n.get(e)?.internals.userNode;return[i?{...i,position:t.get(e)?.position||i.position,dragging:r}:o[0],o]}function bf({dragItems:e,snapGrid:t,x:n,y:r}){const o=e.values().next().value;if(!o)return null;const i={x:n-o.distance.x,y:r-o.distance.y},s=It(i,t);return{x:s.x-i.x,y:s.y-i.y}}function vf({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:o}){let i={x:null,y:null},s=0,a=new Map,l=!1,c={x:0,y:0},h=null,u=!1,d=null,f=!1,m=!1,g=null;function v({noDragClassName:S,handleSelector:p,domNode:b,isSelectable:C,nodeId:E,nodeClickDistance:k=0}){d=ge(b);function P({x:M,y:B}){const{nodeLookup:_,nodeExtent:A,snapGrid:T,snapToGrid:$,nodeOrigin:R,onNodeDrag:D,onSelectionDrag:F,onError:y,updateNodePositions:N}=t();i={x:M,y:B};let j=!1;const H=a.size>1,W=H&&A?kr(Mt(a)):null,X=H&&$?bf({dragItems:a,snapGrid:T,x:M,y:B}):null;for(const[G,V]of a){if(!_.has(G))continue;let Y={x:M-V.distance.x,y:B-V.distance.y};$&&(Y=X?{x:Math.round(Y.x+X.x),y:Math.round(Y.y+X.y)}:It(Y,T));let J=null;if(H&&A&&!V.extent&&W){const{positionAbsolute:Z}=V.internals,ee=Z.x-W.x+A[0][0],oe=Z.x+V.measured.width-W.x2+A[1][0],ie=Z.y-W.y+A[0][1],se=Z.y+V.measured.height-W.y2+A[1][1];J=[[ee,ie],[oe,se]]}const{position:Q,positionAbsolute:U}=Ri({nodeId:G,nextPosition:Y,nodeLookup:_,nodeExtent:J||A,nodeOrigin:R,onError:y});j=j||V.position.x!==Q.x||V.position.y!==Q.y,V.position=Q,V.internals.positionAbsolute=U}if(m=m||j,!!j&&(N(a,!0),g&&(r||D||!E&&F))){const[G,V]=Pr({nodeId:E,dragItems:a,nodeLookup:_});r?.(g,a,G,V),D?.(g,G,V),E||F?.(g,V)}}async function L(){if(!h)return;const{transform:M,panBy:B,autoPanSpeed:_,autoPanOnNodeDrag:A}=t();if(!A){l=!1,cancelAnimationFrame(s);return}const[T,$]=Ii(c,h,_);(T!==0||$!==0)&&(i.x=(i.x??0)-T/M[2],i.y=(i.y??0)-$/M[2],await B({x:T,y:$})&&P(i)),s=requestAnimationFrame(L)}function O(M){const{nodeLookup:B,multiSelectionActive:_,nodesDraggable:A,transform:T,snapGrid:$,snapToGrid:R,selectNodesOnDrag:D,onNodeDragStart:F,onSelectionDragStart:y,unselectNodesAndEdges:N}=t();u=!0,(!D||!C)&&!_&&E&&(B.get(E)?.selected||N()),C&&D&&E&&e?.(E);const j=Lt(M.sourceEvent,{transform:T,snapGrid:$,snapToGrid:R,containerBounds:h});if(i=j,a=wf(B,A,j,E),a.size>0&&(n||F||!E&&y)){const[H,W]=Pr({nodeId:E,dragItems:a,nodeLookup:B});n?.(M.sourceEvent,a,H,W),F?.(M.sourceEvent,H,W),E||y?.(M.sourceEvent,W)}}const z=Yo().clickDistance(k).on("start",M=>{const{domNode:B,nodeDragThreshold:_,transform:A,snapGrid:T,snapToGrid:$}=t();h=B?.getBoundingClientRect()||null,f=!1,m=!1,g=M.sourceEvent,_===0&&O(M),i=Lt(M.sourceEvent,{transform:A,snapGrid:T,snapToGrid:$,containerBounds:h}),c=Ee(M.sourceEvent,h)}).on("drag",M=>{const{autoPanOnNodeDrag:B,transform:_,snapGrid:A,snapToGrid:T,nodeDragThreshold:$,nodeLookup:R}=t(),D=Lt(M.sourceEvent,{transform:_,snapGrid:A,snapToGrid:T,containerBounds:h});if(g=M.sourceEvent,(M.sourceEvent.type==="touchmove"&&M.sourceEvent.touches.length>1||E&&!R.has(E))&&(f=!0),!f){if(!l&&B&&u&&(l=!0,L()),!u){const F=Ee(M.sourceEvent,h),y=F.x-c.x,N=F.y-c.y;Math.sqrt(y*y+N*N)>$&&O(M)}(i.x!==D.xSnapped||i.y!==D.ySnapped)&&a&&u&&(c=Ee(M.sourceEvent,h),P(D))}}).on("end",M=>{if(!(!u||f)&&(l=!1,u=!1,cancelAnimationFrame(s),a.size>0)){const{nodeLookup:B,updateNodePositions:_,onNodeDragStop:A,onSelectionDragStop:T}=t();if(m&&(_(a,!1),m=!1),o||A||!E&&T){const[$,R]=Pr({nodeId:E,dragItems:a,nodeLookup:B,dragging:!1});o?.(M.sourceEvent,a,$,R),A?.(M.sourceEvent,$,R),E||T?.(M.sourceEvent,R)}}}).filter(M=>{const B=M.target;return!M.button&&(!S||!os(B,`.${S}`,b))&&(!p||os(B,p,b))});d.call(z)}function w(){d?.on(".drag",null)}return{update:v,destroy:w}}function _f(e,t,n){const r=[],o={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const i of t.values())$t(o,ot(i))>0&&r.push(i);return r}const Ef=250;function kf(e,t,n,r){let o=[],i=1/0;const s=_f(e,n,t+Ef);for(const a of s){const l=[...a.internals.handleBounds?.source??[],...a.internals.handleBounds?.target??[]];for(const c of l){if(r.nodeId===c.nodeId&&r.type===c.type&&r.id===c.id)continue;const{x:h,y:u}=zt(a,c,c.position,!0),d=Math.sqrt(Math.pow(h-e.x,2)+Math.pow(u-e.y,2));d>t||(d<i?(o=[{...c,x:h,y:u}],i=d):d===i&&o.push({...c,x:h,y:u}))}}if(!o.length)return null;if(o.length>1){const a=r.type==="source"?"target":"source";return o.find(l=>l.type===a)??o[0]}return o[0]}function is(e,t,n,r,o,i=!1){const s=r.get(e);if(!s)return null;const a=o==="strict"?s.internals.handleBounds?.[t]:[...s.internals.handleBounds?.source??[],...s.internals.handleBounds?.target??[]],l=(n?a?.find(c=>c.id===n):a?.[0])??null;return l&&i?{...l,...zt(s,l,l.position,!0)}:l}function ss(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function Nf(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const as=()=>!0;function Sf(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:o,edgeUpdaterType:i,isTarget:s,domNode:a,nodeLookup:l,lib:c,autoPanOnConnect:h,flowId:u,panBy:d,cancelConnection:f,onConnectStart:m,onConnect:g,onConnectEnd:v,isValidConnection:w=as,onReconnectEnd:S,updateConnection:p,getTransform:b,getFromHandle:C,autoPanSpeed:E,dragThreshold:k=1,handleDomNode:P}){const L=Hi(e.target);let O=0,z;const{x:M,y:B}=Ee(e),_=ss(i,P),A=a?.getBoundingClientRect();let T=!1;if(!A||!_)return;const $=is(o,_,r,l,t);if(!$)return;let R=Ee(e,A),D=!1,F=null,y=!1,N=null;function j(){if(!h||!A)return;const[Q,U]=Ii(R,A,E);d({x:Q,y:U}),O=requestAnimationFrame(j)}const H={...$,nodeId:o,type:_,position:$.position},W=l.get(o);let G={inProgress:!0,isValid:null,from:zt(W,H,q.Left,!0),fromHandle:H,fromPosition:H.position,fromNode:W,to:R,toHandle:null,toPosition:Ci[H.position],toNode:null};function V(){T=!0,p(G),m?.(e,{nodeId:o,handleId:r,handleType:_})}k===0&&V();function Y(Q){if(!T){const{x:oe,y:ie}=Ee(Q),se=oe-M,ue=ie-B;if(!(se*se+ue*ue>k*k))return;V()}if(!C()||!H){J(Q);return}const U=b();R=Ee(Q,A),z=kf(Pt(R,U,!1,[1,1]),n,l,H),D||(j(),D=!0);const Z=ls(Q,{handle:z,connectionMode:t,fromNodeId:o,fromHandleId:r,fromType:s?"target":"source",isValidConnection:w,doc:L,lib:c,flowId:u,nodeLookup:l});N=Z.handleDomNode,F=Z.connection,y=Nf(!!z,Z.isValid);const ee={...G,isValid:y,to:Z.toHandle&&y?Nn({x:Z.toHandle.x,y:Z.toHandle.y},U):R,toHandle:Z.toHandle,toPosition:y&&Z.toHandle?Z.toHandle.position:Ci[H.position],toNode:Z.toHandle?l.get(Z.toHandle.nodeId):null};y&&z&&G.toHandle&&ee.toHandle&&G.toHandle.type===ee.toHandle.type&&G.toHandle.nodeId===ee.toHandle.nodeId&&G.toHandle.id===ee.toHandle.id&&G.to.x===ee.to.x&&G.to.y===ee.to.y||(p(ee),G=ee)}function J(Q){if(!("touches"in Q&&Q.touches.length>0)){if(T){(z||N)&&F&&y&&g?.(F);const{inProgress:U,...Z}=G,ee={...Z,toPosition:G.toHandle?G.toPosition:null};v?.(Q,ee),i&&S?.(Q,ee)}f(),cancelAnimationFrame(O),D=!1,y=!1,F=null,N=null,L.removeEventListener("mousemove",Y),L.removeEventListener("mouseup",J),L.removeEventListener("touchmove",Y),L.removeEventListener("touchend",J)}}L.addEventListener("mousemove",Y),L.addEventListener("mouseup",J),L.addEventListener("touchmove",Y),L.addEventListener("touchend",J)}function ls(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:o,fromType:i,doc:s,lib:a,flowId:l,isValidConnection:c=as,nodeLookup:h}){const u=i==="target",d=t?s.querySelector(`.${a}-flow__handle[data-id="${l}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:f,y:m}=Ee(e),g=s.elementFromPoint(f,m),v=g?.classList.contains(`${a}-flow__handle`)?g:d,w={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const S=ss(void 0,v),p=v.getAttribute("data-nodeid"),b=v.getAttribute("data-handleid"),C=v.classList.contains("connectable"),E=v.classList.contains("connectableend");if(!p||!S)return w;const k={source:u?p:r,sourceHandle:u?b:o,target:u?r:p,targetHandle:u?o:b};w.connection=k;const L=C&&E&&(n===nt.Strict?u&&S==="source"||!u&&S==="target":p!==r||b!==o);w.isValid=L&&c(k),w.toHandle=is(p,S,b,h,n,!0)}return w}const Dr={onPointerDown:Sf,isValid:ls};function Cf({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const o=ge(e);function i({translateExtent:a,width:l,height:c,zoomStep:h=1,pannable:u=!0,zoomable:d=!0,inversePan:f=!1}){const m=p=>{if(p.sourceEvent.type!=="wheel"||!t)return;const b=n(),C=p.sourceEvent.ctrlKey&&Dt()?10:1,E=-p.sourceEvent.deltaY*(p.sourceEvent.deltaMode===1?.05:p.sourceEvent.deltaMode?1:.002)*h,k=b[2]*Math.pow(2,E*C);t.scaleTo(k)};let g=[0,0];const v=p=>{(p.sourceEvent.type==="mousedown"||p.sourceEvent.type==="touchstart")&&(g=[p.sourceEvent.clientX??p.sourceEvent.touches[0].clientX,p.sourceEvent.clientY??p.sourceEvent.touches[0].clientY])},w=p=>{const b=n();if(p.sourceEvent.type!=="mousemove"&&p.sourceEvent.type!=="touchmove"||!t)return;const C=[p.sourceEvent.clientX??p.sourceEvent.touches[0].clientX,p.sourceEvent.clientY??p.sourceEvent.touches[0].clientY],E=[C[0]-g[0],C[1]-g[1]];g=C;const k=r()*Math.max(b[2],Math.log(b[2]))*(f?-1:1),P={x:b[0]-E[0]*k,y:b[1]-E[1]*k},L=[[0,0],[l,c]];t.setViewportConstrained({x:P.x,y:P.y,zoom:b[2]},L,a)},S=Ei().on("start",v).on("zoom",u?w:null).on("zoom.wheel",d?m:null);o.call(S,{})}function s(){o.on("zoom",null)}return{update:i,destroy:s,pointer:we}}const Cn=e=>({x:e.x,y:e.y,zoom:e.k}),Lr=({x:e,y:t,zoom:n})=>bn.translate(e,t).scale(n),at=(e,t)=>e.target.closest(`.${t}`),cs=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Tf=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,zr=(e,t=0,n=Tf,r=()=>{})=>{const o=typeof t=="number"&&t>0;return o||r(),o?e.transition().duration(t).ease(n).on("end",r):e},us=e=>{const t=e.ctrlKey&&Dt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function Af({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:o,panOnScrollSpeed:i,zoomOnPinch:s,onPanZoomStart:a,onPanZoom:l,onPanZoomEnd:c}){return h=>{if(at(h,t))return h.ctrlKey&&h.preventDefault(),!1;h.preventDefault(),h.stopImmediatePropagation();const u=n.property("__zoom").k||1;if(h.ctrlKey&&s){const v=we(h),w=us(h),S=u*Math.pow(2,w);r.scaleTo(n,S,v,h);return}const d=h.deltaMode===1?20:1;let f=o===Ue.Vertical?0:h.deltaX*d,m=o===Ue.Horizontal?0:h.deltaY*d;!Dt()&&h.shiftKey&&o!==Ue.Vertical&&(f=h.deltaY*d,m=0),r.translateBy(n,-(f/u)*i,-(m/u)*i,{internal:!0});const g=Cn(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(l?.(h,g),e.panScrollTimeout=setTimeout(()=>{c?.(h,g),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,a?.(h,g))}}function Rf({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,o){const i=r.type==="wheel",s=!t&&i&&!r.ctrlKey,a=at(r,e);if(r.ctrlKey&&i&&a&&r.preventDefault(),s||a)return null;r.preventDefault(),n.call(this,r,o)}}function Mf({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{if(r.sourceEvent?.internal)return;const o=Cn(r.transform);e.mouseButton=r.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=o,r.sourceEvent?.type==="mousedown"&&t(!0),n&&n?.(r.sourceEvent,o)}}function $f({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:o}){return i=>{e.usedRightMouseButton=!!(n&&cs(t,e.mouseButton??0)),i.sourceEvent?.sync||r([i.transform.x,i.transform.y,i.transform.k]),o&&!i.sourceEvent?.internal&&o?.(i.sourceEvent,Cn(i.transform))}}function If({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:o,onPaneContextMenu:i}){return s=>{if(!s.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,i&&cs(t,e.mouseButton??0)&&!e.usedRightMouseButton&&s.sourceEvent&&i(s.sourceEvent),e.usedRightMouseButton=!1,r(!1),o)){const a=Cn(s.transform);e.prevViewport=a,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{o?.(s.sourceEvent,a)},n?150:0)}}}function Pf({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:o,zoomOnDoubleClick:i,userSelectionActive:s,noWheelClassName:a,noPanClassName:l,lib:c,connectionInProgress:h}){return u=>{const d=e||t,f=n&&u.ctrlKey,m=u.type==="wheel";if(u.button===1&&u.type==="mousedown"&&(at(u,`${c}-flow__node`)||at(u,`${c}-flow__edge`)))return!0;if(!r&&!d&&!o&&!i&&!n||s||h&&!m||at(u,a)&&m||at(u,l)&&(!m||o&&m&&!e)||!n&&u.ctrlKey&&m)return!1;if(!n&&u.type==="touchstart"&&u.touches?.length>1)return u.preventDefault(),!1;if(!d&&!o&&!f&&m||!r&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(r)&&!r.includes(u.button)&&u.type==="mousedown")return!1;const g=Array.isArray(r)&&r.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||m)&&g}}function Df({domNode:e,minZoom:t,maxZoom:n,translateExtent:r,viewport:o,onPanZoom:i,onPanZoomStart:s,onPanZoomEnd:a,onDraggingChange:l}){const c={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},h=e.getBoundingClientRect(),u=Ei().scaleExtent([t,n]).translateExtent(r),d=ge(e).call(u);S({x:o.x,y:o.y,zoom:rt(o.zoom,t,n)},[[0,0],[h.width,h.height]],r);const f=d.on("wheel.zoom"),m=d.on("dblclick.zoom");u.wheelDelta(us);function g(z,M){return d?new Promise(B=>{u?.interpolate(M?.interpolate==="linear"?_t:un).transform(zr(d,M?.duration,M?.ease,()=>B(!0)),z)}):Promise.resolve(!1)}function v({noWheelClassName:z,noPanClassName:M,onPaneContextMenu:B,userSelectionActive:_,panOnScroll:A,panOnDrag:T,panOnScrollMode:$,panOnScrollSpeed:R,preventScrolling:D,zoomOnPinch:F,zoomOnScroll:y,zoomOnDoubleClick:N,zoomActivationKeyPressed:j,lib:H,onTransformChange:W,connectionInProgress:X,paneClickDistance:G,selectionOnDrag:V}){_&&!c.isZoomingOrPanning&&w();const Y=A&&!j&&!_;u.clickDistance(V?1/0:!_e(G)||G<0?0:G);const J=Y?Af({zoomPanValues:c,noWheelClassName:z,d3Selection:d,d3Zoom:u,panOnScrollMode:$,panOnScrollSpeed:R,zoomOnPinch:F,onPanZoomStart:s,onPanZoom:i,onPanZoomEnd:a}):Rf({noWheelClassName:z,preventScrolling:D,d3ZoomHandler:f});if(d.on("wheel.zoom",J,{passive:!1}),!_){const U=Mf({zoomPanValues:c,onDraggingChange:l,onPanZoomStart:s});u.on("start",U);const Z=$f({zoomPanValues:c,panOnDrag:T,onPaneContextMenu:!!B,onPanZoom:i,onTransformChange:W});u.on("zoom",Z);const ee=If({zoomPanValues:c,panOnDrag:T,panOnScroll:A,onPaneContextMenu:B,onPanZoomEnd:a,onDraggingChange:l});u.on("end",ee)}const Q=Pf({zoomActivationKeyPressed:j,panOnDrag:T,zoomOnScroll:y,panOnScroll:A,zoomOnDoubleClick:N,zoomOnPinch:F,userSelectionActive:_,noPanClassName:M,noWheelClassName:z,lib:H,connectionInProgress:X});u.filter(Q),N?d.on("dblclick.zoom",m):d.on("dblclick.zoom",null)}function w(){u.on("zoom",null)}async function S(z,M,B){const _=Lr(z),A=u?.constrain()(_,M,B);return A&&await g(A),new Promise(T=>T(A))}async function p(z,M){const B=Lr(z);return await g(B,M),new Promise(_=>_(B))}function b(z){if(d){const M=Lr(z),B=d.property("__zoom");(B.k!==z.zoom||B.x!==z.x||B.y!==z.y)&&u?.transform(d,M,null,{sync:!0})}}function C(){const z=d?vi(d.node()):{x:0,y:0,k:1};return{x:z.x,y:z.y,zoom:z.k}}function E(z,M){return d?new Promise(B=>{u?.interpolate(M?.interpolate==="linear"?_t:un).scaleTo(zr(d,M?.duration,M?.ease,()=>B(!0)),z)}):Promise.resolve(!1)}function k(z,M){return d?new Promise(B=>{u?.interpolate(M?.interpolate==="linear"?_t:un).scaleBy(zr(d,M?.duration,M?.ease,()=>B(!0)),z)}):Promise.resolve(!1)}function P(z){u?.scaleExtent(z)}function L(z){u?.translateExtent(z)}function O(z){const M=!_e(z)||z<0?0:z;u?.clickDistance(M)}return{update:v,destroy:w,setViewport:p,setViewportConstrained:S,getViewport:C,scaleTo:E,scaleBy:k,setScaleExtent:P,setTranslateExtent:L,syncViewport:b,setClickDistance:O}}var lt;(function(e){e.Line="line",e.Handle="handle"})(lt||(lt={}));function Lf({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:o,affectsY:i}){const s=e-t,a=n-r,l=[s>0?1:s<0?-1:0,a>0?1:a<0?-1:0];return s&&o&&(l[0]=l[0]*-1),a&&i&&(l[1]=l[1]*-1),l}function ds(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),o=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:o}}function Oe(e,t){return Math.max(0,t-e)}function je(e,t){return Math.max(0,e-t)}function Tn(e,t,n){return Math.max(0,t-e,e-n)}function hs(e,t){return e?!t:t}function zf(e,t,n,r,o,i,s,a){let{affectsX:l,affectsY:c}=t;const{isHorizontal:h,isVertical:u}=t,d=h&&u,{xSnapped:f,ySnapped:m}=n,{minWidth:g,maxWidth:v,minHeight:w,maxHeight:S}=r,{x:p,y:b,width:C,height:E,aspectRatio:k}=e;let P=Math.floor(h?f-e.pointerX:0),L=Math.floor(u?m-e.pointerY:0);const O=C+(l?-P:P),z=E+(c?-L:L),M=-i[0]*C,B=-i[1]*E;let _=Tn(O,g,v),A=Tn(z,w,S);if(s){let R=0,D=0;l&&P<0?R=Oe(p+P+M,s[0][0]):!l&&P>0&&(R=je(p+O+M,s[1][0])),c&&L<0?D=Oe(b+L+B,s[0][1]):!c&&L>0&&(D=je(b+z+B,s[1][1])),_=Math.max(_,R),A=Math.max(A,D)}if(a){let R=0,D=0;l&&P>0?R=je(p+P,a[0][0]):!l&&P<0&&(R=Oe(p+O,a[1][0])),c&&L>0?D=je(b+L,a[0][1]):!c&&L<0&&(D=Oe(b+z,a[1][1])),_=Math.max(_,R),A=Math.max(A,D)}if(o){if(h){const R=Tn(O/k,w,S)*k;if(_=Math.max(_,R),s){let D=0;!l&&!c||l&&!c&&d?D=je(b+B+O/k,s[1][1])*k:D=Oe(b+B+(l?P:-P)/k,s[0][1])*k,_=Math.max(_,D)}if(a){let D=0;!l&&!c||l&&!c&&d?D=Oe(b+O/k,a[1][1])*k:D=je(b+(l?P:-P)/k,a[0][1])*k,_=Math.max(_,D)}}if(u){const R=Tn(z*k,g,v)/k;if(A=Math.max(A,R),s){let D=0;!l&&!c||c&&!l&&d?D=je(p+z*k+M,s[1][0])/k:D=Oe(p+(c?L:-L)*k+M,s[0][0])/k,A=Math.max(A,D)}if(a){let D=0;!l&&!c||c&&!l&&d?D=Oe(p+z*k,a[1][0])/k:D=je(p+(c?L:-L)*k,a[0][0])/k,A=Math.max(A,D)}}}L=L+(L<0?A:-A),P=P+(P<0?_:-_),o&&(d?O>z*k?L=(hs(l,c)?-P:P)/k:P=(hs(l,c)?-L:L)*k:h?(L=P/k,c=l):(P=L*k,l=c));const T=l?p+P:p,$=c?b+L:b;return{width:C+(l?-P:P),height:E+(c?-L:L),x:i[0]*P*(l?-1:1)+T,y:i[1]*L*(c?-1:1)+$}}const fs={width:0,height:0,x:0,y:0},Bf={...fs,pointerX:0,pointerY:0,aspectRatio:1};function Hf(e){return[[0,0],[e.measured.width,e.measured.height]]}function Of(e,t,n){const r=t.position.x+e.position.x,o=t.position.y+e.position.y,i=e.measured.width??0,s=e.measured.height??0,a=n[0]*i,l=n[1]*s;return[[r-a,o-l],[r+i-a,o+s-l]]}function jf({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:o}){const i=ge(e);let s={controlDirection:ds("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function a({controlPosition:c,boundaries:h,keepAspectRatio:u,resizeDirection:d,onResizeStart:f,onResize:m,onResizeEnd:g,shouldResize:v}){let w={...fs},S={...Bf};s={boundaries:h,resizeDirection:d,keepAspectRatio:u,controlDirection:ds(c)};let p,b=null,C=[],E,k,P,L=!1;const O=Yo().on("start",z=>{const{nodeLookup:M,transform:B,snapGrid:_,snapToGrid:A,nodeOrigin:T,paneDomNode:$}=n();if(p=M.get(t),!p)return;b=$?.getBoundingClientRect()??null;const{xSnapped:R,ySnapped:D}=Lt(z.sourceEvent,{transform:B,snapGrid:_,snapToGrid:A,containerBounds:b});w={width:p.measured.width??0,height:p.measured.height??0,x:p.position.x??0,y:p.position.y??0},S={...w,pointerX:R,pointerY:D,aspectRatio:w.width/w.height},E=void 0,p.parentId&&(p.extent==="parent"||p.expandParent)&&(E=M.get(p.parentId),k=E&&p.extent==="parent"?Hf(E):void 0),C=[],P=void 0;for(const[F,y]of M)if(y.parentId===t&&(C.push({id:F,position:{...y.position},extent:y.extent}),y.extent==="parent"||y.expandParent)){const N=Of(y,p,y.origin??T);P?P=[[Math.min(N[0][0],P[0][0]),Math.min(N[0][1],P[0][1])],[Math.max(N[1][0],P[1][0]),Math.max(N[1][1],P[1][1])]]:P=N}f?.(z,{...w})}).on("drag",z=>{const{transform:M,snapGrid:B,snapToGrid:_,nodeOrigin:A}=n(),T=Lt(z.sourceEvent,{transform:M,snapGrid:B,snapToGrid:_,containerBounds:b}),$=[];if(!p)return;const{x:R,y:D,width:F,height:y}=w,N={},j=p.origin??A,{width:H,height:W,x:X,y:G}=zf(S,s.controlDirection,T,s.boundaries,s.keepAspectRatio,j,k,P),V=H!==F,Y=W!==y,J=X!==R&&V,Q=G!==D&&Y;if(!J&&!Q&&!V&&!Y)return;if((J||Q||j[0]===1||j[1]===1)&&(N.x=J?X:w.x,N.y=Q?G:w.y,w.x=N.x,w.y=N.y,C.length>0)){const oe=X-R,ie=G-D;for(const se of C)se.position={x:se.position.x-oe+j[0]*(H-F),y:se.position.y-ie+j[1]*(W-y)},$.push(se)}if((V||Y)&&(N.width=V&&(!s.resizeDirection||s.resizeDirection==="horizontal")?H:w.width,N.height=Y&&(!s.resizeDirection||s.resizeDirection==="vertical")?W:w.height,w.width=N.width,w.height=N.height),E&&p.expandParent){const oe=j[0]*(N.width??0);N.x&&N.x<oe&&(w.x=oe,S.x=S.x-(N.x-oe));const ie=j[1]*(N.height??0);N.y&&N.y<ie&&(w.y=ie,S.y=S.y-(N.y-ie))}const U=Lf({width:w.width,prevWidth:F,height:w.height,prevHeight:y,affectsX:s.controlDirection.affectsX,affectsY:s.controlDirection.affectsY}),Z={...w,direction:U};v?.(z,Z)!==!1&&(L=!0,m?.(z,Z),r(N,$))}).on("end",z=>{L&&(g?.(z,{...w}),o?.({...w}),L=!1)});i.call(O)}function l(){i.on(".drag",null)}return{update:a,destroy:l}}var Br={exports:{}},Hr={},Or={exports:{}},jr={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ps;function Ff(){if(ps)return jr;ps=1;var e=Vt();function t(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,o=e.useEffect,i=e.useLayoutEffect,s=e.useDebugValue;function a(u,d){var f=d(),m=r({inst:{value:f,getSnapshot:d}}),g=m[0].inst,v=m[1];return i(function(){g.value=f,g.getSnapshot=d,l(g)&&v({inst:g})},[u,f,d]),o(function(){return l(g)&&v({inst:g}),u(function(){l(g)&&v({inst:g})})},[u]),s(f),f}function l(u){var d=u.getSnapshot;u=u.value;try{var f=d();return!n(u,f)}catch{return!0}}function c(u,d){return d()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return jr.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:h,jr}var gs;function Vf(){return gs||(gs=1,Or.exports=Ff()),Or.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ms;function Gf(){if(ms)return Hr;ms=1;var e=Vt(),t=Vf();function n(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}var r=typeof Object.is=="function"?Object.is:n,o=t.useSyncExternalStore,i=e.useRef,s=e.useEffect,a=e.useMemo,l=e.useDebugValue;return Hr.useSyncExternalStoreWithSelector=function(c,h,u,d,f){var m=i(null);if(m.current===null){var g={hasValue:!1,value:null};m.current=g}else g=m.current;m=a(function(){function w(E){if(!S){if(S=!0,p=E,E=d(E),f!==void 0&&g.hasValue){var k=g.value;if(f(k,E))return b=k}return b=E}if(k=b,r(p,E))return k;var P=d(E);return f!==void 0&&f(k,P)?(p=E,k):(p=E,b=P)}var S=!1,p,b,C=u===void 0?null:u;return[function(){return w(h())},C===null?void 0:function(){return w(C())}]},[h,u,d,f]);var v=o(c,m[0],m[1]);return s(function(){g.hasValue=!0,g.value=v},[v]),l(v),v},Hr}var ys;function Xf(){return ys||(ys=1,Br.exports=Gf()),Br.exports}var Wf=Xf();const Yf=eo(Wf),qf={},xs=e=>{let t;const n=new Set,r=(h,u)=>{const d=typeof h=="function"?h(t):h;if(!Object.is(d,t)){const f=t;t=u??(typeof d!="object"||d===null)?d:Object.assign({},t,d),n.forEach(m=>m(t,f))}},o=()=>t,l={setState:r,getState:o,getInitialState:()=>c,subscribe:h=>(n.add(h),()=>n.delete(h)),destroy:()=>{(qf?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=t=e(r,o,l);return l},Uf=e=>e?xs(e):xs,{useDebugValue:Zf}=ll,{useSyncExternalStoreWithSelector:Kf}=Yf,Qf=e=>e;function ws(e,t=Qf,n){const r=Kf(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Zf(r),r}const bs=(e,t)=>{const n=Uf(e),r=(o,i=t)=>ws(n,o,i);return Object.assign(r,n),r},Jf=(e,t)=>e?bs(e,t):bs;function le(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,o]of e)if(!Object.is(o,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}var Fr={exports:{}},de={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vs;function ep(){if(vs)return de;vs=1;var e=Vt();function t(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},o=Symbol.for("react.portal");function i(l,c,h){var u=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:u==null?null:""+u,children:l,containerInfo:c,implementation:h}}var s=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function a(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return de.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,de.createPortal=function(l,c){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(t(299));return i(l,c,null,h)},de.flushSync=function(l){var c=s.T,h=r.p;try{if(s.T=null,r.p=2,l)return l()}finally{s.T=c,r.p=h,r.d.f()}},de.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,r.d.C(l,c))},de.prefetchDNS=function(l){typeof l=="string"&&r.d.D(l)},de.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var h=c.as,u=a(h,c.crossOrigin),d=typeof c.integrity=="string"?c.integrity:void 0,f=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;h==="style"?r.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:u,integrity:d,fetchPriority:f}):h==="script"&&r.d.X(l,{crossOrigin:u,integrity:d,fetchPriority:f,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},de.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var h=a(c.as,c.crossOrigin);r.d.M(l,{crossOrigin:h,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&r.d.M(l)},de.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var h=c.as,u=a(h,c.crossOrigin);r.d.L(l,h,{crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},de.preloadModule=function(l,c){if(typeof l=="string")if(c){var h=a(c.as,c.crossOrigin);r.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:h,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else r.d.m(l)},de.requestFormReset=function(l){r.d.r(l)},de.unstable_batchedUpdates=function(l,c){return l(c)},de.useFormState=function(l,c,h){return s.H.useFormState(l,c,h)},de.useFormStatus=function(){return s.H.useHostTransitionStatus()},de.version="19.2.0",de}var _s;function tp(){if(_s)return Fr.exports;_s=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Fr.exports=ep(),Fr.exports}tp();const An=I.createContext(null),np=An.Provider,Es=Ae.error001();function te(e,t){const n=I.useContext(An);if(n===null)throw new Error(Es);return ws(n,e,t)}function ae(){const e=I.useContext(An);if(e===null)throw new Error(Es);return I.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const ks={display:"none"},rp={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Ns="react-flow__node-desc",Ss="react-flow__edge-desc",op="react-flow__aria-live",ip=e=>e.ariaLiveMessage,sp=e=>e.ariaLabelConfig;function ap({rfId:e}){const t=te(ip);return x.jsx("div",{id:`${op}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:rp,children:t})}function lp({rfId:e,disableKeyboardA11y:t}){const n=te(sp);return x.jsxs(x.Fragment,{children:[x.jsx("div",{id:`${Ns}-${e}`,style:ks,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),x.jsx("div",{id:`${Ss}-${e}`,style:ks,children:n["edge.a11yDescription.default"]}),!t&&x.jsx(ap,{rfId:e})]})}const Rn=I.forwardRef(({position:e="top-left",children:t,className:n,style:r,...o},i)=>{const s=`${e}`.split("-");return x.jsx("div",{className:ce(["react-flow__panel",n,...s]),style:r,ref:i,...o,children:t})});Rn.displayName="Panel";function cp({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:x.jsx(Rn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:x.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const up=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},Mn=e=>e.id;function dp(e,t){return le(e.selectedNodes.map(Mn),t.selectedNodes.map(Mn))&&le(e.selectedEdges.map(Mn),t.selectedEdges.map(Mn))}function hp({onSelectionChange:e}){const t=ae(),{selectedNodes:n,selectedEdges:r}=te(up,dp);return I.useEffect(()=>{const o={nodes:n,edges:r};e?.(o),t.getState().onSelectionChangeHandlers.forEach(i=>i(o))},[n,r,e]),null}const fp=e=>!!e.onSelectionChangeHandlers;function pp({onSelectionChange:e}){const t=te(fp);return e||t?x.jsx(hp,{onSelectionChange:e}):null}const Cs=[0,0],gp={x:0,y:0,zoom:1},Ts=[...["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig"],"rfId"],mp=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),As={translateExtent:Tt,nodeOrigin:Cs,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function yp(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:o,setTranslateExtent:i,setNodeExtent:s,reset:a,setDefaultNodesAndEdges:l}=te(mp,le),c=ae();I.useEffect(()=>(l(e.defaultNodes,e.defaultEdges),()=>{h.current=As,a()}),[]);const h=I.useRef(As);return I.useEffect(()=>{for(const u of Ts){const d=e[u],f=h.current[u];d!==f&&(typeof e[u]>"u"||(u==="nodes"?t(d):u==="edges"?n(d):u==="minZoom"?r(d):u==="maxZoom"?o(d):u==="translateExtent"?i(d):u==="nodeExtent"?s(d):u==="ariaLabelConfig"?c.setState({ariaLabelConfig:Qh(d)}):u==="fitView"?c.setState({fitViewQueued:d}):u==="fitViewOptions"?c.setState({fitViewOptions:d}):c.setState({[u]:d})))}h.current=e},Ts.map(u=>e[u])),null}function Rs(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function xp(e){const[t,n]=I.useState(e==="system"?null:e);return I.useEffect(()=>{if(e!=="system"){n(e);return}const r=Rs(),o=()=>n(r?.matches?"dark":"light");return o(),r?.addEventListener("change",o),()=>{r?.removeEventListener("change",o)}},[e]),t!==null?t:Rs()?.matches?"dark":"light"}const Ms=typeof document<"u"?document:null;function Bt(e=null,t={target:Ms,actInsideInputWithModifier:!0}){const[n,r]=I.useState(!1),o=I.useRef(!1),i=I.useRef(new Set([])),[s,a]=I.useMemo(()=>{if(e!==null){const c=(Array.isArray(e)?e:[e]).filter(u=>typeof u=="string").map(u=>u.replace("+",`
`).replace(`

`,`
+`).split(`
`)),h=c.reduce((u,d)=>u.concat(...d),[]);return[c,h]}return[[],[]]},[e]);return I.useEffect(()=>{const l=t?.target??Ms,c=t?.actInsideInputWithModifier??!0;if(e!==null){const h=f=>{if(o.current=f.ctrlKey||f.metaKey||f.shiftKey||f.altKey,(!o.current||o.current&&!c)&&Oi(f))return!1;const g=Is(f.code,a);if(i.current.add(f[g]),$s(s,i.current,!1)){const v=f.composedPath?.()?.[0]||f.target,w=v?.nodeName==="BUTTON"||v?.nodeName==="A";t.preventDefault!==!1&&(o.current||!w)&&f.preventDefault(),r(!0)}},u=f=>{const m=Is(f.code,a);$s(s,i.current,!0)?(r(!1),i.current.clear()):i.current.delete(f[m]),f.key==="Meta"&&i.current.clear(),o.current=!1},d=()=>{i.current.clear(),r(!1)};return l?.addEventListener("keydown",h),l?.addEventListener("keyup",u),window.addEventListener("blur",d),window.addEventListener("contextmenu",d),()=>{l?.removeEventListener("keydown",h),l?.removeEventListener("keyup",u),window.removeEventListener("blur",d),window.removeEventListener("contextmenu",d)}}},[e,r]),n}function $s(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(o=>t.has(o)))}function Is(e,t){return t.includes(e)?"code":"key"}const wp=()=>{const e=ae();return I.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,o,i],panZoom:s}=e.getState();return s?(await s.setViewport({x:t.x??r,y:t.y??o,zoom:t.zoom??i},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},setCenter:async(t,n,r)=>e.getState().setCenter(t,n,r),fitBounds:async(t,n)=>{const{width:r,height:o,minZoom:i,maxZoom:s,panZoom:a}=e.getState(),l=Nr(t,r,o,i,s,n?.padding??.1);return a?(await a.setViewport(l,{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:r,snapGrid:o,snapToGrid:i,domNode:s}=e.getState();if(!s)return t;const{x:a,y:l}=s.getBoundingClientRect(),c={x:t.x-a,y:t.y-l},h=n.snapGrid??o,u=n.snapToGrid??i;return Pt(c,r,u,h)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:o,y:i}=r.getBoundingClientRect(),s=Nn(t,n);return{x:s.x+o,y:s.y+i}}}),[])};function Ps(e,t){const n=[],r=new Map,o=[];for(const i of e)if(i.type==="add"){o.push(i);continue}else if(i.type==="remove"||i.type==="replace")r.set(i.id,[i]);else{const s=r.get(i.id);s?s.push(i):r.set(i.id,[i])}for(const i of t){const s=r.get(i.id);if(!s){n.push(i);continue}if(s[0].type==="remove")continue;if(s[0].type==="replace"){n.push({...s[0].item});continue}const a={...i};for(const l of s)bp(l,a);n.push(a)}return o.length&&o.forEach(i=>{i.index!==void 0?n.splice(i.index,0,{...i.item}):n.push({...i.item})}),n}function bp(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??={},t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function vp(e,t){return Ps(e,t)}function _p(e,t){return Ps(e,t)}function Ke(e,t){return{id:e,type:"select",selected:t}}function ct(e,t=new Set,n=!1){const r=[];for(const[o,i]of e){const s=t.has(o);!(i.selected===void 0&&!s)&&i.selected!==s&&(n&&(i.selected=s),r.push(Ke(i.id,s)))}return r}function Ds({items:e=[],lookup:t}){const n=[],r=new Map(e.map(o=>[o.id,o]));for(const[o,i]of e.entries()){const s=t.get(i.id),a=s?.internals?.userNode??s;a!==void 0&&a!==i&&n.push({id:i.id,item:i,type:"replace"}),a===void 0&&n.push({item:i,type:"add",index:o})}for(const[o]of t)r.get(o)===void 0&&n.push({id:o,type:"remove"});return n}function Ls(e){return{id:e.id,type:"remove"}}const zs=e=>Fh(e),Ep=e=>Ai(e);function Bs(e){return I.forwardRef(e)}const kp=typeof window<"u"?I.useLayoutEffect:I.useEffect;function Hs(e){const[t,n]=I.useState(BigInt(0)),[r]=I.useState(()=>Np(()=>n(o=>o+BigInt(1))));return kp(()=>{const o=r.get();o.length&&(e(o),r.reset())},[t]),r}function Np(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const Os=I.createContext(null);function Sp({children:e}){const t=ae(),n=I.useCallback(a=>{const{nodes:l=[],setNodes:c,hasDefaultNodes:h,onNodesChange:u,nodeLookup:d,fitViewQueued:f}=t.getState();let m=l;for(const v of a)m=typeof v=="function"?v(m):v;const g=Ds({items:m,lookup:d});h&&c(m),g.length>0?u?.(g):f&&window.requestAnimationFrame(()=>{const{fitViewQueued:v,nodes:w,setNodes:S}=t.getState();v&&S(w)})},[]),r=Hs(n),o=I.useCallback(a=>{const{edges:l=[],setEdges:c,hasDefaultEdges:h,onEdgesChange:u,edgeLookup:d}=t.getState();let f=l;for(const m of a)f=typeof m=="function"?m(f):m;h?c(f):u&&u(Ds({items:f,lookup:d}))},[]),i=Hs(o),s=I.useMemo(()=>({nodeQueue:r,edgeQueue:i}),[]);return x.jsx(Os.Provider,{value:s,children:e})}function Cp(){const e=I.useContext(Os);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const Tp=e=>!!e.panZoom;function Vr(){const e=wp(),t=ae(),n=Cp(),r=te(Tp),o=I.useMemo(()=>{const i=u=>t.getState().nodeLookup.get(u),s=u=>{n.nodeQueue.push(u)},a=u=>{n.edgeQueue.push(u)},l=u=>{const{nodeLookup:d,nodeOrigin:f}=t.getState(),m=zs(u)?u:d.get(u.id),g=m.parentId?zi(m.position,m.measured,m.parentId,d,f):m.position,v={...m,position:g,width:m.measured?.width??m.width,height:m.measured?.height??m.height};return ot(v)},c=(u,d,f={replace:!1})=>{s(m=>m.map(g=>{if(g.id===u){const v=typeof d=="function"?d(g):d;return f.replace&&zs(v)?v:{...g,...v}}return g}))},h=(u,d,f={replace:!1})=>{a(m=>m.map(g=>{if(g.id===u){const v=typeof d=="function"?d(g):d;return f.replace&&Ep(v)?v:{...g,...v}}return g}))};return{getNodes:()=>t.getState().nodes.map(u=>({...u})),getNode:u=>i(u)?.internals.userNode,getInternalNode:i,getEdges:()=>{const{edges:u=[]}=t.getState();return u.map(d=>({...d}))},getEdge:u=>t.getState().edgeLookup.get(u),setNodes:s,setEdges:a,addNodes:u=>{const d=Array.isArray(u)?u:[u];n.nodeQueue.push(f=>[...f,...d])},addEdges:u=>{const d=Array.isArray(u)?u:[u];n.edgeQueue.push(f=>[...f,...d])},toObject:()=>{const{nodes:u=[],edges:d=[],transform:f}=t.getState(),[m,g,v]=f;return{nodes:u.map(w=>({...w})),edges:d.map(w=>({...w})),viewport:{x:m,y:g,zoom:v}}},deleteElements:async({nodes:u=[],edges:d=[]})=>{const{nodes:f,edges:m,onNodesDelete:g,onEdgesDelete:v,triggerNodeChanges:w,triggerEdgeChanges:S,onDelete:p,onBeforeDelete:b}=t.getState(),{nodes:C,edges:E}=await Yh({nodesToRemove:u,edgesToRemove:d,nodes:f,edges:m,onBeforeDelete:b}),k=E.length>0,P=C.length>0;if(k){const L=E.map(Ls);v?.(E),S(L)}if(P){const L=C.map(Ls);g?.(C),w(L)}return(P||k)&&p?.({nodes:C,edges:E}),{deletedNodes:C,deletedEdges:E}},getIntersectingNodes:(u,d=!0,f)=>{const m=Di(u),g=m?u:l(u),v=f!==void 0;return g?(f||t.getState().nodes).filter(w=>{const S=t.getState().nodeLookup.get(w.id);if(S&&!m&&(w.id===u.id||!S.internals.positionAbsolute))return!1;const p=ot(v?w:S),b=$t(p,g);return d&&b>0||b>=p.width*p.height||b>=g.width*g.height}):[]},isNodeIntersecting:(u,d,f=!0)=>{const g=Di(u)?u:l(u);if(!g)return!1;const v=$t(g,d);return f&&v>0||v>=d.width*d.height||v>=g.width*g.height},updateNode:c,updateNodeData:(u,d,f={replace:!1})=>{c(u,m=>{const g=typeof d=="function"?d(m):d;return f.replace?{...m,data:g}:{...m,data:{...m.data,...g}}},f)},updateEdge:h,updateEdgeData:(u,d,f={replace:!1})=>{h(u,m=>{const g=typeof d=="function"?d(m):d;return f.replace?{...m,data:g}:{...m,data:{...m.data,...g}}},f)},getNodesBounds:u=>{const{nodeLookup:d,nodeOrigin:f}=t.getState();return Vh(u,{nodeLookup:d,nodeOrigin:f})},getHandleConnections:({type:u,id:d,nodeId:f})=>Array.from(t.getState().connectionLookup.get(`${f}-${u}${d?`-${d}`:""}`)?.values()??[]),getNodeConnections:({type:u,handleId:d,nodeId:f})=>Array.from(t.getState().connectionLookup.get(`${f}${u?d?`-${u}-${d}`:`-${u}`:""}`)?.values()??[]),fitView:async u=>{const d=t.getState().fitViewResolver??Kh();return t.setState({fitViewQueued:!0,fitViewOptions:u,fitViewResolver:d}),n.nodeQueue.push(f=>[...f]),d.promise}}},[]);return I.useMemo(()=>({...o,...e,viewportInitialized:r}),[r])}const js=e=>e.selected,Ap=typeof window<"u"?window:void 0;function Rp({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=ae(),{deleteElements:r}=Vr(),o=Bt(e,{actInsideInputWithModifier:!1}),i=Bt(t,{target:Ap});I.useEffect(()=>{if(o){const{edges:s,nodes:a}=n.getState();r({nodes:a.filter(js),edges:s.filter(js)}),n.setState({nodesSelectionActive:!1})}},[o]),I.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])}function Mp(e){const t=ae();I.useEffect(()=>{const n=()=>{if(!e.current||!(e.current.checkVisibility?.()??!0))return!1;const r=Sr(e.current);(r.height===0||r.width===0)&&t.getState().onError?.("004",Ae.error004()),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const $n={position:"absolute",width:"100%",height:"100%",top:0,left:0},$p=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function Ip({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:o=.5,panOnScrollMode:i=Ue.Free,zoomOnDoubleClick:s=!0,panOnDrag:a=!0,defaultViewport:l,translateExtent:c,minZoom:h,maxZoom:u,zoomActivationKeyCode:d,preventScrolling:f=!0,children:m,noWheelClassName:g,noPanClassName:v,onViewportChange:w,isControlledViewport:S,paneClickDistance:p,selectionOnDrag:b}){const C=ae(),E=I.useRef(null),{userSelectionActive:k,lib:P,connectionInProgress:L}=te($p,le),O=Bt(d),z=I.useRef();Mp(E);const M=I.useCallback(B=>{w?.({x:B[0],y:B[1],zoom:B[2]}),S||C.setState({transform:B})},[w,S]);return I.useEffect(()=>{if(E.current){z.current=Df({domNode:E.current,minZoom:h,maxZoom:u,translateExtent:c,viewport:l,onDraggingChange:T=>C.setState({paneDragging:T}),onPanZoomStart:(T,$)=>{const{onViewportChangeStart:R,onMoveStart:D}=C.getState();D?.(T,$),R?.($)},onPanZoom:(T,$)=>{const{onViewportChange:R,onMove:D}=C.getState();D?.(T,$),R?.($)},onPanZoomEnd:(T,$)=>{const{onViewportChangeEnd:R,onMoveEnd:D}=C.getState();D?.(T,$),R?.($)}});const{x:B,y:_,zoom:A}=z.current.getViewport();return C.setState({panZoom:z.current,transform:[B,_,A],domNode:E.current.closest(".react-flow")}),()=>{z.current?.destroy()}}},[]),I.useEffect(()=>{z.current?.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:o,panOnScrollMode:i,zoomOnDoubleClick:s,panOnDrag:a,zoomActivationKeyPressed:O,preventScrolling:f,noPanClassName:v,userSelectionActive:k,noWheelClassName:g,lib:P,onTransformChange:M,connectionInProgress:L,selectionOnDrag:b,paneClickDistance:p})},[e,t,n,r,o,i,s,a,O,f,v,k,g,P,M,L,b,p]),x.jsx("div",{className:"react-flow__renderer",ref:E,style:$n,children:m})}const Pp=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Dp(){const{userSelectionActive:e,userSelectionRect:t}=te(Pp,le);return e&&t?x.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const Gr=(e,t)=>n=>{n.target===t.current&&e?.(n)},Lp=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function zp({isSelecting:e,selectionKeyPressed:t,selectionMode:n=At.Full,panOnDrag:r,paneClickDistance:o,selectionOnDrag:i,onSelectionStart:s,onSelectionEnd:a,onPaneClick:l,onPaneContextMenu:c,onPaneScroll:h,onPaneMouseEnter:u,onPaneMouseMove:d,onPaneMouseLeave:f,children:m}){const g=ae(),{userSelectionActive:v,elementsSelectable:w,dragging:S,connectionInProgress:p}=te(Lp,le),b=w&&(e||v),C=I.useRef(null),E=I.useRef(),k=I.useRef(new Set),P=I.useRef(new Set),L=I.useRef(!1),O=R=>{if(L.current||p){L.current=!1;return}l?.(R),g.getState().resetSelectedElements(),g.setState({nodesSelectionActive:!1})},z=R=>{if(Array.isArray(r)&&r?.includes(2)){R.preventDefault();return}c?.(R)},M=h?R=>h(R):void 0,B=R=>{L.current&&(R.stopPropagation(),L.current=!1)},_=R=>{const{resetSelectedElements:D,domNode:F}=g.getState();if(E.current=F?.getBoundingClientRect(),!E.current)return;const y=R.target===C.current;if(!y&&!!R.target.closest(".nokey")||!e||!(i&&y||t)||R.button!==0||!R.isPrimary)return;R.target?.setPointerCapture?.(R.pointerId),L.current=!1;const{x:H,y:W}=Ee(R.nativeEvent,E.current);g.setState({userSelectionRect:{width:0,height:0,startX:H,startY:W,x:H,y:W}}),y||(R.stopPropagation(),R.preventDefault()),(o===0||t)&&(D(),s?.(R),L.current=!0)},A=R=>{const{userSelectionRect:D,transform:F,nodeLookup:y,edgeLookup:N,connectionLookup:j,triggerNodeChanges:H,triggerEdgeChanges:W,defaultEdgeOptions:X,resetSelectedElements:G}=g.getState();if(!E.current||!D)return;const{x:V,y:Y}=Ee(R.nativeEvent,E.current),{startX:J,startY:Q}=D;if(!L.current&&R.target===C.current&&!t&&o>0){if(Math.hypot(V-J,Y-Q)<=o)return;G(),s?.(R)}L.current=!0;const U={startX:J,startY:Q,x:V<J?V:J,y:Y<Q?Y:Q,width:Math.abs(V-J),height:Math.abs(Y-Q)},Z=k.current,ee=P.current;k.current=new Set(Er(y,U,F,n===At.Partial,!0).map(ie=>ie.id)),P.current=new Set;const oe=X?.selectable??!0;for(const ie of k.current){const se=j.get(ie);if(se)for(const{edgeId:ue}of se.values()){const Re=N.get(ue);Re&&(Re.selectable??oe)&&P.current.add(ue)}}if(!Bi(Z,k.current)){const ie=ct(y,k.current,!0);H(ie)}if(!Bi(ee,P.current)){const ie=ct(N,P.current);W(ie)}g.setState({userSelectionRect:U,userSelectionActive:!0,nodesSelectionActive:!1})},T=R=>{R.button===0&&(R.target?.releasePointerCapture?.(R.pointerId),!v&&R.target===C.current&&g.getState().userSelectionRect&&O?.(R),g.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:k.current.size>0}),L.current&&a?.(R))},$=r===!0||Array.isArray(r)&&r.includes(0);return x.jsxs("div",{className:ce(["react-flow__pane",{draggable:$,dragging:S,selection:e}]),onClick:b?void 0:Gr(O,C),onContextMenu:Gr(z,C),onWheel:Gr(M,C),onPointerEnter:b?void 0:u,onPointerMove:b?A:d,onPointerUp:b?T:void 0,onPointerDownCapture:b?_:void 0,onClickCapture:b?B:void 0,onPointerLeave:f,ref:C,style:$n,children:[m,x.jsx(Dp,{})]})}function Xr({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:o,unselectNodesAndEdges:i,multiSelectionActive:s,nodeLookup:a,onError:l}=t.getState(),c=a.get(e);if(!c){l?.("012",Ae.error012(e));return}t.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&s)&&(i({nodes:[c],edges:[]}),requestAnimationFrame(()=>r?.current?.blur())):o([e])}function Fs({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:o,isSelectable:i,nodeClickDistance:s}){const a=ae(),[l,c]=I.useState(!1),h=I.useRef();return I.useEffect(()=>{h.current=vf({getStoreItems:()=>a.getState(),onNodeMouseDown:u=>{Xr({id:u,store:a,nodeRef:e})},onDragStart:()=>{c(!0)},onDragStop:()=>{c(!1)}})},[]),I.useEffect(()=>{if(t)h.current?.destroy();else if(e.current)return h.current?.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:i,nodeId:o,nodeClickDistance:s}),()=>{h.current?.destroy()}},[n,r,t,i,e,o]),l}const Bp=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Vs(){const e=ae();return I.useCallback(n=>{const{nodeExtent:r,snapToGrid:o,snapGrid:i,nodesDraggable:s,onError:a,updateNodePositions:l,nodeLookup:c,nodeOrigin:h}=e.getState(),u=new Map,d=Bp(s),f=o?i[0]:5,m=o?i[1]:5,g=n.direction.x*f*n.factor,v=n.direction.y*m*n.factor;for(const[,w]of c){if(!d(w))continue;let S={x:w.internals.positionAbsolute.x+g,y:w.internals.positionAbsolute.y+v};o&&(S=It(S,i));const{position:p,positionAbsolute:b}=Ri({nodeId:w.id,nextPosition:S,nodeLookup:c,nodeExtent:r,nodeOrigin:h,onError:a});w.position=p,w.internals.positionAbsolute=b,u.set(w.id,w)}l(u)},[])}const Wr=I.createContext(null),Hp=Wr.Provider;Wr.Consumer;const Gs=()=>I.useContext(Wr),Op=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),jp=(e,t,n)=>r=>{const{connectionClickStartHandle:o,connectionMode:i,connection:s}=r,{fromHandle:a,toHandle:l,isValid:c}=s,h=l?.nodeId===e&&l?.id===t&&l?.type===n;return{connectingFrom:a?.nodeId===e&&a?.id===t&&a?.type===n,connectingTo:h,clickConnecting:o?.nodeId===e&&o?.id===t&&o?.type===n,isPossibleEndHandle:i===nt.Strict?a?.type!==n:e!==a?.nodeId||t!==a?.id,connectionInProcess:!!a,clickConnectionInProcess:!!o,valid:h&&c}};function Fp({type:e="source",position:t=q.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:o=!0,isConnectableEnd:i=!0,id:s,onConnect:a,children:l,className:c,onMouseDown:h,onTouchStart:u,...d},f){const m=s||null,g=e==="target",v=ae(),w=Gs(),{connectOnClick:S,noPanClassName:p,rfId:b}=te(Op,le),{connectingFrom:C,connectingTo:E,clickConnecting:k,isPossibleEndHandle:P,connectionInProcess:L,clickConnectionInProcess:O,valid:z}=te(jp(w,m,e),le);w||v.getState().onError?.("010",Ae.error010());const M=A=>{const{defaultEdgeOptions:T,onConnect:$,hasDefaultEdges:R}=v.getState(),D={...T,...A};if(R){const{edges:F,setEdges:y}=v.getState();y(of(D,F))}$?.(D),a?.(D)},B=A=>{if(!w)return;const T=ji(A.nativeEvent);if(o&&(T&&A.button===0||!T)){const $=v.getState();Dr.onPointerDown(A.nativeEvent,{handleDomNode:A.currentTarget,autoPanOnConnect:$.autoPanOnConnect,connectionMode:$.connectionMode,connectionRadius:$.connectionRadius,domNode:$.domNode,nodeLookup:$.nodeLookup,lib:$.lib,isTarget:g,handleId:m,nodeId:w,flowId:$.rfId,panBy:$.panBy,cancelConnection:$.cancelConnection,onConnectStart:$.onConnectStart,onConnectEnd:$.onConnectEnd,updateConnection:$.updateConnection,onConnect:M,isValidConnection:n||$.isValidConnection,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,autoPanSpeed:$.autoPanSpeed,dragThreshold:$.connectionDragThreshold})}T?h?.(A):u?.(A)},_=A=>{const{onClickConnectStart:T,onClickConnectEnd:$,connectionClickStartHandle:R,connectionMode:D,isValidConnection:F,lib:y,rfId:N,nodeLookup:j,connection:H}=v.getState();if(!w||!R&&!o)return;if(!R){T?.(A.nativeEvent,{nodeId:w,handleId:m,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:w,type:e,id:m}});return}const W=Hi(A.target),X=n||F,{connection:G,isValid:V}=Dr.isValid(A.nativeEvent,{handle:{nodeId:w,id:m,type:e},connectionMode:D,fromNodeId:R.nodeId,fromHandleId:R.id||null,fromType:R.type,isValidConnection:X,flowId:N,doc:W,lib:y,nodeLookup:j});V&&G&&M(G);const Y=structuredClone(H);delete Y.inProgress,Y.toPosition=Y.toHandle?Y.toHandle.position:null,$?.(A,Y),v.setState({connectionClickStartHandle:null})};return x.jsx("div",{"data-handleid":m,"data-nodeid":w,"data-handlepos":t,"data-id":`${b}-${w}-${m}-${e}`,className:ce(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",p,c,{source:!g,target:g,connectable:r,connectablestart:o,connectableend:i,clickconnecting:k,connectingfrom:C,connectingto:E,valid:z,connectionindicator:r&&(!L||P)&&(L||O?i:o)}]),onMouseDown:B,onTouchStart:B,onClick:S?_:void 0,ref:f,...d,children:l})}const ke=I.memo(Bs(Fp));function Vp({data:e,isConnectable:t,sourcePosition:n=q.Bottom}){return x.jsxs(x.Fragment,{children:[e?.label,x.jsx(ke,{type:"source",position:n,isConnectable:t})]})}function Gp({data:e,isConnectable:t,targetPosition:n=q.Top,sourcePosition:r=q.Bottom}){return x.jsxs(x.Fragment,{children:[x.jsx(ke,{type:"target",position:n,isConnectable:t}),e?.label,x.jsx(ke,{type:"source",position:r,isConnectable:t})]})}function Xp(){return null}function Wp({data:e,isConnectable:t,targetPosition:n=q.Top}){return x.jsxs(x.Fragment,{children:[x.jsx(ke,{type:"target",position:n,isConnectable:t}),e?.label]})}const In={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Xs={input:Vp,default:Gp,output:Wp,group:Xp};function Yp(e){return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??e.style?.width,height:e.height??e.initialHeight??e.style?.height}:{width:e.width??e.style?.width,height:e.height??e.style?.height}}const qp=e=>{const{width:t,height:n,x:r,y:o}=Mt(e.nodeLookup,{filter:i=>!!i.selected});return{width:_e(t)?t:null,height:_e(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${o}px)`}};function Up({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=ae(),{width:o,height:i,transformString:s,userSelectionActive:a}=te(qp,le),l=Vs(),c=I.useRef(null);if(I.useEffect(()=>{n||c.current?.focus({preventScroll:!0})},[n]),Fs({nodeRef:c}),a||!o||!i)return null;const h=e?d=>{const f=r.getState().nodes.filter(m=>m.selected);e(d,f)}:void 0,u=d=>{Object.prototype.hasOwnProperty.call(In,d.key)&&(d.preventDefault(),l({direction:In[d.key],factor:d.shiftKey?4:1}))};return x.jsx("div",{className:ce(["react-flow__nodesselection","react-flow__container",t]),style:{transform:s},children:x.jsx("div",{ref:c,className:"react-flow__nodesselection-rect",onContextMenu:h,tabIndex:n?void 0:-1,onKeyDown:n?void 0:u,style:{width:o,height:i}})})}const Ws=typeof window<"u"?window:void 0,Zp=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Ys({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,paneClickDistance:a,deleteKeyCode:l,selectionKeyCode:c,selectionOnDrag:h,selectionMode:u,onSelectionStart:d,onSelectionEnd:f,multiSelectionKeyCode:m,panActivationKeyCode:g,zoomActivationKeyCode:v,elementsSelectable:w,zoomOnScroll:S,zoomOnPinch:p,panOnScroll:b,panOnScrollSpeed:C,panOnScrollMode:E,zoomOnDoubleClick:k,panOnDrag:P,defaultViewport:L,translateExtent:O,minZoom:z,maxZoom:M,preventScrolling:B,onSelectionContextMenu:_,noWheelClassName:A,noPanClassName:T,disableKeyboardA11y:$,onViewportChange:R,isControlledViewport:D}){const{nodesSelectionActive:F,userSelectionActive:y}=te(Zp),N=Bt(c,{target:Ws}),j=Bt(g,{target:Ws}),H=j||P,W=j||b,X=h&&H!==!0,G=N||y||X;return Rp({deleteKeyCode:l,multiSelectionKeyCode:m}),x.jsx(Ip,{onPaneContextMenu:i,elementsSelectable:w,zoomOnScroll:S,zoomOnPinch:p,panOnScroll:W,panOnScrollSpeed:C,panOnScrollMode:E,zoomOnDoubleClick:k,panOnDrag:!N&&H,defaultViewport:L,translateExtent:O,minZoom:z,maxZoom:M,zoomActivationKeyCode:v,preventScrolling:B,noWheelClassName:A,noPanClassName:T,onViewportChange:R,isControlledViewport:D,paneClickDistance:a,selectionOnDrag:X,children:x.jsxs(zp,{onSelectionStart:d,onSelectionEnd:f,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,panOnDrag:H,isSelecting:!!G,selectionMode:u,selectionKeyPressed:N,paneClickDistance:a,selectionOnDrag:X,children:[e,F&&x.jsx(Up,{onSelectionContextMenu:_,noPanClassName:T,disableKeyboardA11y:$})]})})}Ys.displayName="FlowRenderer";const Kp=I.memo(Ys),Qp=e=>t=>e?Er(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Jp(e){return te(I.useCallback(Qp(e),[e]),le)}const eg=e=>e.updateNodeInternals;function tg(){const e=te(eg),[t]=I.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(o=>{const i=o.target.getAttribute("data-id");r.set(i,{id:i,nodeElement:o.target,force:!0})}),e(r)}));return I.useEffect(()=>()=>{t?.disconnect()},[t]),t}function ng({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const o=ae(),i=I.useRef(null),s=I.useRef(null),a=I.useRef(e.sourcePosition),l=I.useRef(e.targetPosition),c=I.useRef(t),h=n&&!!e.internals.handleBounds;return I.useEffect(()=>{i.current&&!e.hidden&&(!h||s.current!==i.current)&&(s.current&&r?.unobserve(s.current),r?.observe(i.current),s.current=i.current)},[h,e.hidden]),I.useEffect(()=>()=>{s.current&&(r?.unobserve(s.current),s.current=null)},[]),I.useEffect(()=>{if(i.current){const u=c.current!==t,d=a.current!==e.sourcePosition,f=l.current!==e.targetPosition;(u||d||f)&&(c.current=t,a.current=e.sourcePosition,l.current=e.targetPosition,o.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:i.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),i}function rg({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:o,onContextMenu:i,onDoubleClick:s,nodesDraggable:a,elementsSelectable:l,nodesConnectable:c,nodesFocusable:h,resizeObserver:u,noDragClassName:d,noPanClassName:f,disableKeyboardA11y:m,rfId:g,nodeTypes:v,nodeClickDistance:w,onError:S}){const{node:p,internals:b,isParent:C}=te(V=>{const Y=V.nodeLookup.get(e),J=V.parentLookup.has(e);return{node:Y,internals:Y.internals,isParent:J}},le);let E=p.type||"default",k=v?.[E]||Xs[E];k===void 0&&(S?.("003",Ae.error003(E)),E="default",k=v?.default||Xs.default);const P=!!(p.draggable||a&&typeof p.draggable>"u"),L=!!(p.selectable||l&&typeof p.selectable>"u"),O=!!(p.connectable||c&&typeof p.connectable>"u"),z=!!(p.focusable||h&&typeof p.focusable>"u"),M=ae(),B=Li(p),_=ng({node:p,nodeType:E,hasDimensions:B,resizeObserver:u}),A=Fs({nodeRef:_,disabled:p.hidden||!P,noDragClassName:d,handleSelector:p.dragHandle,nodeId:e,isSelectable:L,nodeClickDistance:w}),T=Vs();if(p.hidden)return null;const $=Pe(p),R=Yp(p),D=L||P||t||n||r||o,F=n?V=>n(V,{...b.userNode}):void 0,y=r?V=>r(V,{...b.userNode}):void 0,N=o?V=>o(V,{...b.userNode}):void 0,j=i?V=>i(V,{...b.userNode}):void 0,H=s?V=>s(V,{...b.userNode}):void 0,W=V=>{const{selectNodesOnDrag:Y,nodeDragThreshold:J}=M.getState();L&&(!Y||!P||J>0)&&Xr({id:e,store:M,nodeRef:_}),t&&t(V,{...b.userNode})},X=V=>{if(!(Oi(V.nativeEvent)||m)){if(ki.includes(V.key)&&L){const Y=V.key==="Escape";Xr({id:e,store:M,unselect:Y,nodeRef:_})}else if(P&&p.selected&&Object.prototype.hasOwnProperty.call(In,V.key)){V.preventDefault();const{ariaLabelConfig:Y}=M.getState();M.setState({ariaLiveMessage:Y["node.a11yDescription.ariaLiveMessage"]({direction:V.key.replace("Arrow","").toLowerCase(),x:~~b.positionAbsolute.x,y:~~b.positionAbsolute.y})}),T({direction:In[V.key],factor:V.shiftKey?4:1})}}},G=()=>{if(m||!_.current?.matches(":focus-visible"))return;const{transform:V,width:Y,height:J,autoPanOnNodeFocus:Q,setCenter:U}=M.getState();if(!Q)return;Er(new Map([[e,p]]),{x:0,y:0,width:Y,height:J},V,!0).length>0||U(p.position.x+$.width/2,p.position.y+$.height/2,{zoom:V[2]})};return x.jsx("div",{className:ce(["react-flow__node",`react-flow__node-${E}`,{[f]:P},p.className,{selected:p.selected,selectable:L,parent:C,draggable:P,dragging:A}]),ref:_,style:{zIndex:b.z,transform:`translate(${b.positionAbsolute.x}px,${b.positionAbsolute.y}px)`,pointerEvents:D?"all":"none",visibility:B?"visible":"hidden",...p.style,...R},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:F,onMouseMove:y,onMouseLeave:N,onContextMenu:j,onClick:W,onDoubleClick:H,onKeyDown:z?X:void 0,tabIndex:z?0:void 0,onFocus:z?G:void 0,role:p.ariaRole??(z?"group":void 0),"aria-roledescription":"node","aria-describedby":m?void 0:`${Ns}-${g}`,"aria-label":p.ariaLabel,...p.domAttributes,children:x.jsx(Hp,{value:e,children:x.jsx(k,{id:e,data:p.data,type:E,positionAbsoluteX:b.positionAbsolute.x,positionAbsoluteY:b.positionAbsolute.y,selected:p.selected??!1,selectable:L,draggable:P,deletable:p.deletable??!0,isConnectable:O,sourcePosition:p.sourcePosition,targetPosition:p.targetPosition,dragging:A,dragHandle:p.dragHandle,zIndex:b.z,parentId:p.parentId,...$})})})}var og=I.memo(rg);const ig=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function qs(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,onError:i}=te(ig,le),s=Jp(e.onlyRenderVisibleElements),a=tg();return x.jsx("div",{className:"react-flow__nodes",style:$n,children:s.map(l=>x.jsx(og,{id:l,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,nodeClickDistance:e.nodeClickDistance,onError:i},l))})}qs.displayName="NodeRenderer";const sg=I.memo(qs);function ag(e){return te(I.useCallback(n=>{if(!e)return n.edges.map(o=>o.id);const r=[];if(n.width&&n.height)for(const o of n.edges){const i=n.nodeLookup.get(o.source),s=n.nodeLookup.get(o.target);i&&s&&tf({sourceNode:i,targetNode:s,width:n.width,height:n.height,transform:n.transform})&&r.push(o.id)}return r},[e]),le)}const lg=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e}};return x.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},cg=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e,fill:e}};return x.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},Us={[vn.Arrow]:lg,[vn.ArrowClosed]:cg};function ug(e){const t=ae();return I.useMemo(()=>Object.prototype.hasOwnProperty.call(Us,e)?Us[e]:(t.getState().onError?.("009",Ae.error009(e)),null),[e])}const dg=({id:e,type:t,color:n,width:r=12.5,height:o=12.5,markerUnits:i="strokeWidth",strokeWidth:s,orient:a="auto-start-reverse"})=>{const l=ug(t);return l?x.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0",children:x.jsx(l,{color:n,strokeWidth:s})}):null},Zs=({defaultColor:e,rfId:t})=>{const n=te(i=>i.edges),r=te(i=>i.defaultEdgeOptions),o=I.useMemo(()=>uf(n,{id:t,defaultColor:e,defaultMarkerStart:r?.markerStart,defaultMarkerEnd:r?.markerEnd}),[n,r,t,e]);return o.length?x.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:x.jsx("defs",{children:o.map(i=>x.jsx(dg,{id:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient},i.id))})}):null};Zs.displayName="MarkerDefinitions";var hg=I.memo(Zs);function Ks({x:e,y:t,label:n,labelStyle:r,labelShowBg:o=!0,labelBgStyle:i,labelBgPadding:s=[2,4],labelBgBorderRadius:a=2,children:l,className:c,...h}){const[u,d]=I.useState({x:1,y:0,width:0,height:0}),f=ce(["react-flow__edge-textwrapper",c]),m=I.useRef(null);return I.useEffect(()=>{if(m.current){const g=m.current.getBBox();d({x:g.x,y:g.y,width:g.width,height:g.height})}},[n]),n?x.jsxs("g",{transform:`translate(${e-u.width/2} ${t-u.height/2})`,className:f,visibility:u.width?"visible":"hidden",...h,children:[o&&x.jsx("rect",{width:u.width+2*s[0],x:-s[0],y:-s[1],height:u.height+2*s[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),x.jsx("text",{className:"react-flow__edge-text",y:u.height/2,dy:"0.3em",ref:m,style:r,children:n}),l]}):null}Ks.displayName="EdgeText";const fg=I.memo(Ks);function Pn({path:e,labelX:t,labelY:n,label:r,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:l,interactionWidth:c=20,...h}){return x.jsxs(x.Fragment,{children:[x.jsx("path",{...h,d:e,fill:"none",className:ce(["react-flow__edge-path",h.className])}),c?x.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:c,className:"react-flow__edge-interaction"}):null,r&&_e(t)&&_e(n)?x.jsx(fg,{x:t,y:n,label:r,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:l}):null]})}function Qs({pos:e,x1:t,y1:n,x2:r,y2:o}){return e===q.Left||e===q.Right?[.5*(t+r),n]:[t,.5*(n+o)]}function Js({sourceX:e,sourceY:t,sourcePosition:n=q.Bottom,targetX:r,targetY:o,targetPosition:i=q.Top}){const[s,a]=Qs({pos:n,x1:e,y1:t,x2:r,y2:o}),[l,c]=Qs({pos:i,x1:r,y1:o,x2:e,y2:t}),[h,u,d,f]=Vi({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:s,sourceControlY:a,targetControlX:l,targetControlY:c});return[`M${e},${t} C${s},${a} ${l},${c} ${r},${o}`,h,u,d,f]}function ea(e){return I.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,sourcePosition:s,targetPosition:a,label:l,labelStyle:c,labelShowBg:h,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:m,markerEnd:g,markerStart:v,interactionWidth:w})=>{const[S,p,b]=Js({sourceX:n,sourceY:r,sourcePosition:s,targetX:o,targetY:i,targetPosition:a}),C=e.isInternal?void 0:t;return x.jsx(Pn,{id:C,path:S,labelX:p,labelY:b,label:l,labelStyle:c,labelShowBg:h,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:m,markerEnd:g,markerStart:v,interactionWidth:w})})}const pg=ea({isInternal:!1}),ta=ea({isInternal:!0});pg.displayName="SimpleBezierEdge",ta.displayName="SimpleBezierEdgeInternal";function na(e){return I.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:h,labelBgBorderRadius:u,style:d,sourcePosition:f=q.Bottom,targetPosition:m=q.Top,markerEnd:g,markerStart:v,pathOptions:w,interactionWidth:S})=>{const[p,b,C]=Cr({sourceX:n,sourceY:r,sourcePosition:f,targetX:o,targetY:i,targetPosition:m,borderRadius:w?.borderRadius,offset:w?.offset,stepPosition:w?.stepPosition}),E=e.isInternal?void 0:t;return x.jsx(Pn,{id:E,path:p,labelX:b,labelY:C,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:h,labelBgBorderRadius:u,style:d,markerEnd:g,markerStart:v,interactionWidth:S})})}const ra=na({isInternal:!1}),oa=na({isInternal:!0});ra.displayName="SmoothStepEdge",oa.displayName="SmoothStepEdgeInternal";function ia(e){return I.memo(({id:t,...n})=>{const r=e.isInternal?void 0:t;return x.jsx(ra,{...n,id:r,pathOptions:I.useMemo(()=>({borderRadius:0,offset:n.pathOptions?.offset}),[n.pathOptions?.offset])})})}const gg=ia({isInternal:!1}),sa=ia({isInternal:!0});gg.displayName="StepEdge",sa.displayName="StepEdgeInternal";function aa(e){return I.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:h,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:m,interactionWidth:g})=>{const[v,w,S]=Yi({sourceX:n,sourceY:r,targetX:o,targetY:i}),p=e.isInternal?void 0:t;return x.jsx(Pn,{id:p,path:v,labelX:w,labelY:S,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:h,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:m,interactionWidth:g})})}const mg=aa({isInternal:!1}),la=aa({isInternal:!0});mg.displayName="StraightEdge",la.displayName="StraightEdgeInternal";function ca(e){return I.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,sourcePosition:s=q.Bottom,targetPosition:a=q.Top,label:l,labelStyle:c,labelShowBg:h,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:m,markerEnd:g,markerStart:v,pathOptions:w,interactionWidth:S})=>{const[p,b,C]=Xi({sourceX:n,sourceY:r,sourcePosition:s,targetX:o,targetY:i,targetPosition:a,curvature:w?.curvature}),E=e.isInternal?void 0:t;return x.jsx(Pn,{id:E,path:p,labelX:b,labelY:C,label:l,labelStyle:c,labelShowBg:h,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:m,markerEnd:g,markerStart:v,interactionWidth:S})})}const yg=ca({isInternal:!1}),ua=ca({isInternal:!0});yg.displayName="BezierEdge",ua.displayName="BezierEdgeInternal";const da={default:ua,straight:la,step:sa,smoothstep:oa,simplebezier:ta},ha={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},xg=(e,t,n)=>n===q.Left?e-t:n===q.Right?e+t:e,wg=(e,t,n)=>n===q.Top?e-t:n===q.Bottom?e+t:e,fa="react-flow__edgeupdater";function pa({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:o,onMouseEnter:i,onMouseOut:s,type:a}){return x.jsx("circle",{onMouseDown:o,onMouseEnter:i,onMouseOut:s,className:ce([fa,`${fa}-${a}`]),cx:xg(t,r,e),cy:wg(n,r,e),r,stroke:"transparent",fill:"transparent"})}function bg({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:o,targetX:i,targetY:s,sourcePosition:a,targetPosition:l,onReconnect:c,onReconnectStart:h,onReconnectEnd:u,setReconnecting:d,setUpdateHover:f}){const m=ae(),g=(b,C)=>{if(b.button!==0)return;const{autoPanOnConnect:E,domNode:k,isValidConnection:P,connectionMode:L,connectionRadius:O,lib:z,onConnectStart:M,onConnectEnd:B,cancelConnection:_,nodeLookup:A,rfId:T,panBy:$,updateConnection:R}=m.getState(),D=C.type==="target",F=(j,H)=>{d(!1),u?.(j,n,C.type,H)},y=j=>c?.(n,j),N=(j,H)=>{d(!0),h?.(b,n,C.type),M?.(j,H)};Dr.onPointerDown(b.nativeEvent,{autoPanOnConnect:E,connectionMode:L,connectionRadius:O,domNode:k,handleId:C.id,nodeId:C.nodeId,nodeLookup:A,isTarget:D,edgeUpdaterType:C.type,lib:z,flowId:T,cancelConnection:_,panBy:$,isValidConnection:P,onConnect:y,onConnectStart:N,onConnectEnd:B,onReconnectEnd:F,updateConnection:R,getTransform:()=>m.getState().transform,getFromHandle:()=>m.getState().connection.fromHandle,dragThreshold:m.getState().connectionDragThreshold,handleDomNode:b.currentTarget})},v=b=>g(b,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),w=b=>g(b,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),S=()=>f(!0),p=()=>f(!1);return x.jsxs(x.Fragment,{children:[(e===!0||e==="source")&&x.jsx(pa,{position:a,centerX:r,centerY:o,radius:t,onMouseDown:v,onMouseEnter:S,onMouseOut:p,type:"source"}),(e===!0||e==="target")&&x.jsx(pa,{position:l,centerX:i,centerY:s,radius:t,onMouseDown:w,onMouseEnter:S,onMouseOut:p,type:"target"})]})}function vg({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:o,onDoubleClick:i,onContextMenu:s,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,reconnectRadius:h,onReconnect:u,onReconnectStart:d,onReconnectEnd:f,rfId:m,edgeTypes:g,noPanClassName:v,onError:w,disableKeyboardA11y:S}){let p=te(U=>U.edgeLookup.get(e));const b=te(U=>U.defaultEdgeOptions);p=b?{...b,...p}:p;let C=p.type||"default",E=g?.[C]||da[C];E===void 0&&(w?.("011",Ae.error011(C)),C="default",E=g?.default||da.default);const k=!!(p.focusable||t&&typeof p.focusable>"u"),P=typeof u<"u"&&(p.reconnectable||n&&typeof p.reconnectable>"u"),L=!!(p.selectable||r&&typeof p.selectable>"u"),O=I.useRef(null),[z,M]=I.useState(!1),[B,_]=I.useState(!1),A=ae(),{zIndex:T,sourceX:$,sourceY:R,targetX:D,targetY:F,sourcePosition:y,targetPosition:N}=te(I.useCallback(U=>{const Z=U.nodeLookup.get(p.source),ee=U.nodeLookup.get(p.target);if(!Z||!ee)return{zIndex:p.zIndex,...ha};const oe=cf({id:e,sourceNode:Z,targetNode:ee,sourceHandle:p.sourceHandle||null,targetHandle:p.targetHandle||null,connectionMode:U.connectionMode,onError:w});return{zIndex:ef({selected:p.selected,zIndex:p.zIndex,sourceNode:Z,targetNode:ee,elevateOnSelect:U.elevateEdgesOnSelect}),...oe||ha}},[p.source,p.target,p.sourceHandle,p.targetHandle,p.selected,p.zIndex]),le),j=I.useMemo(()=>p.markerStart?`url('#${Tr(p.markerStart,m)}')`:void 0,[p.markerStart,m]),H=I.useMemo(()=>p.markerEnd?`url('#${Tr(p.markerEnd,m)}')`:void 0,[p.markerEnd,m]);if(p.hidden||$===null||R===null||D===null||F===null)return null;const W=U=>{const{addSelectedEdges:Z,unselectNodesAndEdges:ee,multiSelectionActive:oe}=A.getState();L&&(A.setState({nodesSelectionActive:!1}),p.selected&&oe?(ee({nodes:[],edges:[p]}),O.current?.blur()):Z([e])),o&&o(U,p)},X=i?U=>{i(U,{...p})}:void 0,G=s?U=>{s(U,{...p})}:void 0,V=a?U=>{a(U,{...p})}:void 0,Y=l?U=>{l(U,{...p})}:void 0,J=c?U=>{c(U,{...p})}:void 0,Q=U=>{if(!S&&ki.includes(U.key)&&L){const{unselectNodesAndEdges:Z,addSelectedEdges:ee}=A.getState();U.key==="Escape"?(O.current?.blur(),Z({edges:[p]})):ee([e])}};return x.jsx("svg",{style:{zIndex:T},children:x.jsxs("g",{className:ce(["react-flow__edge",`react-flow__edge-${C}`,p.className,v,{selected:p.selected,animated:p.animated,inactive:!L&&!o,updating:z,selectable:L}]),onClick:W,onDoubleClick:X,onContextMenu:G,onMouseEnter:V,onMouseMove:Y,onMouseLeave:J,onKeyDown:k?Q:void 0,tabIndex:k?0:void 0,role:p.ariaRole??(k?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":p.ariaLabel===null?void 0:p.ariaLabel||`Edge from ${p.source} to ${p.target}`,"aria-describedby":k?`${Ss}-${m}`:void 0,ref:O,...p.domAttributes,children:[!B&&x.jsx(E,{id:e,source:p.source,target:p.target,type:p.type,selected:p.selected,animated:p.animated,selectable:L,deletable:p.deletable??!0,label:p.label,labelStyle:p.labelStyle,labelShowBg:p.labelShowBg,labelBgStyle:p.labelBgStyle,labelBgPadding:p.labelBgPadding,labelBgBorderRadius:p.labelBgBorderRadius,sourceX:$,sourceY:R,targetX:D,targetY:F,sourcePosition:y,targetPosition:N,data:p.data,style:p.style,sourceHandleId:p.sourceHandle,targetHandleId:p.targetHandle,markerStart:j,markerEnd:H,pathOptions:"pathOptions"in p?p.pathOptions:void 0,interactionWidth:p.interactionWidth}),P&&x.jsx(bg,{edge:p,isReconnectable:P,reconnectRadius:h,onReconnect:u,onReconnectStart:d,onReconnectEnd:f,sourceX:$,sourceY:R,targetX:D,targetY:F,sourcePosition:y,targetPosition:N,setUpdateHover:M,setReconnecting:_})]})})}var _g=I.memo(vg);const Eg=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function ga({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:o,onReconnect:i,onEdgeContextMenu:s,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:c,onEdgeClick:h,reconnectRadius:u,onEdgeDoubleClick:d,onReconnectStart:f,onReconnectEnd:m,disableKeyboardA11y:g}){const{edgesFocusable:v,edgesReconnectable:w,elementsSelectable:S,onError:p}=te(Eg,le),b=ag(t);return x.jsxs("div",{className:"react-flow__edges",children:[x.jsx(hg,{defaultColor:e,rfId:n}),b.map(C=>x.jsx(_g,{id:C,edgesFocusable:v,edgesReconnectable:w,elementsSelectable:S,noPanClassName:o,onReconnect:i,onContextMenu:s,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,onClick:h,reconnectRadius:u,onDoubleClick:d,onReconnectStart:f,onReconnectEnd:m,rfId:n,onError:p,edgeTypes:r,disableKeyboardA11y:g},C))]})}ga.displayName="EdgeRenderer";const kg=I.memo(ga),Ng=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Sg({children:e}){const t=te(Ng);return x.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function Cg(e){const t=Vr(),n=I.useRef(!1);I.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Tg=e=>e.panZoom?.syncViewport;function Ag(e){const t=te(Tg),n=ae();return I.useEffect(()=>{e&&(t?.(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function Rg(e){return e.connection.inProgress?{...e.connection,to:Pt(e.connection.to,e.transform)}:{...e.connection}}function Mg(e){return Rg}function $g(e){const t=Mg();return te(t,le)}const Ig=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Pg({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:o,width:i,height:s,isValid:a,inProgress:l}=te(Ig,le);return!(i&&o&&l)?null:x.jsx("svg",{style:e,width:i,height:s,className:"react-flow__connectionline react-flow__container",children:x.jsx("g",{className:ce(["react-flow__connection",Ti(a)]),children:x.jsx(ma,{style:t,type:n,CustomComponent:r,isValid:a})})})}const ma=({style:e,type:t=He.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:o,from:i,fromNode:s,fromHandle:a,fromPosition:l,to:c,toNode:h,toHandle:u,toPosition:d}=$g();if(!o)return;if(n)return x.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:s,fromHandle:a,fromX:i.x,fromY:i.y,toX:c.x,toY:c.y,fromPosition:l,toPosition:d,connectionStatus:Ti(r),toNode:h,toHandle:u});let f="";const m={sourceX:i.x,sourceY:i.y,sourcePosition:l,targetX:c.x,targetY:c.y,targetPosition:d};switch(t){case He.Bezier:[f]=Xi(m);break;case He.SimpleBezier:[f]=Js(m);break;case He.Step:[f]=Cr({...m,borderRadius:0});break;case He.SmoothStep:[f]=Cr(m);break;default:[f]=Yi(m)}return x.jsx("path",{d:f,fill:"none",className:"react-flow__connection-path",style:e})};ma.displayName="ConnectionLine";const Dg={};function ya(e=Dg){I.useRef(e),ae(),I.useEffect(()=>{},[e])}function Lg(){ae(),I.useRef(!1),I.useEffect(()=>{},[])}function xa({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:o,onNodeDoubleClick:i,onEdgeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:c,onNodeContextMenu:h,onSelectionContextMenu:u,onSelectionStart:d,onSelectionEnd:f,connectionLineType:m,connectionLineStyle:g,connectionLineComponent:v,connectionLineContainerStyle:w,selectionKeyCode:S,selectionOnDrag:p,selectionMode:b,multiSelectionKeyCode:C,panActivationKeyCode:E,zoomActivationKeyCode:k,deleteKeyCode:P,onlyRenderVisibleElements:L,elementsSelectable:O,defaultViewport:z,translateExtent:M,minZoom:B,maxZoom:_,preventScrolling:A,defaultMarkerColor:T,zoomOnScroll:$,zoomOnPinch:R,panOnScroll:D,panOnScrollSpeed:F,panOnScrollMode:y,zoomOnDoubleClick:N,panOnDrag:j,onPaneClick:H,onPaneMouseEnter:W,onPaneMouseMove:X,onPaneMouseLeave:G,onPaneScroll:V,onPaneContextMenu:Y,paneClickDistance:J,nodeClickDistance:Q,onEdgeContextMenu:U,onEdgeMouseEnter:Z,onEdgeMouseMove:ee,onEdgeMouseLeave:oe,reconnectRadius:ie,onReconnect:se,onReconnectStart:ue,onReconnectEnd:Re,noDragClassName:De,noWheelClassName:me,noPanClassName:Le,disableKeyboardA11y:ze,nodeExtent:Ur,rfId:zn,viewport:ut,onViewportChange:Ht}){return ya(e),ya(t),Lg(),Cg(n),Ag(ut),x.jsx(Kp,{onPaneClick:H,onPaneMouseEnter:W,onPaneMouseMove:X,onPaneMouseLeave:G,onPaneContextMenu:Y,onPaneScroll:V,paneClickDistance:J,deleteKeyCode:P,selectionKeyCode:S,selectionOnDrag:p,selectionMode:b,onSelectionStart:d,onSelectionEnd:f,multiSelectionKeyCode:C,panActivationKeyCode:E,zoomActivationKeyCode:k,elementsSelectable:O,zoomOnScroll:$,zoomOnPinch:R,zoomOnDoubleClick:N,panOnScroll:D,panOnScrollSpeed:F,panOnScrollMode:y,panOnDrag:j,defaultViewport:z,translateExtent:M,minZoom:B,maxZoom:_,onSelectionContextMenu:u,preventScrolling:A,noDragClassName:De,noWheelClassName:me,noPanClassName:Le,disableKeyboardA11y:ze,onViewportChange:Ht,isControlledViewport:!!ut,children:x.jsxs(Sg,{children:[x.jsx(kg,{edgeTypes:t,onEdgeClick:o,onEdgeDoubleClick:s,onReconnect:se,onReconnectStart:ue,onReconnectEnd:Re,onlyRenderVisibleElements:L,onEdgeContextMenu:U,onEdgeMouseEnter:Z,onEdgeMouseMove:ee,onEdgeMouseLeave:oe,reconnectRadius:ie,defaultMarkerColor:T,noPanClassName:Le,disableKeyboardA11y:ze,rfId:zn}),x.jsx(Pg,{style:g,type:m,component:v,containerStyle:w}),x.jsx("div",{className:"react-flow__edgelabel-renderer"}),x.jsx(sg,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:c,onNodeContextMenu:h,nodeClickDistance:Q,onlyRenderVisibleElements:L,noPanClassName:Le,noDragClassName:De,disableKeyboardA11y:ze,nodeExtent:Ur,rfId:zn}),x.jsx("div",{className:"react-flow__viewport-portal"})]})})}xa.displayName="GraphView";const zg=I.memo(xa),wa=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:i,fitView:s,fitViewOptions:a,minZoom:l=.5,maxZoom:c=2,nodeOrigin:h,nodeExtent:u}={})=>{const d=new Map,f=new Map,m=new Map,g=new Map,v=r??t??[],w=n??e??[],S=h??[0,0],p=u??Tt;ns(m,g,v);const b=Mr(w,d,f,{nodeOrigin:S,nodeExtent:p,elevateNodesOnSelect:!1});let C=[0,0,1];if(s&&o&&i){const E=Mt(d,{filter:O=>!!((O.width||O.initialWidth)&&(O.height||O.initialHeight))}),{x:k,y:P,zoom:L}=Nr(E,o,i,l,c,a?.padding??.1);C=[k,P,L]}return{rfId:"1",width:o??0,height:i??0,transform:C,nodes:w,nodesInitialized:b,nodeLookup:d,parentLookup:f,edges:v,edgeLookup:g,connectionLookup:m,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:l,maxZoom:c,translateExtent:Tt,nodeExtent:p,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:nt.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:S,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:s??!1,fitViewOptions:a,fitViewResolver:null,connection:{...Si},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:qh,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:Ni}},Bg=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:i,fitView:s,fitViewOptions:a,minZoom:l,maxZoom:c,nodeOrigin:h,nodeExtent:u})=>Jf((d,f)=>{async function m(){const{nodeLookup:g,panZoom:v,fitViewOptions:w,fitViewResolver:S,width:p,height:b,minZoom:C,maxZoom:E}=f();v&&(await Wh({nodes:g,width:p,height:b,panZoom:v,minZoom:C,maxZoom:E},w),S?.resolve(!0),d({fitViewResolver:null}))}return{...wa({nodes:e,edges:t,width:o,height:i,fitView:s,fitViewOptions:a,minZoom:l,maxZoom:c,nodeOrigin:h,nodeExtent:u,defaultNodes:n,defaultEdges:r}),setNodes:g=>{const{nodeLookup:v,parentLookup:w,nodeOrigin:S,elevateNodesOnSelect:p,fitViewQueued:b}=f(),C=Mr(g,v,w,{nodeOrigin:S,nodeExtent:u,elevateNodesOnSelect:p,checkEquality:!0});b&&C?(m(),d({nodes:g,nodesInitialized:C,fitViewQueued:!1,fitViewOptions:void 0})):d({nodes:g,nodesInitialized:C})},setEdges:g=>{const{connectionLookup:v,edgeLookup:w}=f();ns(v,w,g),d({edges:g})},setDefaultNodesAndEdges:(g,v)=>{if(g){const{setNodes:w}=f();w(g),d({hasDefaultNodes:!0})}if(v){const{setEdges:w}=f();w(v),d({hasDefaultEdges:!0})}},updateNodeInternals:g=>{const{triggerNodeChanges:v,nodeLookup:w,parentLookup:S,domNode:p,nodeOrigin:b,nodeExtent:C,debug:E,fitViewQueued:k}=f(),{changes:P,updatedInternals:L}=yf(g,w,S,p,b,C);L&&(ff(w,S,{nodeOrigin:b,nodeExtent:C}),k?(m(),d({fitViewQueued:!1,fitViewOptions:void 0})):d({}),P?.length>0&&(E&&console.log("React Flow: trigger node changes",P),v?.(P)))},updateNodePositions:(g,v=!1)=>{const w=[],S=[],{nodeLookup:p,triggerNodeChanges:b}=f();for(const[C,E]of g){const k=p.get(C),P=!!(k?.expandParent&&k?.parentId&&E?.position),L={id:C,type:"position",position:P?{x:Math.max(0,E.position.x),y:Math.max(0,E.position.y)}:E.position,dragging:v};P&&k.parentId&&w.push({id:C,parentId:k.parentId,rect:{...E.internals.positionAbsolute,width:E.measured.width??0,height:E.measured.height??0}}),S.push(L)}if(w.length>0){const{parentLookup:C,nodeOrigin:E}=f(),k=Ir(w,p,C,E);S.push(...k)}b(S)},triggerNodeChanges:g=>{const{onNodesChange:v,setNodes:w,nodes:S,hasDefaultNodes:p,debug:b}=f();if(g?.length){if(p){const C=vp(g,S);w(C)}b&&console.log("React Flow: trigger node changes",g),v?.(g)}},triggerEdgeChanges:g=>{const{onEdgesChange:v,setEdges:w,edges:S,hasDefaultEdges:p,debug:b}=f();if(g?.length){if(p){const C=_p(g,S);w(C)}b&&console.log("React Flow: trigger edge changes",g),v?.(g)}},addSelectedNodes:g=>{const{multiSelectionActive:v,edgeLookup:w,nodeLookup:S,triggerNodeChanges:p,triggerEdgeChanges:b}=f();if(v){const C=g.map(E=>Ke(E,!0));p(C);return}p(ct(S,new Set([...g]),!0)),b(ct(w))},addSelectedEdges:g=>{const{multiSelectionActive:v,edgeLookup:w,nodeLookup:S,triggerNodeChanges:p,triggerEdgeChanges:b}=f();if(v){const C=g.map(E=>Ke(E,!0));b(C);return}b(ct(w,new Set([...g]))),p(ct(S,new Set,!0))},unselectNodesAndEdges:({nodes:g,edges:v}={})=>{const{edges:w,nodes:S,nodeLookup:p,triggerNodeChanges:b,triggerEdgeChanges:C}=f(),E=g||S,k=v||w,P=E.map(O=>{const z=p.get(O.id);return z&&(z.selected=!1),Ke(O.id,!1)}),L=k.map(O=>Ke(O.id,!1));b(P),C(L)},setMinZoom:g=>{const{panZoom:v,maxZoom:w}=f();v?.setScaleExtent([g,w]),d({minZoom:g})},setMaxZoom:g=>{const{panZoom:v,minZoom:w}=f();v?.setScaleExtent([w,g]),d({maxZoom:g})},setTranslateExtent:g=>{f().panZoom?.setTranslateExtent(g),d({translateExtent:g})},resetSelectedElements:()=>{const{edges:g,nodes:v,triggerNodeChanges:w,triggerEdgeChanges:S,elementsSelectable:p}=f();if(!p)return;const b=v.reduce((E,k)=>k.selected?[...E,Ke(k.id,!1)]:E,[]),C=g.reduce((E,k)=>k.selected?[...E,Ke(k.id,!1)]:E,[]);w(b),S(C)},setNodeExtent:g=>{const{nodes:v,nodeLookup:w,parentLookup:S,nodeOrigin:p,elevateNodesOnSelect:b,nodeExtent:C}=f();g[0][0]===C[0][0]&&g[0][1]===C[0][1]&&g[1][0]===C[1][0]&&g[1][1]===C[1][1]||(Mr(v,w,S,{nodeOrigin:p,nodeExtent:g,elevateNodesOnSelect:b,checkEquality:!1}),d({nodeExtent:g}))},panBy:g=>{const{transform:v,width:w,height:S,panZoom:p,translateExtent:b}=f();return xf({delta:g,panZoom:p,transform:v,translateExtent:b,width:w,height:S})},setCenter:async(g,v,w)=>{const{width:S,height:p,maxZoom:b,panZoom:C}=f();if(!C)return Promise.resolve(!1);const E=typeof w?.zoom<"u"?w.zoom:b;return await C.setViewport({x:S/2-g*E,y:p/2-v*E,zoom:E},{duration:w?.duration,ease:w?.ease,interpolate:w?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{d({connection:{...Si}})},updateConnection:g=>{d({connection:g})},reset:()=>d({...wa()})}},Object.is);function Hg({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:o,initialHeight:i,initialMinZoom:s,initialMaxZoom:a,initialFitViewOptions:l,fitView:c,nodeOrigin:h,nodeExtent:u,children:d}){const[f]=I.useState(()=>Bg({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:i,fitView:c,minZoom:s,maxZoom:a,fitViewOptions:l,nodeOrigin:h,nodeExtent:u}));return x.jsx(np,{value:f,children:x.jsx(Sp,{children:d})})}function Og({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:o,width:i,height:s,fitView:a,fitViewOptions:l,minZoom:c,maxZoom:h,nodeOrigin:u,nodeExtent:d}){return I.useContext(An)?x.jsx(x.Fragment,{children:e}):x.jsx(Hg,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:o,initialWidth:i,initialHeight:s,fitView:a,initialFitViewOptions:l,initialMinZoom:c,initialMaxZoom:h,nodeOrigin:u,nodeExtent:d,children:e})}const jg={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Fg({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:o,nodeTypes:i,edgeTypes:s,onNodeClick:a,onEdgeClick:l,onInit:c,onMove:h,onMoveStart:u,onMoveEnd:d,onConnect:f,onConnectStart:m,onConnectEnd:g,onClickConnectStart:v,onClickConnectEnd:w,onNodeMouseEnter:S,onNodeMouseMove:p,onNodeMouseLeave:b,onNodeContextMenu:C,onNodeDoubleClick:E,onNodeDragStart:k,onNodeDrag:P,onNodeDragStop:L,onNodesDelete:O,onEdgesDelete:z,onDelete:M,onSelectionChange:B,onSelectionDragStart:_,onSelectionDrag:A,onSelectionDragStop:T,onSelectionContextMenu:$,onSelectionStart:R,onSelectionEnd:D,onBeforeDelete:F,connectionMode:y,connectionLineType:N=He.Bezier,connectionLineStyle:j,connectionLineComponent:H,connectionLineContainerStyle:W,deleteKeyCode:X="Backspace",selectionKeyCode:G="Shift",selectionOnDrag:V=!1,selectionMode:Y=At.Full,panActivationKeyCode:J="Space",multiSelectionKeyCode:Q=Dt()?"Meta":"Control",zoomActivationKeyCode:U=Dt()?"Meta":"Control",snapToGrid:Z,snapGrid:ee,onlyRenderVisibleElements:oe=!1,selectNodesOnDrag:ie,nodesDraggable:se,autoPanOnNodeFocus:ue,nodesConnectable:Re,nodesFocusable:De,nodeOrigin:me=Cs,edgesFocusable:Le,edgesReconnectable:ze,elementsSelectable:Ur=!0,defaultViewport:zn=gp,minZoom:ut=.5,maxZoom:Ht=2,translateExtent:Ca=Tt,preventScrolling:Sm=!0,nodeExtent:Zr,defaultMarkerColor:Cm="#b1b1b7",zoomOnScroll:Tm=!0,zoomOnPinch:Am=!0,panOnScroll:Rm=!1,panOnScrollSpeed:Mm=.5,panOnScrollMode:$m=Ue.Free,zoomOnDoubleClick:Im=!0,panOnDrag:Pm=!0,onPaneClick:Dm,onPaneMouseEnter:Lm,onPaneMouseMove:zm,onPaneMouseLeave:Bm,onPaneScroll:Hm,onPaneContextMenu:Om,paneClickDistance:jm=0,nodeClickDistance:Fm=0,children:Vm,onReconnect:Gm,onReconnectStart:Xm,onReconnectEnd:Wm,onEdgeContextMenu:Ym,onEdgeDoubleClick:qm,onEdgeMouseEnter:Um,onEdgeMouseMove:Zm,onEdgeMouseLeave:Km,reconnectRadius:Qm=10,onNodesChange:Jm,onEdgesChange:e0,noDragClassName:t0="nodrag",noWheelClassName:n0="nowheel",noPanClassName:Ta="nopan",fitView:Aa,fitViewOptions:Ra,connectOnClick:r0,attributionPosition:o0,proOptions:i0,defaultEdgeOptions:s0,elevateNodesOnSelect:a0,elevateEdgesOnSelect:l0,disableKeyboardA11y:Ma=!1,autoPanOnConnect:c0,autoPanOnNodeDrag:u0,autoPanSpeed:d0,connectionRadius:h0,isValidConnection:f0,onError:p0,style:g0,id:$a,nodeDragThreshold:m0,connectionDragThreshold:y0,viewport:x0,onViewportChange:w0,width:b0,height:v0,colorMode:_0="light",debug:E0,onScroll:Ia,ariaLabelConfig:k0,...N0},S0){const Kr=$a||"1",C0=xp(_0),T0=I.useCallback(Pa=>{Pa.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Ia?.(Pa)},[Ia]);return x.jsx("div",{"data-testid":"rf__wrapper",...N0,onScroll:T0,style:{...g0,...jg},ref:S0,className:ce(["react-flow",o,C0]),id:$a,role:"application",children:x.jsxs(Og,{nodes:e,edges:t,width:b0,height:v0,fitView:Aa,fitViewOptions:Ra,minZoom:ut,maxZoom:Ht,nodeOrigin:me,nodeExtent:Zr,children:[x.jsx(zg,{onInit:c,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:S,onNodeMouseMove:p,onNodeMouseLeave:b,onNodeContextMenu:C,onNodeDoubleClick:E,nodeTypes:i,edgeTypes:s,connectionLineType:N,connectionLineStyle:j,connectionLineComponent:H,connectionLineContainerStyle:W,selectionKeyCode:G,selectionOnDrag:V,selectionMode:Y,deleteKeyCode:X,multiSelectionKeyCode:Q,panActivationKeyCode:J,zoomActivationKeyCode:U,onlyRenderVisibleElements:oe,defaultViewport:zn,translateExtent:Ca,minZoom:ut,maxZoom:Ht,preventScrolling:Sm,zoomOnScroll:Tm,zoomOnPinch:Am,zoomOnDoubleClick:Im,panOnScroll:Rm,panOnScrollSpeed:Mm,panOnScrollMode:$m,panOnDrag:Pm,onPaneClick:Dm,onPaneMouseEnter:Lm,onPaneMouseMove:zm,onPaneMouseLeave:Bm,onPaneScroll:Hm,onPaneContextMenu:Om,paneClickDistance:jm,nodeClickDistance:Fm,onSelectionContextMenu:$,onSelectionStart:R,onSelectionEnd:D,onReconnect:Gm,onReconnectStart:Xm,onReconnectEnd:Wm,onEdgeContextMenu:Ym,onEdgeDoubleClick:qm,onEdgeMouseEnter:Um,onEdgeMouseMove:Zm,onEdgeMouseLeave:Km,reconnectRadius:Qm,defaultMarkerColor:Cm,noDragClassName:t0,noWheelClassName:n0,noPanClassName:Ta,rfId:Kr,disableKeyboardA11y:Ma,nodeExtent:Zr,viewport:x0,onViewportChange:w0}),x.jsx(yp,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:f,onConnectStart:m,onConnectEnd:g,onClickConnectStart:v,onClickConnectEnd:w,nodesDraggable:se,autoPanOnNodeFocus:ue,nodesConnectable:Re,nodesFocusable:De,edgesFocusable:Le,edgesReconnectable:ze,elementsSelectable:Ur,elevateNodesOnSelect:a0,elevateEdgesOnSelect:l0,minZoom:ut,maxZoom:Ht,nodeExtent:Zr,onNodesChange:Jm,onEdgesChange:e0,snapToGrid:Z,snapGrid:ee,connectionMode:y,translateExtent:Ca,connectOnClick:r0,defaultEdgeOptions:s0,fitView:Aa,fitViewOptions:Ra,onNodesDelete:O,onEdgesDelete:z,onDelete:M,onNodeDragStart:k,onNodeDrag:P,onNodeDragStop:L,onSelectionDrag:A,onSelectionDragStart:_,onSelectionDragStop:T,onMove:h,onMoveStart:u,onMoveEnd:d,noPanClassName:Ta,nodeOrigin:me,rfId:Kr,autoPanOnConnect:c0,autoPanOnNodeDrag:u0,autoPanSpeed:d0,onError:p0,connectionRadius:h0,isValidConnection:f0,selectNodesOnDrag:ie,nodeDragThreshold:m0,connectionDragThreshold:y0,onBeforeDelete:F,debug:E0,ariaLabelConfig:k0}),x.jsx(pp,{onSelectionChange:B}),Vm,x.jsx(cp,{proOptions:i0,position:o0}),x.jsx(lp,{rfId:Kr,disableKeyboardA11y:Ma})]})})}Bs(Fg);function Vg({dimensions:e,lineWidth:t,variant:n,className:r}){return x.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:ce(["react-flow__background-pattern",n,r])})}function Gg({radius:e,className:t}){return x.jsx("circle",{cx:e,cy:e,r:e,className:ce(["react-flow__background-pattern","dots",t])})}var Fe;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Fe||(Fe={}));const Xg={[Fe.Dots]:1,[Fe.Lines]:1,[Fe.Cross]:6},Wg=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function ba({id:e,variant:t=Fe.Dots,gap:n=20,size:r,lineWidth:o=1,offset:i=0,color:s,bgColor:a,style:l,className:c,patternClassName:h}){const u=I.useRef(null),{transform:d,patternId:f}=te(Wg,le),m=r||Xg[t],g=t===Fe.Dots,v=t===Fe.Cross,w=Array.isArray(n)?n:[n,n],S=[w[0]*d[2]||1,w[1]*d[2]||1],p=m*d[2],b=Array.isArray(i)?i:[i,i],C=v?[p,p]:S,E=[b[0]*d[2]||1+C[0]/2,b[1]*d[2]||1+C[1]/2],k=`${f}${e||""}`;return x.jsxs("svg",{className:ce(["react-flow__background",c]),style:{...l,...$n,"--xy-background-color-props":a,"--xy-background-pattern-color-props":s},ref:u,"data-testid":"rf__background",children:[x.jsx("pattern",{id:k,x:d[0]%S[0],y:d[1]%S[1],width:S[0],height:S[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${E[0]},-${E[1]})`,children:g?x.jsx(Gg,{radius:p/2,className:h}):x.jsx(Vg,{dimensions:C,lineWidth:o,variant:t,className:h})}),x.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${k})`})]})}ba.displayName="Background",I.memo(ba);function Yg(){return x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:x.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function qg(){return x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:x.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Ug(){return x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:x.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function Zg(){return x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:x.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Kg(){return x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:x.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Dn({children:e,className:t,...n}){return x.jsx("button",{type:"button",className:ce(["react-flow__controls-button",t]),...n,children:e})}const Qg=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function va({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:o,onZoomIn:i,onZoomOut:s,onFitView:a,onInteractiveChange:l,className:c,children:h,position:u="bottom-left",orientation:d="vertical","aria-label":f}){const m=ae(),{isInteractive:g,minZoomReached:v,maxZoomReached:w,ariaLabelConfig:S}=te(Qg,le),{zoomIn:p,zoomOut:b,fitView:C}=Vr(),E=()=>{p(),i?.()},k=()=>{b(),s?.()},P=()=>{C(o),a?.()},L=()=>{m.setState({nodesDraggable:!g,nodesConnectable:!g,elementsSelectable:!g}),l?.(!g)},O=d==="horizontal"?"horizontal":"vertical";return x.jsxs(Rn,{className:ce(["react-flow__controls",O,c]),position:u,style:e,"data-testid":"rf__controls","aria-label":f??S["controls.ariaLabel"],children:[t&&x.jsxs(x.Fragment,{children:[x.jsx(Dn,{onClick:E,className:"react-flow__controls-zoomin",title:S["controls.zoomIn.ariaLabel"],"aria-label":S["controls.zoomIn.ariaLabel"],disabled:w,children:x.jsx(Yg,{})}),x.jsx(Dn,{onClick:k,className:"react-flow__controls-zoomout",title:S["controls.zoomOut.ariaLabel"],"aria-label":S["controls.zoomOut.ariaLabel"],disabled:v,children:x.jsx(qg,{})})]}),n&&x.jsx(Dn,{className:"react-flow__controls-fitview",onClick:P,title:S["controls.fitView.ariaLabel"],"aria-label":S["controls.fitView.ariaLabel"],children:x.jsx(Ug,{})}),r&&x.jsx(Dn,{className:"react-flow__controls-interactive",onClick:L,title:S["controls.interactive.ariaLabel"],"aria-label":S["controls.interactive.ariaLabel"],children:g?x.jsx(Kg,{}):x.jsx(Zg,{})}),h]})}va.displayName="Controls",I.memo(va);function Jg({id:e,x:t,y:n,width:r,height:o,style:i,color:s,strokeColor:a,strokeWidth:l,className:c,borderRadius:h,shapeRendering:u,selected:d,onClick:f}){const{background:m,backgroundColor:g}=i||{},v=s||m||g;return x.jsx("rect",{className:ce(["react-flow__minimap-node",{selected:d},c]),x:t,y:n,rx:h,ry:h,width:r,height:o,style:{fill:v,stroke:a,strokeWidth:l},shapeRendering:u,onClick:f?w=>f(w,e):void 0})}const em=I.memo(Jg),tm=e=>e.nodes.map(t=>t.id),Yr=e=>e instanceof Function?e:()=>e;function nm({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:o,nodeComponent:i=em,onClick:s}){const a=te(tm,le),l=Yr(t),c=Yr(e),h=Yr(n),u=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return x.jsx(x.Fragment,{children:a.map(d=>x.jsx(om,{id:d,nodeColorFunc:l,nodeStrokeColorFunc:c,nodeClassNameFunc:h,nodeBorderRadius:r,nodeStrokeWidth:o,NodeComponent:i,onClick:s,shapeRendering:u},d))})}function rm({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:o,nodeStrokeWidth:i,shapeRendering:s,NodeComponent:a,onClick:l}){const{node:c,x:h,y:u,width:d,height:f}=te(m=>{const{internals:g}=m.nodeLookup.get(e),v=g.userNode,{x:w,y:S}=g.positionAbsolute,{width:p,height:b}=Pe(v);return{node:v,x:w,y:S,width:p,height:b}},le);return!c||c.hidden||!Li(c)?null:x.jsx(a,{x:h,y:u,width:d,height:f,style:c.style,selected:!!c.selected,className:r(c),color:t(c),borderRadius:o,strokeColor:n(c),strokeWidth:i,shapeRendering:s,onClick:l,id:c.id})}const om=I.memo(rm);var im=I.memo(nm);const sm=200,am=150,lm=e=>!e.hidden,cm=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?Pi(Mt(e.nodeLookup,{filter:lm}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},um="react-flow__minimap-desc";function _a({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:o="",nodeBorderRadius:i=5,nodeStrokeWidth:s,nodeComponent:a,bgColor:l,maskColor:c,maskStrokeColor:h,maskStrokeWidth:u,position:d="bottom-right",onClick:f,onNodeClick:m,pannable:g=!1,zoomable:v=!1,ariaLabel:w,inversePan:S,zoomStep:p=1,offsetScale:b=5}){const C=ae(),E=I.useRef(null),{boundingRect:k,viewBB:P,rfId:L,panZoom:O,translateExtent:z,flowWidth:M,flowHeight:B,ariaLabelConfig:_}=te(cm,le),A=e?.width??sm,T=e?.height??am,$=k.width/A,R=k.height/T,D=Math.max($,R),F=D*A,y=D*T,N=b*D,j=k.x-(F-k.width)/2-N,H=k.y-(y-k.height)/2-N,W=F+N*2,X=y+N*2,G=`${um}-${L}`,V=I.useRef(0),Y=I.useRef();V.current=D,I.useEffect(()=>{if(E.current&&O)return Y.current=Cf({domNode:E.current,panZoom:O,getTransform:()=>C.getState().transform,getViewScale:()=>V.current}),()=>{Y.current?.destroy()}},[O]),I.useEffect(()=>{Y.current?.update({translateExtent:z,width:M,height:B,inversePan:S,pannable:g,zoomStep:p,zoomable:v})},[g,v,S,p,z,M,B]);const J=f?Z=>{const[ee,oe]=Y.current?.pointer(Z)||[0,0];f(Z,{x:ee,y:oe})}:void 0,Q=m?I.useCallback((Z,ee)=>{const oe=C.getState().nodeLookup.get(ee).internals.userNode;m(Z,oe)},[]):void 0,U=w??_["minimap.ariaLabel"];return x.jsx(Rn,{position:d,style:{...e,"--xy-minimap-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-stroke-color-props":typeof h=="string"?h:void 0,"--xy-minimap-mask-stroke-width-props":typeof u=="number"?u*D:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof s=="number"?s:void 0},className:ce(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:x.jsxs("svg",{width:A,height:T,viewBox:`${j} ${H} ${W} ${X}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":G,ref:E,onClick:J,children:[U&&x.jsx("title",{id:G,children:U}),x.jsx(im,{onClick:Q,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:o,nodeStrokeWidth:s,nodeComponent:a}),x.jsx("path",{className:"react-flow__minimap-mask",d:`M${j-N},${H-N}h${W+N*2}v${X+N*2}h${-W-N*2}z
        M${P.x},${P.y}h${P.width}v${P.height}h${-P.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}_a.displayName="MiniMap",I.memo(_a);const dm=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,hm={[lt.Line]:"right",[lt.Handle]:"bottom-right"};function fm({nodeId:e,position:t,variant:n=lt.Handle,className:r,style:o=void 0,children:i,color:s,minWidth:a=10,minHeight:l=10,maxWidth:c=Number.MAX_VALUE,maxHeight:h=Number.MAX_VALUE,keepAspectRatio:u=!1,resizeDirection:d,autoScale:f=!0,shouldResize:m,onResizeStart:g,onResize:v,onResizeEnd:w}){const S=Gs(),p=typeof e=="string"?e:S,b=ae(),C=I.useRef(null),E=n===lt.Handle,k=te(I.useCallback(dm(E&&f),[E,f]),le),P=I.useRef(null),L=t??hm[n];I.useEffect(()=>{if(!(!C.current||!p))return P.current||(P.current=jf({domNode:C.current,nodeId:p,getStoreItems:()=>{const{nodeLookup:z,transform:M,snapGrid:B,snapToGrid:_,nodeOrigin:A,domNode:T}=b.getState();return{nodeLookup:z,transform:M,snapGrid:B,snapToGrid:_,nodeOrigin:A,paneDomNode:T}},onChange:(z,M)=>{const{triggerNodeChanges:B,nodeLookup:_,parentLookup:A,nodeOrigin:T}=b.getState(),$=[],R={x:z.x,y:z.y},D=_.get(p);if(D&&D.expandParent&&D.parentId){const F=D.origin??T,y=z.width??D.measured.width??0,N=z.height??D.measured.height??0,j={id:D.id,parentId:D.parentId,rect:{width:y,height:N,...zi({x:z.x??D.position.x,y:z.y??D.position.y},{width:y,height:N},D.parentId,_,F)}},H=Ir([j],_,A,T);$.push(...H),R.x=z.x?Math.max(F[0]*y,z.x):void 0,R.y=z.y?Math.max(F[1]*N,z.y):void 0}if(R.x!==void 0&&R.y!==void 0){const F={id:p,type:"position",position:{...R}};$.push(F)}if(z.width!==void 0&&z.height!==void 0){const y={id:p,type:"dimensions",resizing:!0,setAttributes:d?d==="horizontal"?"width":"height":!0,dimensions:{width:z.width,height:z.height}};$.push(y)}for(const F of M){const y={...F,type:"position"};$.push(y)}B($)},onEnd:({width:z,height:M})=>{const B={id:p,type:"dimensions",resizing:!1,dimensions:{width:z,height:M}};b.getState().triggerNodeChanges([B])}})),P.current.update({controlPosition:L,boundaries:{minWidth:a,minHeight:l,maxWidth:c,maxHeight:h},keepAspectRatio:u,resizeDirection:d,onResizeStart:g,onResize:v,onResizeEnd:w,shouldResize:m}),()=>{P.current?.destroy()}},[L,a,l,c,h,u,g,v,w,m]);const O=L.split("-");return x.jsx("div",{className:ce(["react-flow__resize-control","nodrag",...O,n,r]),ref:C,style:{...o,scale:k,...s&&{[E?"backgroundColor":"borderColor"]:s}},children:i})}I.memo(fm);const Ln=({value:e,onChange:t,options:n,disabled:r=!1})=>{const[o,i]=I.useState(!1),s=I.useRef(null),a=I.useRef(null),l=n.find(u=>u.value===e);I.useEffect(()=>{const u=d=>{s.current&&!s.current.contains(d.target)&&i(!1)};return o&&document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[o]);const c=u=>{u.disabled||(t(u.value),i(!1))},h=u=>{const d=a.current;d&&(d.scrollTop+=u.deltaY)};return x.jsxs("div",{ref:s,className:"relative",children:[x.jsx("button",{type:"button",onClick:()=>!r&&i(!o),disabled:r,className:`sketch-border cursor-pointer ${r?"opacity-50 cursor-not-allowed":""}`,children:x.jsx("div",{className:"sketch-border-inner",children:x.jsxs("div",{className:"sketch-border-content bg-white px-3 py-1 flex items-center gap-2 min-w-[130px] justify-between",children:[x.jsx("span",{className:"sketch-info-text text-sm font-medium whitespace-nowrap",children:l?.label||e}),x.jsx(pl,{size:14,className:`transition-transform ${o?"rotate-180":""}`})]})})}),o&&!r&&x.jsx("div",{className:"absolute top-full mt-2 z-50 min-w-full",children:x.jsx("div",{className:"sketch-border",children:x.jsx("div",{className:"sketch-border-inner",children:x.jsx("div",{className:"sketch-border-content bg-white",style:{overflow:"hidden"},children:x.jsx("div",{ref:a,className:"nowheel",style:{maxHeight:"300px",overflowY:"auto",overflowX:"hidden",overscrollBehavior:"contain",WebkitOverflowScrolling:"touch"},onWheel:h,onTouchMove:u=>u.stopPropagation(),children:n.map(u=>x.jsx("button",{type:"button",onClick:()=>c(u),disabled:u.disabled,className:`w-full text-left px-3 py-2 sketch-info-text text-sm font-medium transition-colors ${u.disabled?"opacity-40 cursor-not-allowed":"hover:bg-gray-100 cursor-pointer"} ${u.value===e?"bg-gray-50":""}`,children:u.label},u.value))})})})})})]})},Ea={blue:{bg:"#E3F2FD",border:"#5B9BD5"},purple:{bg:"#F3E5F5",border:"#9B59B6"},mint:{bg:"#E0F2F1",border:"#4DB6AC"},pink:{bg:"#FCE4EC",border:"#EC407A"},peach:{bg:"#FFE0B2",border:"#FF8A65"},sage:{bg:"#E8F5E9",border:"#66BB6A"},yellow:{bg:"#FFF9C4",border:"#FDD835"}},pm={input:"blue",processing:"purple",output:"sage"},gm=e=>{if(!e)return Ea.purple;const t=pm[e]||"purple";return Ea[t]},mm=Object.freeze(Object.defineProperty({__proto__:null,SummarizeNode:({data:e,selected:t})=>{const[n,r]=I.useState("checking"),[o,i]=I.useState(0),[s,a]=I.useState(e.type||"tldr"),[l,c]=I.useState(e.length||"medium");I.useEffect(()=>{e.type=s},[s]),I.useEffect(()=>{e.length=l},[l]),I.useEffect(()=>{(async()=>{try{const m=await Summarizer.availability();r(m)}catch{r("downloadable")}})()},[]);const h=async()=>{try{r("downloading"),await Summarizer.create({monitor(f){f.addEventListener("downloadprogress",m=>i(Math.round(m.loaded*100)))}}),r("ready")}catch{r("downloadable")}},u=e.status==="running",d=gm(e.category);return x.jsxs("div",{style:{width:250},className:`sketch-node relative ${u?"sketch-node-running-flow":""} ${t?"sketch-node-selected":""}`,children:[t&&e.onDelete&&x.jsx("button",{onClick:f=>{f.stopPropagation(),e.onDelete?.(e.id)},className:"absolute -top-3 -right-3 flex items-center justify-center hover:scale-110 transition-all cursor-pointer w-7 h-7 rounded-full z-20 shadow-md",style:{backgroundColor:d.bg,color:d.border,border:`3px solid ${d.border}`,filter:"url(#rough-border)"},title:"Delete node (or press Delete/Backspace)",children:x.jsx(Xt,{size:14,strokeWidth:2.5})}),x.jsx("div",{className:"sketch-border",style:{"--sketch-color":d.border},children:x.jsx("div",{className:"sketch-border-inner",children:x.jsxs("div",{className:"sketch-border-content",children:[x.jsxs("div",{className:"px-4 py-3 font-bold text-base tracking-tight flex items-center justify-between gap-2",style:{backgroundColor:d.bg},children:[x.jsxs("div",{className:"flex items-center gap-2.5",children:[u?x.jsx(Xn,{size:18,className:"animate-spin shrink-0",style:{color:d.border}}):x.jsx(yl,{size:18,className:"shrink-0 opacity-90",style:{color:d.border}}),x.jsx("span",{className:"sketch-text text-[17px] leading-tight",style:{color:d.border},children:"Summarize"})]}),x.jsx("div",{className:"flex items-center gap-1.5",children:e.output&&x.jsx("button",{onClick:()=>e.onInspect?.(e.id,e.output),className:"cursor-pointer hover:scale-125 transition-transform opacity-90 hover:opacity-100 shrink-0",style:{color:d.border},title:"Inspect output",children:x.jsx(Gt,{size:18,style:{color:d.border}})})})]}),x.jsxs("div",{className:"px-4 py-3 space-y-3 sketch-info-text text-sm font-medium bg-white",children:[x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("span",{children:"Type"}),x.jsx(Ln,{value:s,onChange:a,disabled:u,options:[{value:"tldr",label:"tldr"},{value:"teaser",label:"teaser"},{value:"key-points",label:"key-points"},{value:"headline",label:"headline"}]})]}),x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("span",{children:"Length"}),x.jsx(Ln,{value:l,onChange:c,disabled:u,options:[{value:"short",label:"short"},{value:"medium",label:"medium"},{value:"long",label:"long"}]})]}),n==="downloadable"&&x.jsxs("div",{className:"space-y-2",children:[x.jsx("p",{className:"text-[#E09F7D] text-[15px] font-semibold",children:"⚠️ Model not installed"}),x.jsx("div",{className:"sketch-border sketch-button-hover inline-flex",style:{"--sketch-color":d.border},children:x.jsx("div",{className:"sketch-border-inner",children:x.jsx("button",{onClick:h,className:"sketch-border-content px-3 py-2 font-bold sketch-text text-sm cursor-pointer whitespace-nowrap",style:{backgroundColor:d.bg,color:d.border},children:"Download model"})})})]}),n==="downloading"&&x.jsxs("div",{className:"space-y-1",children:[x.jsxs("p",{className:"text-[#5B9BD5] font-semibold",children:["⏳ Downloading... ",o,"%"]}),x.jsx("div",{className:"w-full bg-gray-200 h-2 rounded overflow-hidden border-2 border-black",children:x.jsx("div",{className:"bg-[#5B9BD5] h-full transition-all",style:{width:`${o}%`}})})]}),n==="ready"&&x.jsx("div",{className:"text-[#52B788] font-semibold",children:"✅ Model ready"}),x.jsx("div",{className:"sketch-info-text font-medium",style:{color:"#2C2C2C"},children:u?"✨ Summarizing...":e.status==="done"?x.jsx("span",{className:"font-bold",children:"✓ Done!"}):x.jsx("span",{className:"font-bold",children:"✓ Ready"})})]})]})})}),e.category!=="input"&&x.jsx(ke,{type:"target",position:q.Top,style:{borderColor:d.border,"--handle-color":d.border}}),e.category!=="output"&&x.jsx(ke,{type:"source",position:q.Bottom,style:{borderColor:d.border,"--handle-color":d.border}})]})}},Symbol.toStringTag,{value:"Module"})),ka={blue:{bg:"#E3F2FD",border:"#5B9BD5"},purple:{bg:"#F3E5F5",border:"#9B59B6"},mint:{bg:"#E0F2F1",border:"#4DB6AC"},pink:{bg:"#FCE4EC",border:"#EC407A"},peach:{bg:"#FFE0B2",border:"#FF8A65"},sage:{bg:"#E8F5E9",border:"#66BB6A"},yellow:{bg:"#FFF9C4",border:"#FDD835"}},ym={input:"blue",processing:"purple",output:"sage"},xm=e=>{if(!e)return ka.purple;const t=ym[e]||"purple";return ka[t]},qr=[{value:"en",label:"English"},{value:"es",label:"Spanish"},{value:"fr",label:"French"},{value:"de",label:"German"},{value:"it",label:"Italian"},{value:"pt",label:"Portuguese"},{value:"ru",label:"Russian"},{value:"ja",label:"Japanese"},{value:"zh",label:"Chinese (Simplified)"},{value:"zh-Hant",label:"Chinese (Traditional)"},{value:"ko",label:"Korean"},{value:"ar",label:"Arabic"},{value:"hi",label:"Hindi"},{value:"bn",label:"Bengali"},{value:"tr",label:"Turkish"},{value:"vi",label:"Vietnamese"},{value:"pl",label:"Polish"},{value:"uk",label:"Ukrainian"},{value:"nl",label:"Dutch"},{value:"th",label:"Thai"},{value:"id",label:"Indonesian"},{value:"cs",label:"Czech"},{value:"sv",label:"Swedish"},{value:"ro",label:"Romanian"},{value:"el",label:"Greek"},{value:"hu",label:"Hungarian"},{value:"da",label:"Danish"},{value:"fi",label:"Finnish"},{value:"no",label:"Norwegian"},{value:"sk",label:"Slovak"},{value:"bg",label:"Bulgarian"},{value:"he",label:"Hebrew"},{value:"ms",label:"Malay"},{value:"ca",label:"Catalan"},{value:"hr",label:"Croatian"},{value:"sr",label:"Serbian"},{value:"sl",label:"Slovenian"},{value:"lt",label:"Lithuanian"},{value:"lv",label:"Latvian"},{value:"et",label:"Estonian"}],wm=Object.freeze(Object.defineProperty({__proto__:null,TranslateNode:({data:e,selected:t})=>{const[n,r]=I.useState("checking"),[o,i]=I.useState(0),[s,a]=I.useState(e.sourceLanguage||"en"),[l,c]=I.useState(e.targetLanguage||"fr"),[h,u]=I.useState(new Set),[d,f]=I.useState(!1);I.useEffect(()=>{e.sourceLanguage=s},[s]),I.useEffect(()=>{e.targetLanguage=l},[l]),I.useEffect(()=>{(async()=>{f(!0);const b=new Set,C=qr.map(async E=>{if(E.value!==s)try{const k=await Translator.availability({sourceLanguage:s,targetLanguage:E.value});k!=="available"&&k!=="downloadable"&&b.add(E.value)}catch{b.add(E.value)}});await Promise.all(C),u(b),f(!1)})()},[s]),I.useEffect(()=>{(async()=>{try{const b=await Translator.availability({sourceLanguage:s,targetLanguage:l});r(b)}catch{r("downloadable")}})()},[s,l]);const m=async()=>{try{r("downloading"),await Translator.create({sourceLanguage:s,targetLanguage:l,monitor(p){p.addEventListener("downloadprogress",b=>i(Math.round(b.loaded*100)))}}),r("ready")}catch{r("downloadable")}},g=e.status==="running",v=xm(e.category),w=qr.map(p=>({...p,disabled:p.value===l})),S=qr.map(p=>({...p,disabled:p.value===s||h.has(p.value)}));return x.jsxs("div",{style:{width:250},className:`sketch-node relative ${g?"sketch-node-running-flow":""} ${t?"sketch-node-selected":""}`,children:[t&&e.onDelete&&x.jsx("button",{onClick:p=>{p.stopPropagation(),e.onDelete?.(e.id)},className:"absolute -top-3 -right-3 flex items-center justify-center hover:scale-110 transition-all cursor-pointer w-7 h-7 rounded-full z-20 shadow-md",style:{backgroundColor:v.bg,color:v.border,border:`3px solid ${v.border}`,filter:"url(#rough-border)"},title:"Delete node (or press Delete/Backspace)",children:x.jsx(Xt,{size:14,strokeWidth:2.5})}),x.jsx("div",{className:"sketch-border",style:{"--sketch-color":v.border},children:x.jsx("div",{className:"sketch-border-inner",children:x.jsxs("div",{className:"sketch-border-content",children:[x.jsxs("div",{className:"px-4 py-3 font-bold text-base tracking-tight flex items-center justify-between gap-2",style:{backgroundColor:v.bg},children:[x.jsxs("div",{className:"flex items-center gap-2.5",children:[g?x.jsx(Xn,{size:18,className:"animate-spin shrink-0",style:{color:v.border}}):x.jsx(gl,{size:18,className:"shrink-0 opacity-90",style:{color:v.border}}),x.jsx("span",{className:"sketch-text text-[17px] leading-tight",style:{color:v.border},children:"Translate"})]}),x.jsx("div",{className:"flex items-center gap-1.5",children:e.output&&x.jsx("button",{onClick:()=>e.onInspect?.(e.id,e.output),className:"cursor-pointer hover:scale-125 transition-transform opacity-90 hover:opacity-100 shrink-0",style:{color:v.border},title:"Inspect output",children:x.jsx(Gt,{size:18,style:{color:v.border}})})})]}),x.jsxs("div",{className:"px-4 py-3 space-y-3 sketch-info-text text-sm font-medium bg-white",children:[x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("span",{children:"From"}),x.jsx(Ln,{value:s,onChange:a,disabled:g,options:w})]}),x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("span",{children:"To"}),x.jsx(Ln,{value:l,onChange:c,disabled:g||d,options:S})]}),d&&x.jsx("div",{className:"text-sm text-gray-600 font-medium",children:"⏳ Checking available languages..."}),n==="downloadable"&&x.jsxs("div",{className:"space-y-2",children:[x.jsx("p",{className:"text-[#E09F7D] text-[15px] font-semibold",children:"⚠️ Model not installed"}),x.jsx("div",{className:"sketch-border sketch-button-hover inline-flex",style:{"--sketch-color":v.border},children:x.jsx("div",{className:"sketch-border-inner",children:x.jsx("button",{onClick:m,className:"sketch-border-content px-3 py-2 font-bold sketch-text text-sm cursor-pointer whitespace-nowrap",style:{backgroundColor:v.bg,color:v.border},children:"Download model"})})})]}),n==="downloading"&&x.jsxs("div",{className:"space-y-1",children:[x.jsxs("p",{className:"text-[#5B9BD5] font-semibold",children:["⏳ Downloading... ",o,"%"]}),x.jsx("div",{className:"w-full bg-gray-200 h-2 rounded overflow-hidden border-2 border-black",children:x.jsx("div",{className:"bg-[#5B9BD5] h-full transition-all",style:{width:`${o}%`}})})]}),n==="ready"&&x.jsx("div",{className:"text-[#52B788] font-semibold",children:"✅ Model ready"}),x.jsx("div",{className:"sketch-info-text font-medium",style:{color:"#2C2C2C"},children:g?"✨ Translating...":e.status==="done"?x.jsx("span",{className:"font-bold",children:"✓ Done!"}):x.jsx("span",{className:"font-bold",children:"✓ Ready"})})]})]})})}),e.category!=="input"&&x.jsx(ke,{type:"target",position:q.Top,style:{borderColor:v.border,"--handle-color":v.border}}),e.category!=="output"&&x.jsx(ke,{type:"source",position:q.Bottom,style:{borderColor:v.border,"--handle-color":v.border}})]})}},Symbol.toStringTag,{value:"Module"})),Na={blue:{bg:"#E3F2FD",border:"#5B9BD5"},purple:{bg:"#F3E5F5",border:"#9B59B6"},mint:{bg:"#E0F2F1",border:"#4DB6AC"},pink:{bg:"#FCE4EC",border:"#EC407A"},peach:{bg:"#FFE0B2",border:"#FF8A65"},sage:{bg:"#E8F5E9",border:"#66BB6A"},yellow:{bg:"#FFF9C4",border:"#FDD835"}},bm={input:"blue",processing:"purple",output:"sage"},vm=e=>{if(!e)return Na.purple;const t=bm[e]||"purple";return Na[t]},_m=Object.freeze(Object.defineProperty({__proto__:null,PromptNodeComponent:({data:e,selected:t})=>{const[n,r]=I.useState("checking"),[o,i]=I.useState(e.prompt||"");I.useEffect(()=>{e.prompt=o},[o,e]),I.useEffect(()=>{(async()=>{try{if(!window.LanguageModel){r("unavailable");return}const c=await window.LanguageModel.availability();r(c)}catch{r("unavailable")}})()},[]);const s=e.status==="running",a=vm(e.category);return x.jsxs("div",{className:`sketch-node relative w-[300px] ${s?"sketch-node-running-flow":""} ${t?"sketch-node-selected":""}`,children:[t&&e.onDelete&&x.jsx("button",{onClick:l=>{l.stopPropagation(),e.onDelete?.(e.id)},className:"absolute -top-3 -right-3 flex items-center justify-center hover:scale-110 transition-all cursor-pointer w-7 h-7 rounded-full z-20 shadow-md",style:{backgroundColor:a.bg,color:a.border,border:`3px solid ${a.border}`,filter:"url(#rough-border)"},title:"Delete node (or press Delete/Backspace)",children:x.jsx(Xt,{size:14,strokeWidth:2.5})}),x.jsx("div",{className:"sketch-border",style:{"--sketch-color":a.border},children:x.jsx("div",{className:"sketch-border-inner",children:x.jsxs("div",{className:"sketch-border-content",children:[x.jsxs("div",{className:"px-4 py-3 font-bold text-base tracking-tight flex items-center justify-between gap-2",style:{backgroundColor:a.bg},children:[x.jsxs("div",{className:"flex items-center gap-2.5",children:[s?x.jsx(Xn,{size:18,className:"animate-spin shrink-0",style:{color:a.border}}):x.jsx(ml,{size:18,className:"shrink-0 opacity-90",style:{color:a.border}}),x.jsx("span",{className:"sketch-text text-[17px] leading-tight",style:{color:a.border},children:"Prompt"})]}),x.jsx("div",{className:"flex items-center gap-1.5",children:e.output&&x.jsx("button",{onClick:()=>e.onInspect?.(e.id,e.output),className:"cursor-pointer hover:scale-125 transition-transform opacity-90 hover:opacity-100 shrink-0",style:{color:a.border},title:"Inspect output",children:x.jsx(Gt,{size:18,style:{color:a.border}})})})]}),x.jsxs("div",{className:"px-4 py-3 space-y-3 bg-white sketch-info-text",children:[x.jsxs("div",{children:[x.jsxs("label",{className:"block mb-2 sketch-info-text text-sm font-medium",children:["Custom Prompt",e.status==="done"&&x.jsx("span",{className:"ml-2 text-[#52B788] text-sm",children:"✓ Edit & re-run"})]}),x.jsx("div",{className:"sketch-border",style:{"--sketch-color":a.border},children:x.jsx("div",{className:"sketch-border-inner",children:x.jsx("textarea",{value:o,onChange:l=>i(l.target.value),disabled:s,className:"nowheel w-full py-1.5 px-3 resize-none disabled:opacity-50 disabled:cursor-not-allowed bg-transparent border-0 outline-none focus:outline-none focus:ring-0 focus:border-transparent appearance-none font-sans text-[14px]",style:{backgroundColor:"transparent",lineHeight:"1.5",fontFamily:"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif"},rows:3,placeholder:"Enter your instruction..."})})})]}),n==="unavailable"&&x.jsx("div",{className:"text-[#E09F7D] text-[15px] font-semibold",children:"⚠️ Prompt API not available"}),n==="downloadable"&&x.jsx("div",{className:"text-[#5B9BD5] text-[15px] font-semibold",children:"📥 Model available"}),n==="downloading"&&x.jsx("div",{className:"text-[#5B9BD5] text-[15px] font-semibold",children:"⏳ Downloading model..."}),n==="ready"&&x.jsx("div",{className:"text-[#52B788] text-[15px] font-semibold",children:"✅ Model ready"})]})]})})}),e.category!=="input"&&x.jsx(ke,{type:"target",position:q.Top,style:{borderColor:a.border,"--handle-color":a.border}}),e.category!=="output"&&x.jsx(ke,{type:"source",position:q.Bottom,style:{borderColor:a.border,"--handle-color":a.border}})]})}},Symbol.toStringTag,{value:"Module"})),Sa={blue:{bg:"#E3F2FD",border:"#5B9BD5"},purple:{bg:"#F3E5F5",border:"#9B59B6"},mint:{bg:"#E0F2F1",border:"#4DB6AC"},pink:{bg:"#FCE4EC",border:"#EC407A"},peach:{bg:"#FFE0B2",border:"#FF8A65"},sage:{bg:"#E8F5E9",border:"#66BB6A"},yellow:{bg:"#FFF9C4",border:"#FDD835"}},Em={input:"blue",processing:"purple",output:"sage"},km=e=>{if(!e)return Sa.purple;const t=Em[e]||"purple";return Sa[t]},Nm=Object.freeze(Object.defineProperty({__proto__:null,TextOutputNode:({data:e,selected:t})=>{const n=km(e.category);return x.jsxs("div",{style:{width:300},className:`sketch-node relative ${t?"sketch-node-selected":""}`,children:[t&&e.onDelete&&x.jsx("button",{onClick:r=>{r.stopPropagation(),e.onDelete?.(e.id)},className:"absolute -top-3 -right-3 flex items-center justify-center hover:scale-110 transition-all cursor-pointer w-7 h-7 rounded-full z-20 shadow-md",style:{backgroundColor:n.bg,color:n.border,border:`3px solid ${n.border}`,filter:"url(#rough-border)"},title:"Delete node (or press Delete/Backspace)",children:x.jsx(Xt,{size:14,strokeWidth:2.5})}),x.jsx("div",{className:"sketch-border",style:{"--sketch-color":n.border},children:x.jsx("div",{className:"sketch-border-inner",children:x.jsxs("div",{className:"sketch-border-content",children:[x.jsxs("div",{className:"px-4 py-3 font-bold text-base tracking-tight flex items-center justify-between gap-2",style:{backgroundColor:n.bg},children:[x.jsxs("div",{className:"flex items-center gap-2.5",children:[x.jsx(co,{size:18,className:"shrink-0 opacity-90",style:{color:n.border}}),x.jsx("span",{className:"sketch-text text-[17px] leading-tight",style:{color:n.border},children:e.label})]}),x.jsx("div",{className:"flex items-center gap-1.5",children:e.output&&x.jsx("button",{onClick:()=>e.onInspect?.(e.id,e.output),className:"cursor-pointer hover:scale-125 transition-transform opacity-90 hover:opacity-100 shrink-0",style:{color:n.border},title:"Inspect output",children:x.jsx(Gt,{size:18,style:{color:n.border}})})})]}),x.jsx("div",{className:"px-4 py-3 sketch-info-text text-sm font-medium whitespace-pre-wrap max-h-56 overflow-auto bg-white nowheel",style:{color:"#2C2C2C"},children:e.output||x.jsx("span",{className:"font-bold",children:"No output yet"})})]})})}),x.jsx(ke,{type:"target",position:q.Top,style:{borderColor:n.border,"--handle-color":n.border}})]})}},Symbol.toStringTag,{value:"Module"}));return Oa})();
content;